Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

AGGREGATED DFIG WIND FARM HARMONIC PROPAGATION ANALYSIS
SILAS Y. LIU1, CAIO M. PIMENTA1, HEVERTON A. PEREIRA1,2, VICTOR F. MENDES1,3, GABRIEL A. MENDONÇA1,
SELÊNIO R. SILVA1
1

Graduate Program in Electrical Engineering - Federal University of Minas Gerais - Av. Antônio Carlos 6627,
31270-901, Belo Horizonte, MG, Brazil
2

3

Department of Electrical Engineering - Federal University of Viçosa - Av. P. H. Rolfs, sn, Campus
Universitário, 36570-000, Viçosa, MG, Brazil

Department of Electrical Engineering - Federal University of Itajubá - R. Irmã Ivone Drummond 200, Campus
Itabira, 35903-087, Itabira, MG, Brazil

E-mails silasyl@gmail.com, pimenta@cpdee.ufmg.br, heverton.pereira@ufv.br,
victormendes@unifei.edu.br, gforti@gmail.com, selenios@dee.ufmg.br
Abstract This paper evaluates the harmonic propagation in systems with aggregated doubly fed induction generators (DFIG),
as regards of wind-power generation farms. Frequency-domain theoretical analysis and modeling is developed for the variable
speed generation system elements, as well as for the machine topology used, and their impacts in behavior of the overall system
are verified. A study based on a real case is done and the results are analyzed.
Keywords Wind Farm, Harmonic Analysis, Frequency Domain Simulation, DFIG.
Resumo Este artigo aborda uma análise de avaliação de propagação de harmônicos em sistemas com geradores de indução duplamente alimentados (DFIG) agregados, no que se refere a sistemas de geração_eólica. São desenvolvidas uma análise e modelagem teóricas no domínio da frequência para os componentes do sistema, assim como para a topologia de máquina empregada, e
seus impactos sobre a ressonância global do sistema são verificados. Um estudo baseado em um cenário real é realizado e seus
resultados são analisados.
Palavras-chave .

1

Introduction

Worldwide there is a concern about the utilization of alternative sources of clean energy and wind
power is one of the most used alternatives. Most
wind turbines installed use static power converters
and the aggregation of a large number of converters,
as usually happens in wind farms, may lead to power
quality issues like harmonic resonances, in both
voltage and current.
Nowadays there are many variable-speed wind
turbine technologies 1, 2. This paper refers to the
doubly-fed induction generator (DFIG), which is
currently the one with the largest growth, both in
capacity as in units sold 3, in wind farm application. It is justified due to the low power converters,
which have a fraction of the rated power of the machine, and its flexibility of operation at variable
speed 4, 5.
It is known that the usage of static power converters leads to injection of harmonic currents in the
system, due to its switching nature 6, 7. The
DFIG topology employs two static converters. While
the machine stator circuit is directly connected to the
grid, the rotor circuit is fed through the two converters, on back-to-back topology, interconnected by a

ISBN 978-85-8001-069-5

DC bus. The RSC (Rotor Side Converter) is connected to the rotor of the machine, while the GSC (Grid
Side Converter) is connected to the network through
a filter and a step down transformer. This filter is
used to attenuate the harmonic currents injected by
the GSC and can be L 8, LC or LCL 9 filters,
among others. The whole system is fed by a distribution transformer. The DFIG schematic can be seen in
Figure 1.

Figure 1. Doubly Fed Induction Generator Schematic

The harmonic propagation of DFIG is more
complex than the harmonic propagation arising from
other topologies using static inverters as well 10,
11. While technologies like field-controlled synchronous generator (PMSG) with full-power converter 12 there is the influence of only one of the
converters, the one which is connected to the grid,
1909

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

DFIG contributes with both converters. The harmonics generated by the GSC spread to the grid through
the filter and step down transformer, while the harmonics generated by the RSC are reflected from the
rotor to the stator and flow from that to the network
13, 14.
The study of the harmonics is achieved through
the analysis of the equivalent impedance at the point
of common coupling of the system. This analysis is
important since each generator has a passive filter
and when they are aggregated it can result in unexpected resonance frequencies. The effects of nonlinear loads present in the system may be evaluated,
therefore, by the frequency dependency of system
impedance 15.
In the system there may exist series resonances
due to the interactions between the distribution transformer impedance with the capacitive filter impedance, or parallel resonances, due to the inductive and
capacitive impedances. In case 1, harmonic voltages
may lead to high harmonic currents. In case 2, harmonic currents in the mesh between the elements
may cause high voltage harmonics.
The aggregation of many units in parallel, along
with their inverters and filters, may lead to resonance
problems 16, 17. The project of the filter must
take into account the individual harmonic distortion
of the inverter as well as the whole group behavior.
To analyze the harmonic effects onto the impedances and loads of the system, it can be used two

models Thévenin and Norton equivalents. Thévenin
model is more adequate for evaluating harmonic
propagation under a distorted voltage power grid,
while Norton model is adequate for modeling nonlinear loads that inject harmonic currents.
The objective of this paper is the modeling and
analysis of harmonic propagation in aggregated
DFIG wind farms. This problem is first addressed
theoretically and then the analysis is made based in a
real case scenario.
This paper is organized as follows. Initially, the
real system in the case study is described in section
2. Section 3 theoretically analyses the single DFIG
converter system, showing the assumptions made for
the modeling and control strategies. The aggregated
system model is derived from the single inverter
system in Section 4. Section 5 shows the case study
results and Section 6 presents the conclusions.
2

Wind Farm System Description

The wind farm considered for the case study is a
fictitious one, based on a real wind farm located in
the northeastern region of Brazil 18. Here it is considered that it has a nominal generation power of 56
MW, with 28 generators. These generators are connected in three parallel feeders, the first one having
10 machines and the others 9 machines.

Figure 2. Wind Farm Single-Line Diagram with DFIG

ISBN 978-85-8001-069-5

1910

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

The real machines installed at the wind farm are
all PMSGs with full-power back-to-back static converters, but in this study it is assumed that all the
machines are DFIGs.
Furthermore, each generator has an LCL output
filter in order to attenuate high-frequency currents
caused by the PWM switching of the GSC. The second inductive component of the filter is a step down
transformer (called here as rotor transformer), of
35 of the rated power of the machine. It adjusts the
voltage level for the GSC from 690 V to 230 V. The
entire machine is fed by a second transformer (called
here as stator transformer) which raises the voltage
of the stator (690V) to the sub-transmission level
(34.5kV).
The grid connection is done through a substation
that raises the 34.5kV voltage to 69kV. The single
line diagram of the wind farm, including the cabling,
is shown in Figure 2.
The original wind farm, with the PSMGs, presents harmonic current and voltage levels over the
grid code regulation limits when there are 19 or more
generators connected. This is caused by resonance
problem. The situation is similar with the DFIGs,
presented in this paper.
3

Figure 3 shows the controlled models, for both
converters. Figure 3 (a) regards the PR control applied to GSC, with the LC filter and the rotor transformer. Figure 3 (b) regards the PI control applied to
RSC, with the single phase model of the machine,
showing just the inductances. It is assumed as well
that the controlled voltage source of RSC has only
the fundamental voltage. Therefore Figure 3 (b) takes
into account only the magnitude of the voltage
source, reflected from the rotor to the stator.

(a)

Single DFIG Modeling and Control

For simplicity purposes, as usual in balanced
analysis of three-phase systems, the electric system
will be represented by its single-phase equivalent.
At first, it will be also considered that the static
converters do not produce harmonic currents, thus
modeling it as an ideal controlled voltage source
19. Later, on Section 4, it will be shown that it is
not difficult to include this current injection onto the
analysis, and in Section 5, it will be done an analysis
considering the harmonic currents due to the converters.
The GSC is responsible for controlling the DC
link voltage and the reactive power that flows from it
to the grid. It is used a PR control for GSC and it
controls the current
that leaves the rotor transformer, with an internal proportional gain loop for
the control of the filter capacitor current
. This
control was chosen for the GSC because it is similar
to the PI control, of easy tuning, and it achieves zero
error in amplitude and phase for the controlled variable .
The RSC is responsible for controlling both active and reactive power that flows from the machine
to the grid. It is used the standard technique Field
Oriented Control (FOC) using PI regulators. The
inner loop controls the current and the outer loop
controls the power. For the purpose of this study, it is
considered a steady state of the system and by taking
the assumption of the GSC as an ideal controlled
voltage source, the same can be done to the RSC and
only the rotor current control loop is considered in
the modeling.

ISBN 978-85-8001-069-5

(b)

Figure 3. Single Inverter Single-Phase Model and Control Scheme
(a) GSC (b) RSC

The PR controllers transfer functions are expressed in the equations (1) and (2) below. In order
to achieve a simplest notation, the gain
, which
represents the equivalent gain of the system PWM
modulator + inverter is made as part of the gain
.
The notation
is used for the grid frequency. The
PI controllers transfer function is expressed in the
equation (3).
(1)
(2)
(3)
Parameters used were
,
, and
for
.

and
and

for

1911

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

In order to analyze the harmonic propagation in
the system, the system equivalent output impedance
is needed. It is show in Figure 4, considering both
converters.

version in the stator and rotor inductances and operation of the machine with slip. The transformation
from the rotor to the stator is expressed in equation
(9) 20, where
is the stator resultant harmonic
frequency, is the grid frequency, is the slip and
is the rotor harmonic order . As can be seen, equation
(9) depends on the machine slip and once the slip
isnt an integer number, there are expressive
interharmonics in the stator.
(9)

4

Figure 4. System equivalent output impedance for DFIG

As can be seen from Figure 4, both converters
are in parallel before the stator transformer. Therefore the equivalent impedance is given by

Aggregated System Modeling

Each DFIG can be modeled as a current source
in parallel with its output impedance
. As mentioned on Section 3, this representation also allows
harmonic current injection, which will be done later.
Figure 5 shows the pi-model equivalent that is
used to model the cables. Its parameters are shown in
Table 1.

(4)
(5)
(6)

Figure 5. Cable Pi-Model Equivalent
Table 1. Cabling Electrical Parameters (XLPE 2035kV)

This expression leads us to
Size 

(7)

185
95
70

0.130
0.248
0.344

384.62
424.41
445.63

196.10
158.71
143.90

(8)
Each of the three parallel groups of the wind
farm is modeled as shown on Figure 6.
where

,
,
,
,
,
and is the slip.
Several works published concerns about the
harmonics generated by DFIG. In Section 5, it will
be done an analysis with the harmonic currents injected by DFIG to the grid. As stated in 13 there are
many sources for harmonics and interhamonics in a
system using DFIG. Furthermore, the harmonics of
switching converters may deviate from the standard
harmonic sequence characteristics and all high-order
harmonics may have positive and negative sequence
components. Since the current harmonics of wind
turbines stochastically vary with the time 11, this
study will work with specific and stationary harmonics.
The harmonic currents considered here are the
characteristic ones inherit to the PWM process and
the interharmonics that appear due to frequency con-

ISBN 978-85-8001-069-5

Figure 6. Parallel Generation Group

The whole system studied can be easily represented by a matrix, where the buses are each DFIG
output terminals 19. Figure 7 presents the whole
model for the wind farm system, by including every
group and the power grid (represented by its Norton
equivalent).
The matrix can be expressed for each harmonic order, thus yielding a
matrix. Inverting it
leads us to the
matrix, whose diagonal terms
express the impedance in each bus.

1912

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

5.1 Case (a)  10 DFIGs
The results are shown in Figure 8.
The impedance is similar in both cases between
the buses and there are several series and parallel
resonances in these figures.
Strong series resonance occurs near the 19nd
harmonic and strong parallel resonances occur near
the 11th and 21st harmonics.

Figure 7. Full Wind Farm System Model

5

Results and Analysis

System simulation is done in six different cases
a. Only the first generating group (10
DFIGs) is connected,
b. Both first and second group are connected
(19 DFIGs total) and
c. All groups are connected (28 DFIGs total).
d. First group with harmonic current injection
e. Both first and second group with harmonic
current injection
f.
All groups with harmonic current injection
First the harmonic impedance versus frequency
is investigated, and then the harmonic currents are
inserted in the system. The results on some of the
buses will be shown. The harmonic currents used are
from Table 2, taken from experimental data.
Table 2. Harmonic Current Injection per Inverter.
Frequency
(Hz)
120
240
300
420
480
600
420
480
600
660
780
840
960
1020
1140
1200
1320
1380
1500
1560
1680
1740
1860
2100
2220
2460
2580
3000

Harmonic
Order
2
4
5
7
8
10
7
8
10
11
13
14
16
17
19
20
22
23
25
26
28
29
31
35
37
41
43
50

ISBN 978-85-8001-069-5

 Fundamental
0,3429
0,2009
0,4354
0,4707
0,4014
0,5449
0,4707
0,4014
0,5449
1,4560
1,8535
0,4746
0,3705
0,7609
0,4203
0,3243
0,3298
0,3693
0,2349
0,2004
0,1328
0,2709
0,2400
0,3495
0,2589
0,1568
0,1077
0,1059

Figure 8. Case (a) Impedance Results

5.2 Case (b)  19 DFIGs
The results are shown in Figure 9.
In this case, we can see that the impedance seen
by each bus is increased as we go farther away from
the PCC. Once again, several series and parallel
resonances occur.
For the impedance seen from the PCC, strong
series resonance occurs near the 19th, 36th and 38th
harmonics and parallel resonances occur near the 20th
and 37th harmonics.
The results from the 1st and 2nd group are similar,
so just one of them is shown. In the DFIG bus, series
resonance occurs near the 20th harmonics and parallel
resonances occur near 19th and 36th.
We can see that the result is different from the
case (a). Due to more DFIGs connected to the system, the parallel resonance is shifted to a higher
order. This prevents further problems with lower
harmonics.
1913

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

For the DFIG bus of the 1st group, series resonance occurs around the 20th harmonic and parallel
resonance occurs near the 36th harmonic.

Figure 9. Case (b) Impedance Results

5.3 Case (c)  28 inverters
The results are shown in Figure 10.
Here we can see similar results to case (b). Once
again the impedance is increased as we go farther
away from the PCC and once again we have several
series and parallel resonances. The critical problem
exposed in section 5.2 is also present.
From the PCC, the resonances occur at the same
harmonics as the previous case, but they are attenuated.

ISBN 978-85-8001-069-5

Figure 10. Case (c) Impedance Results

Finally, for the bars of the 2nd group, series resonance occurs around the 20th harmonic again and
parallel resonance occurs near the 36th and 38th harmonics.
5.4 Case (a)  10 DFIGs with Harmonic Current
Injection
The results are shown in Figure 11.

1914

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

5.6 Case (c)  28 DFIGs with Harmonic Current
Injection
The results are shown in Figure 13.

Figure 11. Case (a) Voltage Results

Due to the higher impedance module near the
11th harmonic and the higher current in the 11 th harmonic as well, the harmonic voltage in this order is
very high, reaching almost 0.4 pu. This is a serious
problem and it is essential that a filter is projected to
attenuate the high voltage harmonics around this
order.
5.5 Case (b)  19 DFIGs with Harmonic Current
Injection
The results are shown in Figure 12.

Figure 13. Case (c) Voltage Results

Once again we see that the results are similar to
case (b). The harmonic voltage behavior shows higher harmonics around the 36th harmonic. The peak in
this case is higher due to the presence of
interharmonics and more DFIGs injecting current.
6

Figure 12. Case (b) Voltage Results

The harmonic voltage shows a different behavior
compared to case (a), due to the different harmonic
impedance of the system. Since the parallel resonance is shifted to higher orders, the voltage peak is
shifted as well. It can be seen yet that the voltage
harmonics from the 1st Group is higher than the 2nd
Group. It is justified by the different harmonic impedances in Figure 9.
ISBN 978-85-8001-069-5

Conclusions

This work showed the importance to study the
aggregated model of a wind farm. It is important to
know the system impedance, as well as the model of
the machines used, to achieve a precise result for the
system equivalent output impedance model.
All the elements of the system are important, because they are frequency dependent and the whole
system can result in resonance frequencies, that is not
a problem while with a single machine.
The analysis on the results showed that increasing the number of aggregated DFIGs in the wind
farm caused a shift to the harmonic impedance resonance order, as well as harmonic voltage. Therefore
it is very important to study all the possible operation
points of the system, to avoid unexpected harmonics.
It is necessary, in future studies, to improve the
model, to achieve an aggregate model of a wind farm
with DFIGs and represent all the harmonic currents
from DFIG systems.

1915

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

Acknowledgements
This work has been supported by the Brazilian
agencies CNPq, FAPEMIG and CAPES.
References
1. Yazdani, A. Iravani, R. "Voltage-Sourced
Converters in Power Systems Modeling,
control, and applications." S.l. WILEY and
IEEE PRESS, 2010.
2. Pereira, H. A. Liu, S. Y. Ramos, M. C. L.
Mendes, V. F. Silva, S. R. , "A Comparative
Analysis of Wind Turbine Technologies in
Focus on the Grid Integration," 9th IEEEIAS
International
Conference
on
Industry
Applications (INDUSCON), 2010, São Paulo,
Brazil.
3. R. G. Oliveira, Contribuição ao Controle de
um Sistema de Geração a Velocidade Variável
Utilizando Gerador de Indução Duplamente
Excitado, Doctors Thesis, CPDEE  UFMG,
Minas Gerais, Brazil, April 2009.
4. Flores Mendes, V. de Sousa, C.V. Rocha
Silva, S. Cezar Rabelo, B. Hofmann, W. ,
"Modeling and Ride-Through Control of
Doubly Fed Induction Generators During
Symmetrical
Voltage
Sags,"
Energy
Conversion, IEEE Transactions on , vol.26,
no.4, pp.1161-1171, Dec. 2011.
5. Liu, S.Y. Mendes, V.F. Silva, S.R. ,
"Analysis of direct power control strategies
applied to doubly fed induction generator,"
Power Electronics Conference (COBEP), 2011
Brazilian , vol., no., pp.949-954, 11-15 Sept.
2011.
6. Wang, Q. Chang, L. , "PWM control
strategies for wind turbine inverters," Electrical
and Computer Engineering, 1998. IEEE
Canadian Conference on , vol.1, no., pp.309312 vol.1, 24-28 May 1998.
7. Hanitsch, R.E. Schulz, D. , "Wind energy
converters and some aspects of power quality,"
RIO 3 - World Climate  Energy Event, 1-5
December 2003, Rio de Janeiro, Brazil.
8. Ponnaluri, S., Krishnamurthy, V.,  Kanetkar,
V. (2000). "Generalized System Design 
Analysis of PWM based Power Electronic
Converters". Industry Applications Conference,
2000. Conference Record of the 2000 IEEE ,
pp. 1972 - 1979 vol.3.
9. Erika Twining Holmes, D.G. , "Grid current
regulation of a three-phase voltage source
inverter with an LCL input filter," Power
Electronics, IEEE Transactions on , vol.18,
no.3, pp. 888- 895, May 2003.
10. Lindholm, M. Rasmussen, T.W. , "Harmonic
Analysis of Doubly Fed Induction Generators,"
in 5th International Conference on Power
Electronics and Drive Systems, Singapore, pp.

ISBN 978-85-8001-069-5

837-841, November 2003.
11. Papathanassiou, S.A. Papadopoulos, M.P. ,
"Harmonic Analysis in a Power System with
Wind Generation," IEEE Transactions on
Power Delivery, vol. 21, no. 4, pp. 2006-2016,
October 2006.
12. Molina, M.G. Sanchez, A.G. Lede, A.M.R. ,
"Dynamic modeling of wind farms with
variable-speed direct-driven PMSG wind
turbines," Transmission and Distribution
Conference and Exposition Latin America
(TD-LA), 2010 IEEEPES , vol., no., pp.816823, 8-10 Nov. 2010.
13. Saniter, C. Schulz, D. Hanitsch, R.E. ,
"Harmonics and Interharmonics Generated by
Wind Energy Converters-Measurements and a
Novel Modelling Aproach in the Frequency
Domain," in 4th International Workshop on
Large-scale Integration of Wind Power and
Transmission Networks for Offshore Wind
Farms, Denmark, pp. 1-10, October 2003.
14. Schulz, D. Torgnon, E. Hanitsch, R. ,
"Investigation of the harmonic transformation
properties of double fed induction generators in
wind energy converters," in PCIM Power
Quality Conference, Alemanha, May 2003, pp.
1-6.
15. IEEE. IEEE Recommended Practice for
Industrial and Commercial Power Systems
Analysis. S.l.. 1998.
16. M. C. Benhabib, P. R. Wilczek, J. M. A.
Myrzik, and J. L. Duarte, Harmonic
interactions and resonance problems in large
scale networks, in Proc. Power Syst. Comput.
Conf., Jul. 2008, pp. 18.
17. Enslin, J.H.R. Heskes, P.J.M. , "Harmonic
interaction between a large number of
distributed power inverters and the distribution
network,"
Power
Electronics,
IEEE
Transactions on , vol.19, no.6, pp. 1586- 1593,
Nov. 2004.
18. Mendonça, G. A. Pereira, H. A. Silva, S. R.
"Wind farm and system modelling evaluation
in harmonic propagation studies". International
Conference on Renewable Energies and Power
Quality,
(ICREPQ12),
Santiago
de
Compostela, Spain, March 28 to 30, 2012.
19. Fei Wang Duarte, J.L. Hendrix, M.A.M.
Ribeiro, P.F. , "Modeling and Analysis of Grid
Harmonic Distortion Impact of Aggregated DG
Inverters,"
Power
Electronics,
IEEE
Transactions on , vol.26, no.3, pp.786-797,
March 2011.
20. Liu, S.Y. Silva, S.R. , "Análise dos
harmônicos e inter-harmônicos no gerador de
indução duplamente alimentado empregando
controle_direto de potência," in IX Conferência
Brasileira sobre Qualidade da Energia Elétrica
(CBQEE), 31 July to 3 August, 2011, Brazil.

1916