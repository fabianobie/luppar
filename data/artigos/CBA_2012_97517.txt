Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

SISTEMA PARA CAPTURA DE SINAIS ELETROMIOGRÁFICOS DE SUPERFÍCIE COM SETE
CANAIS UTILIZANDO MÓDULO FREESCALE TOWER S08MM128
TIAGO P. DE ALMEIDA, CARLOS A. FERRI, ANTÔNIO A. F. QUEVEDO
Depto. de Eng. Biomédica da Fac. de Eng. Elétrica e de Computação  Centro de Eng. Biomédica,
UNICAMP
Caixa Postal 6040, 13083-852, Campinas, SP, BRASIL
E-mails tpaggi@ceb.unicamp.br, caferri@ceb.unicamp.br, quevedo@ceb.unicamp.br
Abstract Electromyography (EMG) provides information about muscle and motor neuron physiology. It is known that pathological conditions in the neuromotor system can affect the characteristics of the myoelectric signals captured by EMG. Although EMG
provides important information regarding the characteristics and neuromuscular activity from a subject, it still faces some issues that
must be addressed and understood for its proper application, such as the influence of myoelectric signals from adjacent muscles,
which contributes to unwanted signals and crosstalk. Additionally, the recruitment of skeletal muscles is complex, and is based on
more muscles than necessary for accomplishing a single movement. The purpose of the present work is to develop a system capable of
capturing surface electromyographic signals (sEMG) that will be part of a sEMG decomposition system using Blind Source Separation (BSS) techniques, as Independent Components Analysis (ICA). The system consists of seven channels, each one comprising filters, biopotential amplifiers, programmable gain amplifiers, TOWER  S08MM128 as processing unit, a communication interface
with the computer, and a software developed in Visual Basic environment for controlling signal acquisition. The results supports the
idea that the system meets the required specifications for sEMG acquisition found in theory, and is capable to capture sEMG signals.
Keywords Surface Electromyography, Blind Source Separation, Biopotential Amplifier, Biological Signal Processing.
Resumo A eletromiografia (EMG) fornece informações sobre o estado fisiológico do músculo e dos neurônios motores envolvidos.
Sabe-se que em condições patológicas do sistema neuromotor, as características dos sinais mioelétricos capturados na EMG podem
sofrer alterações. Apesar de fornecer informações importantes sobre as características e atividade neuromuscular do indivíduo, a
EMG ainda possui algumas limitações que devem ser entendidas e consideradas para seu bom uso, como a influência de sinais mioelétricos provenientes de músculos adjacentes, gerando ruídos ou crosstalk. Adicionalmente, o recrutamento de músculos esqueléticos
é complexo, e baseia-se em mais músculos que o necessário para um único movimento. Este projeto tem por objetivo desenvolver um
sistema de captura de sinais eletromiográficos de superfície (sEMG) que integrará futuramente um sistema de decomposição de sinais
sEMG utilizando Análise de Componentes Independentes (ICA). O sistema é composto por sete canais com filtros, amplificador de
biopotenciais, amplificador de ganho programável, módulo TOWER S08MM128 como interface de processamento, uma interface
de comunicação com o computador e um software desenvolvido em Visual Basic para controle da captura dos sinais sEMG. Os resultados mostram que o sistema desenvolvido está dentro das especificações para captura de sinais sEMG encontradas na teoria, e é
capaz de capturar sinais sEMG.
Palavras-chave .

1

Introdução

O sistema nervoso central (SNC) envia informações aos músculos através de pulsos elétricos por
meio de motoneurônios-alfa. O corpo celular desses
neurônios é localizado na medula espinhal e suas
terminações axônicas inervam fibras musculares.
Uma unidade motora (UM) consiste em um conjunto
de fibras musculares inervadas pelo mesmo neurônio
motor (Basmajian e De Luca, 1985). O SNC regula
a força exercida por um músculo através de dois
mecanismos o número de UMs recrutadas e a modulação da taxa de disparos do potencial de ação de
uma UM (Loeb et al, 2000). Uma forma de estudar
as características do sistema neuromuscular é através
da análise de potenciais de ação (PA) associados ao
recrutamento de UMs. Os potenciais de ação de uma
unidade motora (MUAP  Motor Unit Action Potencial) podem ser detectados invasivamente ou na superfície da pele, sendo o sinal resultante chamado
eletromiograma. O sinal eletromiográfico (sinal
EMG) é um sinal elétrico resultante do transiente

ISBN 978-85-8001-069-5

iônico devido a MUAPs capturados por eletrodos
invasivos ou não invasivos, e permite inferir sobre a
integridade do sistema neuromuscular pela análise
das formas de onda dos MUAPs (Basmajian e De
Luca, 1985). Eletrodos invasivos capturam PAs de
até uma única UM, porém o procedimento é demorado e incômodo. Eletrodos de superfície permitem
detectar PAs de modo não invasivo, porém os sinais
EMG de superfície (sinais sEMG) são misturas espaço-temporais de vários MUAPs que dependem de
fatores como a espessura e condutividade das camadas subcutâneas, da profundidade da fonte e da geometria dos eletrodos, resultando em um sinal com
aparência de ruído aleatório, dificultando uma análise (De Luca, 2006). Com isso, torna-se impossível
obter qualquer informação a priori das fontes (nesse
caso os MUAPs) e da função de mistura dessas fontes (Farina et al, 2004). A decomposição desses sinais complexos nas suas constituintes MUAPs é importante para inúmeras aplicações, como o controle
de próteses (Graupe e Cline, 1975), a diminuição do
efeito de crosstalk no sinal capturado (Farina et al,
2004) e diagnóstico clínico (Wood et al, 2001).

490

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

Os principais parâmetros a serem observados em um
sistema de captura de sinais sEMG são (Quevedo,
1993) ruído intrínseco do sistema ganho e largura
da banda do sinal impedância de entrada em modo
comum razão de rejeição de modo comum (CMRR
 Common Mode Rejection Ratio). De Luca (De
Luca, 2006) mostra que um sistema de captura não
deve ter ruído maior que 2VRMS. O sinal sEMG
possui tensões de pico da ordem de 50V a 5mV
(Quevedo, 1993) e uma faixa de frequência de 20Hz
a 500Hz (De Luca, 2006), com energia dominante
entre 20Hz e 150Hz (Karlsson et al, 2008). De Luca
(De Luca, 2006) recomenda que a impedância de
entrada de modo comum seja a maior possível, idealmente maior que 10157pF, CMRR a 85dB.
1.1 Separação Cega de Fontes
A Separação Cega de Fontes (BSS  Blind
Source Separation) compreende métodos que visam
estimar sinais originais, ou fontes, a partir de um
conjunto de misturas que contém as fontes. Cada
UM pode ser considerada uma fonte independente.
Se os sinais independentes forem misturados e existirem o mesmo número de misturas, ou mais, que o
número de fontes, os sinais originais podem ser extraídos a partir das misturas, sem conhecimento prévio das características dos sinais originais
(Hyvrinen et al, 2001). A ICA é uma das diversas
técnicas dentro de BSS, e consiste na separação de
fontes baseada na maximização da independência
estatística das fontes (Hyvrinen et al, 2001). Considere a seguinte transformação linear

x ( t )  As ( t )

(1)

onde x(t)  x1(t),x2(t), ...,xn(t) são as misturas capturadas, s(t)  s1(t), s2(t), ..., sm(t) são as fontes
originais e A é a matriz de mistura n  m. Partindo
do pressuposto que 1) as n componentes de s são
independentes 2) A e s são desconhecidos, ou seja,
não se tem informações prévias sobre as fontes tampouco sobre o processo de mistura 3) o número de
misturas é maior ou igual ao número de fontes (n 
m) tem-se

y  Wx  WAs

1.2 O Módulo Tower S08MM128
S08MM é a série de 8 bits da família Flexis
MM da Freescale. Este microcontrolador possui
um baixo consumo de potência, conexão USB e conversor_analógico-digital com alta precisão (16bits),
permitindo que projetistas possam integralizar um
maior numero de componentes a baixo_custo. Esta
linha é ideal para aplicações médicas ou aplicações
em geral que necessitem de maior precisão (Freescale, 2010).
O TWR-S08MM128 é um módulo de demonstração
e desenvolvimento com baixo_custo que integra um
microcontrolador MC9S08MM128. O TWRS08MM128 pode operar como um módulo único, ou
pode ser integrado como placa de controle central
em um sistema TOWER com módulos periféricos,
por exemplo, AD 16 bits, módulos SCI e módulos
SPI (Freescale, 2010).
Este trabalho teve como objetivo o desenvolvimento
de um sistema com sete canais capaz de capturar
sinais sEMG fidedignos utilizando o TWRS08MM128 como módulo de controle central em um
sistema TOWER. Este sistema integrará, futuramente, um sistema para captura e decomposição de sinais sEMG nos MUAPs constituintes utilizando técnicas de BSS.

(2)

onde y(t)  y1(t),y2(t), ...,ym(t) são as estimativas de
s e W é a matriz de separação m  n. O propósito da
ICA é encontrar W tal que, caso as misturas x forem
transformações lineares previamente branqueadas
das fontes originais, as componentes de y tenham
distribuição menos gaussiana possível, garantindo
independência estatística, estimando as componentes
de s.
Técnicas de BSS têm se mostrado promissoras para
separação de sinais sEMG, com aplicações em análiISBN 978-85-8001-069-5

se da estratégia do SNC na contração_muscular, detecção de intervalos de ativação muscular e controle
de próteses. Em 2004, Farina e colaboradores (Farina et al, 2004) conseguiram separar sinais sEMG de
dois grupos musculares distintos utilizando técnicas
de BSS que utilizam estatística de segunda ordem.
Nakamura e colaboradores (Nakamura et al, 2004)
conseguiram isolar MUAPs de uma mesma UM em
uma componente independente a partir de sinais
sEMG utilizando ICA e compararam os resultados
com sinais descorrelacionados por Análise de Componentes Principais, concluindo que a ICA deveria
ser utilizada somente como um dentro de vários passos para decomposição de sinais sEMG. García e
colaboradores (García et al, 2005) utilizaram ICA
como uma etapa na decomposição de sinais sEMG
em contrações até 60 da máxima contração voluntária, que incluía também uma série de filtros_digitais, além de técnicas de template_matching.

2 Metodologia
2.1 Construção do Sistema de Captura
A teoria da Separação Cega de Fontes mostra
que é possível separar fontes a partir de misturas
conhecidas se e somente se o número de misturas for
maior ou igual ao número de fontes. Com esse propósito, desenvolveu-se um sistema com sete canais
com a finalidade de capturar sinais sEMG (Figura
1). O sistema é alimentado por uma fonte de 5V e
491

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

Conversor AD

PDB

Figura 2. Módulos e periféricos do TWR-S08MM128 utilizados
neste trabalho.

Fonte de alimentação. Para alimentação dos blocos
de primeiro estágio de amplificação, filtro passafaixas e o segundo estágio de amplificação de ganho
programável utilizou-se uma fonte simétrica regulada em 5V. Duas baterias comuns de 9V foram utilizadas para gerar tensões de 9V, sendo regulada
para +5V e -5V utilizando-se reguladores_de_tensão
UA7805 e LM7905, respectivamente. O TWRS08MM128 foi alimentado através do cabo USB
conectado ao computador, pois consome corrente
muito alta para que seja suportada por longos períodos pelas baterias de 9V. O grampeador utilizou
tensão de 3,3V regulada pelo próprio TWRS08MM128.
Primeiro estágio de amplificação. Também conhecido como amplificador_de_biopotenciais, é composto
por um amplificador de instrumentação e um filtro
ISBN 978-85-8001-069-5

+

SPI

8

-

SCI

+

Microcontrolador
MC9S08MM128

7

-

Freescale TOWER MC9S08MM

+

Figura 1. Diagrama em blocos do sistema de captura de sinais
sEMG. Explicação no texto.

6

-

Conversor
AD

+

Computador

5

-

Grampeador
de Tensão

SCI

+

Segundo
Estágio de
Amplificação

4

-

Fonte de
Alimentação

Filtro
Passa-faixa

3

+

Primeiro
Estágio de
Amplificação

2

-

SPI

Elementos da Matriz de Eletrodos
1

+

Freescale TOWER MC9S08MM

passa-faixas. A configuração de montagem dos amplificadores de instrumentação para os sete canais
pode ser vista na Figura 3, e garante que os sinais
sEMG capturados sigam a direção de propagação
dos MUAPs em análise quando posicionados corretamente no músculo em questão.

-

3V. Cada um dos canais é constituído por primeiro
estágio de amplificação e filtro passa-faixa (10Hz a
1kHz) segundo estágio de amplificação de ganho
programável (PGA  Programable Gain Amplifier)
grampeador de tensão conversor AD 16 bits interface de Comunicação Serial (SCI  Serial Communication Interface) interface Periférica Serial (SPI 
Serial Peripheral Interface) computador pessoal
(PC  Personal Computer). O conversor AD, o SCI
e SPI são módulos do TWR-S08MM128, sistema
embarcado gentilmente doado pela Freescale. A Figura 2 mostra os componentes do TWR-S08MM128
utilizadas neste trabalho.
Desenvolveu-se um software em Visual Basic para
controle e armazenagem dos sinais capturados. Gráficos foram criados a fim de auxiliar na análise e
captura. Os sinais são capturados, amplificados, filtrados e transmitidos serialmente para um PC, onde
são armazenados. O ganho do PGA é calculado no
PC, transmitido e atualizado através do SCI e SPI.

INA129
Canal G Canal F

Canal E Canal D Canal C Canal B Canal A

Figura 3. Configuração de entrada dos amplificadores diferenciais
dos sete canais.

Devido  simplicidade de projeto, utilizou-se o amplificador de instrumentação INA129, da Texas Instruments, no primeiro estágio de amplificação. O
ganho foi fixado em 20dB (10VV), de maneira a
evitar que fossem atingidos os valores máximos na
escala de tensão do circuito, limitado pelo conversor
AD (3,3V). Com essa configuração, o INA129 apresenta resposta em frequência plana até frequências superiores a 100kHz, muito acima do desejado
para nossa aplicação.
Um filtro passa-faixas foi projetado a fim de limitar
as componentes de frequência do sinal capturado ao
espectro de frequência de sinais sEMG. Contudo,
considerou-se a frequência de corte do filtro passabaixa em 1kHz, a fim de permitir investigações em
sinais sEMG de sujeitos hígidos e de sujeitos com
algum tipo de desordem neuromuscular que eventualmente tenha o espectro de frequência alterado. O
filtro passa-alta foi projetado seguindo instruções
presentes no datasheet do INA129. A construção
deste circuito envolve a conexão de um filtro passabaixa  realimentação do INA129. Com isso, a frequência de corte estipulada para o filtro passa-alta se
torna igual  frequência de corte para o filtro passabaixa. Desta forma, projetou-se um filtro passa-alta
de primeira ordem com frequência de corte em
10Hz, visando eliminar componentes DC e artefatos
de movimento de baixa frequência. O filtro passabaixa, por sua vez, foi dimensionado de tal forma a
eliminar componentes superiores a 1KHz. Optou-se
por um filtro passa-baixa Butterworth de dois polos,
na configuração Sallen-Key, devido  sua banda
passante plana e ao corte suficientemente abrupto
para nossa aplicação. Utilizou-se o software FilterPro Desktop Versão 3.0.28.21072, da Texas Instruments, para projeto do filtro. Utilizou-se o amplificador operacional TL074, da Texas Instruments.
Segundo estágio de amplificação. Após o sinal ser
inicialmente amplificado e filtrado dentro dos limites de frequência de sinais sEMG, o sinal passa pelo
segundo estágio de amplificação, que possui ganho
variável e programável. A amplitude dos sinais
sEMG capturados com esse protótipo pode variar de
492

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

50V a 1mV. Portanto, a fim de garantir maior resolução do conversor AD, o sinal capturado deve ser
amplificado em uma faixa de 3300 a 66000 vezes,
para que o sinal tenha no máximo a tensão de alimentação do conversor AD, ou seja, 3,3V pico-apico (Vpp). Como o sinal fora previamente amplificado em 20dB (10VV), a faixa de amplificação do
segundo estágio passa a ser de aproximadamente 50
a 76dB, respectivamente (330 a 6600 VV). A fim de
atender essa faixa de ganho e garantir que os vários
valores possíveis de ganho, dentro da faixa especificada, também sejam atendidos com boa precisão,
optou-se pelo atenuador LM1973, da National Semiconductors. O LM1973 é, originalmente, um atenuador de áudio de três canais, com o nível da atenuação alterada via SPI, com níveis de atenuação de 0 a
76dB com escala logarítmica. Contudo, o LM1973
pode ser utilizado na realimentação de um amplificador operacional, no caso o TL074, criando um
amplificador de ganho logarítmico. Nessa configuração, os níveis de atenuação se tornam valores de
ganho, com maior valor de ganho de 76dB.
Grampeador de tensão. O sinal sEMG tem alterações na polaridade várias vezes no domínio_do_tempo, o que torna impraticável a conversão AD nessas
condições, pois o conversor usado é monopolar. Portanto, o sinal passa por um grampeador de tensão, o
qual adiciona um nível DC ao sinal a ser convertido.
Esse nível DC é fixo em 1,65V, ou seja, metade da
tensão de alimentação do Conversor AD. Esse valor
DC, junto com o ganho do PGA, garante que a amplitude do sinal grampeado nunca ultrapasse 3,3V e
o valor mínimo do sinal não seja inferior a 0V. O
segundo estágio de amplificação otimiza o ganho de
tal forma que a amplitude do sinal previamente ao
grampeamento é a mais próxima possível de 1,65V,
ou seja, 3,3Vpp. O circuito grampeador de tensão
utiliza um capacitor em série ao sinal, conectado
entre dois resistores que compõem um divisor de
tensão, por sua vez alimentado com a mesma tensão
de alimentação do conversor AD. O circuito é um
filtro passa-alta de primeira ordem, portanto o circuito foi dimensionado para frequência de corte em
1Hz para não influenciar os filtros anteriores.
Conversor AD. O conversor AD do TWRS08MM128 possui oito canais independentes, porém
somente sete foram utilizados. O tempo de conversão foi configurado para 2,71s através da seleção
do barramento de clock, em modo de conversão única e 16bits de resolução, atingindo resolução de
50,35Vbit. Selecionou-se o disparo da conversão
via bloco de atraso programável (PDB  Programmable Delay Block). O PDB é controlado por software, possibilitando o controle do início da conversão no momento desejado, e.g., em uma interrupção.
Sabe-se a partir do Teorema de Nyquist que a taxa
de amostragem para conversão AD deve ser no mínimo duas vezes maior que a maior componente de
frequência presente no sistema. Logo, como a maior

ISBN 978-85-8001-069-5

componente de frequência do sinal capturado foi
limitado em 1kHz, a frequência de amostragem deve
ser maior ou igual a 2kHz. Contudo, na prática sempre se utiliza frequências maiores que a de Nyquist
por praticidade e aumento na resolução dos dados.
Definiu-se que seriam realizados cinco segundos de
captura de sinais sEMG. Considerando-se a frequência de Nyquist para amostragem (i.e, 2kHz), 7 canais e 16 bits por canal (2 bytes), em cinco segundos
seriam necessários 140kB para armazenamento dos
dados convertidos, o que excede a memória interna
para uso geral do TWR-S08MM128, de aproximadamente 128kB. Com isso, a fim de evitar o uso de
memória externa, optou-se pela transmissão dos 14
bytes dos 7 canais logo após a conversão, ou seja, ao
término de cada conversão, os 2 bytes de cada canal
são enviados serialmente através do SCI para o
computador, que salva esses dados em arquivos texto
para processamento posterior. Desta forma, a frequência de amostragem fica limitada pelo baud rate
selecionado para o SCI, que no caso foi de 750kbps.
Calculando a frequência de amostragem a partir do
baud rate, tem-se uma frequência de 6.696Hz. Contudo, devido ao tempo de processamento e atrasos
propositais nos softwares desenvolvidos, a frequência de amostragem é de 5,6kHz, maior que a frequência de Nyquist, o que melhora significativamente a resolução dos dados.
Interface de Comunicação Serial. A SCI é responsável pela comunicação e transmissão dos dados e
PGAs referentes a cada canal entre o PC e a TWRS08MM128. Os dados capturados e os ganhos atuais
dos PGAs são transmitidos do TWR-S08MM128
para o PC, e os ganhos atualizados são transmitidos
do PC para o TWR-S08MM128. O sistema foi configurado para trabalhar em modo full-duplex, baud
rate de 750kbps e 8 bits de dados.
Interface Periférica Serial. A SPI é responsável
pela comunicação e transmissão dos níveis de ganho
referentes a cada canal entre o TWR-S08MM128 e
os respectivos PGAs. Para tal, é necessário definir o
master e o slave para organizar a hierarquia de informações, ou seja, ambos podem enviar e receber
dados, porém somente o master é capaz de controlar
a transmissão_de_dados. O SPI possui quatro vias
para controle e fluxo de informações, DATA IN,
DATA OUT, CLOCK e o SHIP SELECT.
Habilitou-se o TWR-S08MM128 como o master, já
que esse é o dispositivo de processamento central.
Conforme especificado no datasheet do LM1973,
configurou-se o CLOCK em 3kHz com polaridade
positiva, o DATA INOUT com 16 bits.
Computador pessoal. Optou-se pelo desenvolvimento do software de captura em ambiente Visual
Basic V7 devido sua facilidade, funções gráficas,
compatibilidade com ambiente Windows e ferramentas confiáveis para comunicação SCI.
Durante o processo de inicialização do software, são
definidos variáveis de controle, baud rate do SCI

493

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

para comunicação com o TWR-S08MM128, tamanho do buffer do SCI, nome e diretório dos arquivos
texto onde serão salvos os dados provenientes de
cada canal e ganhos iniciais dos PGAs para efeito de
cálculo. O sistema então aguarda instruções do usuário, que podem resultar em quatro ações capturar
sinais atualizar os ganhos dos PGAs reset dos ganhos dos PGAs visualização dos gráficos.
O procedimento de captura de sinais envolve o envio
de um comando para o TWR-S08MM128 para início
da conversão AD e envio dos dados de cada canal.
O TWR-S08MM128 converte as informações dos
sete canais com resolução de 16 bits, porém os dados
são enviados em dois pacotes de 8 bits. Os dados
provenientes de cada canal são concatenados de
forma a recuperar o dado original de 16 bits. Verifica-se se o módulo dos dados é maior que os dados
salvos anteriormente e, caso positivo, esse valor é
salvo para posterior calculo de atualização de ganho
do PGA. Em seguida, os efeitos dos ganhos provenientes do primeiro e segundo estágio de amplificação,
e o nível DC injetado pelo circuito grampeador de
tensão são retirados, tendo-se desta forma o real valor da tensão do sinal EMG capturado. Esse novo
dado é finalmente salvo no arquivo texto do respectivo canal.
O procedimento de atualização dos ganhos dos
PGAs carrega o maior valor em módulo de cada
canal e a diferença entre esse maior valor e o maior
valor permitido na escala de tensão é calculado, levando em consideração o atual ganho do PGA. A
tabela de ganho do PGA foi transcrita para o software, de forma que o ganho calculado é aproximado ao
ganho mais próximo presente na tabela. Essa aproximação garante que o ganho aproximado  tabela
seja menor que o ganho calculado, garantindo que
não ocorra saturação após a atualização do ganho. O
software então envia os novos ganhos dos PGAs ao
TWR-S08MM128 via SCI. Paralelamente, os ganhos de cada canal são mostrados em caixas de texto
localizados na parte superior da interface_gráfica.
Freescale TWR-S08MM128. Todos os módulos
utilizados pelo TWR-S08MM128 foram configurados por programação C e blocos do Processor Expert no software Codewarrior V6.3.
Após a inicialização, o sistema aguarda instruções
provenientes do PC, que podem resultar em três ações capturar sinais sEMG atualizar os ganhos dos
PGAs reset dos ganhos dos PGAs.
Durante o procedimento para captura de sinais, o
TWR-S08MM128 entra em uma interrupção que
realiza a conversão AD dos dados dos sete canais e
o envio desses dados para o PC via SCI.
O procedimento de atualização dos ganhos dos
PGAs ocorre em duas etapas. Inicialmente, o TWRS08MM128 recebe do PC via SCI os dados que representam o ganho de cada um dos canais e, logo
após, o TWR-S08MM128 repassa os ganhos via SPI

ISBN 978-85-8001-069-5

para cada um dos PGAs com o endereço de cada um
dos três canais para cada PGA.
O procedimento para reset dos ganhos dos PGAs é
similar ao procedimento de atualização dos ganhos
dos PGAs, contudo não existe a necessidade de receber os valores de atualização dos ganhos via SCI do
PC, já que o ganho inicial é fixo em 20dB. A Figura
4 sintetiza as operações centralizadas e controladas
pelo TWR-S08MM128.
Inicialização

Recebeu
comando
do PC?

Não

Sim

Capturar
Sinal sEMG

Atualiza
Ganho PGA

Reset dos
Ganhos dos
PGAs

Conversão AD
dos 7 Canais

Recebe
ganhos do PC

Transmite
ganhos inciais
para PGA

Transmissão
dos dados
para o PC

Transmite
ganhos para
PGA
Fim

Figura 4. Fluxograma do script para o TWR-S08MM128. Explicação no texto.

2.2 Validação do sistema de captura
Testes foram realizados para verificar a primeira etapa de amplificação junto com a filtragem do
sinal, a linearidade do conversor AD, o ruído intrínseco do sistema e, finalmente, captura de sinais
sEMG. Para os itens CMRR e impedância de entrada em modo comum considerou-se as características
do INA129 utilizado na primeira etapa de amplificação.
No teste de amplificação e filtragem do sinal, aplicou-se um sinal senoidal com amplitude de 0,2Vpp
produzido por um gerador de funções Tektronix
AFG310. Variou-se a frequência de 0,1Hz a 5kHz,
com o intuito de simular de baixas frequências provenientes de artefatos de movimento a altas frequências provenientes de outras fontes de ruído. Essa
varredura de frequência foi realizada em uma escala
ascendente seguindo 0,1Hz para 5kHz e descendente
seguindo de 5kHz para 0,1Hz. A resolução da varredura procedeu-se da seguinte forma de 0,1Hz, a
0,5Hz, passo de 0,1Hz de 1Hz a 10Hz, passo de
1Hz de 10Hz a 100Hz, passo de 10Hz de 100Hz a
1500Hz, passo de 100Hz de 2kHz a 5kHz, passo de
1kHz. Esse procedimento foi realizado cinco vezes,
tendo a média calculada (Figura 5).
Realizou-se o teste de linearidade do conversor AD
com o intuito de verificar se o conversor AD precisava de calibração. Uma fonte de tensão contínua foi
conectada s entradas dos canais do conversor AD.

494

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

3 Resultados
Dois parâmetros importantes para a caracterização do sistema, o CMRR e a impedância de entrada
em modo comum, foram considerados a partir do
amplificador de instrumentação utilizado no primeiro estágio de amplificação, ou seja, o INA129. Como
o ganho foi fixado em 20dB, o CMRR é de 106dB e

ISBN 978-85-8001-069-5

a impedância de entrada de modo comum é
10119pF.
A Figura 5 mostra o ganho e a resposta em frequência do primeiro estágio de amplificação para variações crescentes e decrescentes na frequência do sinal
de entrada. É possível notar o platô de ganho entre
as frequências 10Hz e 1kHz, com atenuações para
frequências fora dessa faixa. A queda de 3dB caracterizada como a frequência de corte do filtro passafaixa ocorre em aproximadamente 10Hz e 900Hz,
conforme previsto nos cálculos. Os desvios-padrão
para cada ponto na Figura 4 foram calculados a partir das cinco capturas, contudo são muito pequenos,
não ultrapassando 0,03dB.

Ganho e Resposta em Freqência
do Primeiro Estágio de Amplificação
Escala ascendente
Escala descendente

30
10Hz

Ganho (dB)

20

900Hz

-3dB

10
0
0.1

1

10

100

1000 10000

-10
-20

Frequência (Hz)

Figura 5. Ganho e resposta em frequência do filtro passa-faixa.

A Figura 6 mostra a linearidade do conversor AD,
ou seja, o quanto a tensão convertida para valores
digitais varia em relação a alterações na tensão analógica de entrada. Desta forma, quanto mais próximo de uma reta, maior a linearidade do conversor
AD. Adicionalmente, quanto mais próximo o coeficiente de linearidade (R2) for de 1,00, maior a linearidade. Nota-se pelo gráfico que o conversor AD
varia linearmente com as alterações na tensão de
entrada, com R2 igual a 1,00 e desvio padrão 0,0053.
Tensão Convertida pelo AD (V)

Realizou-se cinco segundos de captura na qual a
tensão da fonte foi variada linearmente de 0V a
3,3V, a um passo de 0,1V, tanto em escala crescente
quanto decrescente. Como a captura é realizada a
uma frequência de amostragem de 5,6kHz, a amostragem tem um período de aproximadamente 178s.
Portanto, cada passo de tensão obteve diversas capturas, permitindo o cálculo da média da tensão capturada de acordo com a quantidade de pontos amostrados (Figura 6). Os resultados e análises mostrados
para os testes de ganho, filtragem e linearidade do
conversor AD foram feitos com o software de estatística GraphPad Prism 5.
Para o levantamento do ruído intrínseco ao sistema
de captura, aterraram-se as entradas do préamplificador e realizaram-se duas capturas completas, com o PC desconectado da rede_elétrica, mantendo-se ligado através da bateria interna uma com
ganho mínimo inicial do sistema (análise 1) outra
após ajuste dos ganhos no segundo estágio de amplificação de cada canal (análises 2 e 3) a análise 1
mostra o ruído com ganho mínimo inicial do sistema a análise 2 mostra o ruído após ajuste dos ganhos de cada canal, considerando-se o efeito de ganho a análise 3 mostra o ruído após ajuste dos ganhos de cada canal, retirando-se efeito de ganho
(Tabela 1). Os sinais passaram por um filtro passaalta digital de quinta ordem projetado no software
MATLAB com frequência de corte em 10Hz, com
intuito de retirar resquícios de níveis DC provenientes do grampeador de tensão que não foram retirados
pelo software de captura.
O último teste foi a captura de sinais sEMG. O procedimento do teste envolve limpeza da pele com
álcool, leve abrasão com material áspero para remoção da camada superficial da pele, aplicação de um
gel condutor para facilitar a coleta do sinal e posicionamento e fixação dos eletrodos de superfície no
local com utilização de fita adesiva. Os eletrodos
foram fixados no antebraço, próximo ao músculo
flexor dos dedos. Foram realizadas dez capturas em
um sujeito saudável, sem histórico de desordem neuromuscular, 27 anos, sexo masculino, realizou três
contrações voluntárias, iniciando a contração após
um segundo do início da captura dos sinais, sustentando-a até a totalizar 5 segundos de captura. A Figura 7 mostra uma dessas capturas. Os outros resultados não são mostrados neste artigo.

Linearidade do Conversor AD
4

R2  1,000,0053

3
2

Variação crescente
1

Variação decrescente

0
1

2

3

4

-1

Tensão de Entrada (V)

Figura 6. Linearidade do conversor AD para variações crescentes e
decrescentes da tensão de entrada.

A Tabela 1 mostra os valores de ruído do sistema
para cada canal. A média do ruído entre todos os
canais para a análise 1 foi de 93,7VRMS, com desvio
padrão de 18,0VRMS. A média do ruído entre todos os canais para a análise 2 foi de 105,6VRMS,
com desvio padrão de 23,7VRMS. A média do ruí495

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

do entre todos os canais para a análise 3 foi de
2,1VRMS, com desvio padrão de 0,3VRMS.
Tabela 1. Ruído do Sistema de Captura. A análise 1 mostra o ruído
do sistema considerando ganho mínimo inicial a análise 2 mostra o
ruído do sistema após ajuste dos ganhos de cada canal com influência do ganho a análise 3 mostra o ruído do sistema após ajuste dos
ganhos de cada canal, referente  entrada.

Ruído do Sistema de Captura (VRMS)
Canal

Análise
A

B

C

D

E

F

G

1

121,4

80,1

81,4

113,1

96,2

72,4

91,5

2

132,4

100,6

89,9

132,5

123,0

85,5

74,7

3

2,6

1,5

1,7

2,3

2,19

1,9

1,6

A Figura 7 mostra os resultados de uma das três
capturas de sinais sEMG utilizando o sistema de
captura proposto nesse trabalho. O sujeito iniciou
uma contração voluntária após aproximadamente
1,5s do início da captura. A Figura 7a mostra os 5s
de captura no domínio_do_tempo, a Figura 7b mostra
as componentes de frequência dos 5s de captura e a
Figura 7c mostra 500ms da captura em detalhe, entre 3s e 3,5s, a fim de facilitar a análise de algumas
componentes do sinal. A Figura 7a mostra em detalhe a região que foi evidenciada na Figura 7c.

Amplitude
Amplitude
(V) (V) (V)
Amplitude

Y(f)Y(f) Y(f)

Amplitude
Amplitude
(V) (V) (V)
Amplitude

5
5

5
0

x 10
x 10

-4

Domínio do Tempo

-4

Domínio do Tempo

-4

Domínio do Tempo

x 10

0

0
-5
0
-5
0
-5 x 10-6
6 0 -6
x 10
6
-6
4 x 10
6
4
2
4
2
0
20
0
0
-4
0 x 10
20 -4
x 10
2
-4
1
x 10
2
1
0

1
1

1

2

3
Tempo (s)

2
3
a) Freqência
Domínio
da
2 Tempo (s) 3
Domínio
da Freqência
Tempo
(s)

4

5

4

5

4

5

800

1000

Domínio da Freqência

200
200

200

400
600
Frequencia (Hz)
400
600
Domínio
do Tempo
Frequencia
(Hz)
400
600
b)do Tempo
Domínio
Frequencia
(Hz)

800

1000

800

1000

3.4

3.5

Domínio do Tempo

01
-1

0
-1
-2
3
-1
-2
3
-2
3

3.1
3.1

3.1

3.2
3.3
Tempo (s)
3.2
3.3
Tempo (s)
3.2
3.3

3.4

3.5

3.4

3.5

Tempo (s)

c)
Figura 7. Resultados de uma das capturas de sinal sEMG utilizando
sistema proposto. a) 5s de captura. A área demarcada mostra os
500ms em análise. b) Componentes de frequência dos 5s de captura.
c) Detalhe de 500ms do sinal capturado.

ISBN 978-85-8001-069-5

4 Discussão
Os sistemas de capturas encontrados na literatura são sistemas dedicados, projetados exclusivamente para captura de sinais sEMG (Nakamura et al,
2004 García et al, 2005). Esses sistemas são, geralmente, complexos, com ambos custo e tempo de
desenvolvimento elevados. O sistema proposto foi
desenvolvido em um sistema_embarcado TWRS08MM128 de baixo_custo, com vários módulos
periféricos integrados, que podem ser configurados
via software, o que diminuiu consideravelmente o
tempo de desenvolvimento do protótipo. Adicionalmente, periféricos como o SPI suportaram o desenvolvimento do segundo estágio de amplificação, que
permite que o protótipo seja utilizado com sucesso
em diferentes sujeitos com diferentes níveis de sinais
sEMG, e que também contribui para a diminuição
do ruído intrínseco do sistema (Tabela 1). Contudo,
sistemas dedicados tendem a ter níveis de ruído intrínseco ainda menores, se adequando mais para
captura de sinais sEMG. Adicionalmente, o módulo
TWR-S08MM128 possui oito canais de conversão
AD, o que limita o número de canais do sistema de
captura. Sistemas dedicados têm maior flexibilidade
durante o desenvolvimento, e um número mais elevado de canais pode ser imposto, visando a utilização de técnicas de BSS para decompor sinais sEMG.
O INA129, utilizado no primeiro estágio de amplificação, é um amplificador de instrumentação. Logo,
possui entrada diferencial, que amplifica a diferença
dos potenciais de entrada, porém atenua sinais semelhantes, e.g., 60Hz da rede_elétrica. O alto CMRR é
um bom indicativo da capacidade do amplificador
em atenuar sinais semelhantes presentes nas entradas diferenciais, enquanto a alta impedância de entrada em modo comum permite um bom isolamento
com o sistema medido.
Apesar do TWR-S08MM128 possuir um processo de
calibração do conversor AD, linearidade do conversor AD (Figura 6) mostra que esse processo pode
ser opcional.
Os ruídos mostrados na Tabela 1 indicam que o sistema configurado apenas com ganho inicial (análise
1) não é ideal para captura de sinais sEMG (De Luca, 2006). Ao ajustar o ganho da segunda etapa de
amplificação e considerando o efeito do ganho, a
análise 2 permite uma comparação direta com a análise 1. Os resultados mostram que o ruído é constante e intrínseco ao sistema, pois o ruído na saída não
é alterado significativamente ao ajustar o ganho da
segunda etapa de amplificação. Ao retirar o efeito de
ganho e referir o ruído  entrada do sistema (análise
3), o sistema adéqua s condições para captura de
sinais sEMG, comprovando a importância da segunda etapa de amplificação. Os dois principais geradores de ruído são, muito provavelmente, o TWRS08MM128 e o PC. Apesar de terem um papel fundamental na captura e processamento dos dados, os

496

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

dois componentes possuem uma infinidade de osciladores e outras fontes de ruído que podem facilmente ser propagadas para o restante do circuito, aumentando significativamente o nível de ruído do sistema
como um todo.
É possível notar na Figura 7a que a contração
foi iniciada após 1,5 segundo do início da captura.
Pode-se notar ainda o silêncio muscular durante 1,5s
após o início da captura. Após esse período, é possível notar o aumento da atividade elétrica sincronizada com o início da contração voluntária realizada
pelo sujeito. Logo, pode-se inferir que o sinal capturado está alinhado  contração_muscular, ou seja,
existe silêncio muscular durante o primeiro segundo
e meio de captura e atividade elétrica a partir desse
momento até o fim da captura, suportando a hipótese
que os sinais visualizados são referentes  atividade
mioelétrica proveniente dos músculos durante a contração_muscular. A Figura 7b mostra as componentes de frequência dos cinco segundos de captura, e
suporta a hipótese que o sinal capturado se aproxima
de um sinal sEMG saudável, pois as principais componentes de frequência se encontram entre 10Hz e
500Hz. A Figura 7c permite a visualização do sinal
capturado em maior detalhe, capturado entre 3 segundos e 3,5 segundos, permitindo a análise de algumas componentes que se assemelham a MUAPs
encontrados na literatura (Basmajian e De Luca,
1985 García et al, 2005 De Luca, 2006).
5 Conclusão
É possível concluir a partir desse trabalho que o
TWR-S08MM128 demostrou-se como excelente
ferramenta integrada compondo-se como parte de
um sistema para captura de sinais sEMG a ser integrado futuramente a um sistema para decomposição
de sinais sEMG em suas constituintes MUAPs utilizando ICA. Apesar de este trabalho ter utilizado
somente os módulos do conversor AD, SPI e SCI do
TWR-S08MM128, essas características permitiram
maior autonomia e flexibilidade durante o desenvolvimento do projeto e durante os testes. Os resultados
mostraram que o sistema está dentro ou muito próximo dos requisitos necessários para captura de sinais sEMG. Adicionalmente, os resultados de captura de sinais sEMG suportam a hipótese que o sistema pode ser utilizado com confiança para captura de
sinais sEMG.
Agradecimentos
Os autores expressam sua gratidão  CAPES e ao
CNPq pelo apoio financeiro,  Freescale pela doação do módulo TWR-S08MM128 e aos funcionários
do CEB e DEB da Unicamp pelo apoio técnico durante o desenvolvimento desse trabalho.

ISBN 978-85-8001-069-5

Referências Bibliográficas
Basmajian, J.V. and De Luca, C.J. (1985). Muscles
Alive. 5th Edition, Wiliams  Wilkins.
De Luca, C. (2006). Electromyography, in
Encyclopedia of Medical Devices and
Instrumentation, 2nd Edition, Volume 3, Editor
John G. Webster, John WileySons, pp.98-108.
Farina, D. Févotte, C. Doncarli, D. and Merletti, R.
(2004).
Blind
Separation
of
Linear
Instantaneous Mixtures of Nonstationary
Surface Myoelectric Signals. IEEE Transactions
on Biomedical Engineering, Vol. 51, no. 9,
September 2004, pp. 1555-1567.
Freescale
(2010).
Disponível
em
httpcache.freescale.comfiles32bitdocquick
refguideS08MM128QSG.pdf, acessado em 23
de fevereiro de 2012.
García, G. A. Okuno, R. and Akazawa, K. (2005).
A Decomposition Algorithm for Surface
Electrode-Array
Electromyogram.
IEEE
Engineering in Medicine and Biology
Magazine, JulyAug 2005, pp.63-72.
Graupe, D. and Kleine, W. K. (1975). Functional
Separation of EMG Signals via ARMA
Identification Methods for Prosthesis Control
Purposes. IEEE Transactions on Systems, Man,
and Cybernetics, Vol.SMC5, no.2, pp.252259
Hyvrinen, A. Karhunen, J. and Oja, E. (2001).
Independent Components Analysis. New York,
N.Y. J. Wiley.
Karlsson, J. S. Roeleveld, K. Grnlund, C.
Holtermann, A. and stlund, N. (2008). Signal
processing of the surface electromyogram to
gain insight into neuromuscular physiology.
Philosophical Transactions of the Royal Society
A, Mathematical, Physical  Engineering
Sciences, Vol. 367, pp. 337-356.
Loeb, G. E. and Ghez, C. (2000). The Motor Unit
and Muscle Action, in Principles of Neural
Science, 4th Edition, Editors Eric R. Kandel,
James H. Schwartz, Thomas M. Jessell, The
McGraw-Hill Companies, pp.675- 696.
Nakamura, H. Yozhida, M. Kotani, M. Akazawa,
K. and Moritani, T. (2004). The Application of
Independent Component Analysis to the Multichannel Surface Electromyographic Signals for
Separation of Motor Unit Action Potential
Trains Part IMesuring Techniques. J
Electromyogr Kinesiol 14, pp. 423432.
Quevedo, A. A. F. (1993). Desenvolvimento de um
Sistema de Análise Digital de Sinais EMG.
Dissertação de Mestrado, FEEC, Unicamp,
Campinas, SP, Brasil.
Wood, S. M. Jarratt, J. A. Barker, A. T. and
Brown, B. H. (2001). Surface Electromyography
Using Electrode Arrays a Study of Motor
Neuron Disease. John Wiley  Sons, Inc.
Muscle Nerve, 24, pp. 223230

497