Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

IDENTIFICACAO NAO-LINEAR DE UM BIORREATOR ATRAVES DA
MINIMIZACAO DO ERRO DE PREDICAO
Luciola Campestrini, Diego Eckhard, Odorico Konrad, Alexandre S. Bazanella


Departamento de Engenharia Eletrica
Universidade Federal do Rio Grande do Sul
Porto Alegre, RS, Brasil


Centro de Ciencias Exatas e Tecnologicas
Centro Universitario UNIVATES
Lajeado, RS, Brasil

Emails luciola@ece.ufrgs.br, diegoeck@ece.ufrgs.br, okonrad@univates.br,
bazanela@ece.ufrgs.br
Abstract This work presents a non-linear identification of a bioreactor through the minimization of the
prediction error, where the output data are the measurements of the methane gas generated by the process,
during 37 days. Since the chosen model is non-linear, an iterative method is used to obtain the model parameters.
This method depends on the cost functions gradient, whose calculus is implemented recursively, since it does
not have a closed form. The algorithm used in the minimization of the cost function is a combination of two
methods the gradient method and the Newton-Raphson method. The model obtained is validated with output
data from the process and it reproduces the behavior of the bioreactor with good precision.
Non-linear identification, Prediction Error, Anaerobic Digestion, Bioreactors.

Keywords

Resumo Este trabalho apresenta a identificacao_nao-linear de um biorreator atraves da minimizacao do erro
de predicao, onde os dados de sada utilizados sao as medidas de gas metano gerado pelo processo, durante 37
dias. Como o modelo escolhido e nao-linear, um metodo iterativo e utilizado para obtencao dos parametros do
modelo. Este metodo depende do gradiente da funcao custo minimizada, cujo calculo e implementado de forma
recursiva, ja que o mesmo nao tem uma forma fechada. O algoritmo utilizado na minimizacao da funcao custo e
uma combinacao de dois metodos o metodo do gradiente e o metodo de Newton-Raphson. O modelo obtido e
validado com dados provenientes do processo e reproduz com boa precisao o comportamento do biorreator.
Palavras-chave

.

Introducao

O forte crescimento industrial e agrcola mundial,
e em especial dos pases em desenvolvimento, tem
causado graves danos ao meio_ambiente atraves
do aumento da poluicao e geracao de lixo. Em
todo o mundo, orgaos ambientais tem criado regras cada vez mais rgidas, que limitam a quantidade de toxinas e materia organica despejadas no
meio_ambiente pelos efluentes industriais e municipais (Antonelli et al., 2003). Dessa forma, e
crescente a demanda por um desenvolvimento sustentavel, onde alia-se desenvolvimento tecnologico
e economico com equilbrio ecologico, com o objetivo de reduzir os impactos ambientais decorrentes
de atividades produtivas. A biotecnologia tem desempenhado um papel muito importante na minimizacao da poluicao e geracao de lixo atraves da
implantacao de plantas de tratamento de lixo e
efluentes, ou seja, de biorreatores.
Um biorreator e um equipamento (usualmente
um tanque) no qual se da o crescimento de biomassa de um ou mais microorganismos e a formacao de algum produto. Basicamente, o biorreator contem inocuo, que e um meio com alta
concentracao do microorganismo, e substrato, que
e um meio fermentativo que contem os ingredientes necessarios para o crescimento do microor-

ISBN 978-85-8001-069-5

ganismo. Os biorreatores podem ser aerobicos
ou anaerobicos (com e sem presenca de ar, respectivamente). Os biorreatores anaerobicos, nos
quais os microorganismos realizam digestao_anaerobica, apresentam diversas vantagens (Antonelli
et al., 2003 Bernard et al., 2001) tem grande
capacidade de degradar substratos concentrados
(resduos de plantas, dejetos animais, efluentes
da industria alimentcia, entre outros) produzem
pouco lodo residual, e, em alguns casos, podem
produzir energia atraves da combustao do gas metano.
A obtencao de modelos_dinamicos para a digestao_anaerobica tem grande importancia na concepcao, operacao e otimizacao de biorretarores
e por isso vem sendo amplamente estudada durante as ultimas decadas (Bernard et al., 2001).
Como consequencia, existem na literatura, diferentes modelos que descrevem a digestao_anaerobica, como por exemplo um modelo simples, que
descreve o processo com apenas uma populacao de
bacteria (Andrews, 1974), assim como um modelo
complexo, denotado por ADM1, elaborado por um
grupo de pesquisadores (IWA Anaerobic Digestion
Modelling Task Group), composto por 32 estados
(Batstone et al., 2002). Este modelo complexo representa tanto as reacoes bioqumicas quanto as
reacoes fsico-qumicas envolvidas no processo de

3066

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

digestao_anaerobica.
Porem, apesar de, em tese, um modelo complexo representar o sistema de forma mais acurada, sua identificacao e um processo bastante difcil, devido ao alto numero de parametros a serem
identificados. Assim, verifica-se na literatura uma
boa aceitacao por representar o processo de digestao_anaerobica por um modelo de quatro (ou,
por vezes, seis) estados, os quais representam as
reacoes de acidogenese, metanogenese (e balanceamento de ons) (Bernard et al., 2001 Antonelli
et al., 2003 Donoso-Bravo and et. all, 2011b).
Neste artigo e apresentada a identificacao dos parametros de um modelo de quatro estados usando
dados advindos de um biorreator.
A identificacao desses parametros pode ser realizada de diferentes formas. E comum encontrar na literatura resultados obtidos com o sistema operando em diferentes pontos de operacao,
onde os dados em regime_permanente sao utilizados (Bernard et al., 2001) para a identificacao de
diferentes parametros. Esta abordagem apresenta
pelo menos uma limitacao importante como somente poucos dados sao utilizados, sendo desprezada toda a informacao sobre o comportamento
do sistema contida nos dados transitorios, a incerteza resultante nos valores dos parametros tende
a ser grande. Alem disso, a obtencao pratica de
dados em varias condicoes de regime_permanente
pode ser problematica, como e o caso do biorreator identificado neste artigo. Outros trabalhos
reescrevem o problema de forma a poder utilizar metodos ja consagrados na literatura de identificacao_de_sistemas, como linearizacao do modelo e aplicacao do metodo dos mnimos_quadrados (Donoso-Bravo and et. all, 2011a). Modelos tipo caixa-preta, com estruturas convencionais
como NARX, NARMAX ou funcoes de base radial tambem tem sido utilizados (Aguirre, 2000).
Em (Donoso-Bravo and et. all, 2011b) e apresentada uma tabela que lista os diferentes metodos
utilizados e quantos parametros sao identificados
em cada problema. Dentre todos os metodos listados naquela referencia, nao ha relato de aplicacao
de minimizacao do erro_de_predicao, que e a ferramenta padrao em identificacao_parametrica de
sistemas (Ljung, 1999).
Neste trabalho e apresentada a identificacao
de um biorreator, cujos dados (medicoes de metano) foram obtidos em 37 dias de ensaios, atraves
da aplicacao do metodo de minimizacao do erro de
predicao. Esta identificacao e do tipo caixa-cinza,
onde o modelo parametrico utilizado na identificacao reflete os parametros fsicos do processo, conhecimento este almejado pela comunidade cientfica da area. Como o sistema e nao-linear com
uma estrutura nao convencional, o preditor tambem o sera e portanto nao e possvel aplicar diretamente um metodo usual de identificacao de
sistemas. E entao proposto um metodo de otimi-

ISBN 978-85-8001-069-5

zacao especificamente adaptado a este problema,
que utiliza primeiramente o metodo do gradiente
e posteriormente o metodo de Newton-Raphson
para a otimizacao de um criterio de erro_de_predicao para a identificacao. A grande diferenca deste
metodo para os usuais e que o calculo do gradiente e dado de forma recursiva, pois o mesmo nao
possui uma forma fechada. Vale ressaltar que esta
metodologia pode ser aplicada a identificacao de
outros processos nao-lineares. Para isto, e necessario que se calcule o gradiente da funcao custo do
problema em questao.
O artigo e organizado da seguinte forma. Na
Secao 2 e descrito o processo que sera identificado,
bem como o equipamento utilizado para medicao
de biogas. Na Secao 3 e apresentada a formulacao do problema, ou seja o modelo_matematico
que descreve o sistema, bem como seus parametros
fsico-qumicos. Na Secao 4 o modelo e reparametrizado de forma a podermos aplicar o metodo de
minimizacao do erro_de_predicao e os algoritmos
utilizados sao detalhados. Os resultados obtidos
sao apresentados na Secao 5 e por fim sao apresentadas as conclusoes obtidas.
2

Descricao do processo

O equipamento de quantificacao do biogas, utilizado para a identificacao dos parametros, esta localizado no Laboratorio de Biorreatores, no Centro Universitario UNIVATES. Este equipamento
e composto por biorreatores de vidro com capacidade de 1 litro cada, apresentados na Fig. 1,
alem de coletores de biogas constitudos cada um
por um tubo de vidro em forma de U , um sensor
otico, uma esfera de isopor e um circuito_eletronico
que registra a passagem do biogas pelo sistema e
calcula o volume gerado, apresentados na Fig. 2.
O princpio de funcionamento do dispositivo e o
deslocamento de fluidos, sendo a quantificacao do
biogas realizada quando este, a medida que enche o tubo em forma de U , desloca o fluido nele
contido (agua) e eleva o nvel de fluido no lado
oposto, que e detectado por um sensor otico, que
envia essa informacao a um circuito_eletronico. O
volume de biogas gerado e determinado por meio
da equacao combinada dos gases ideais, que descreve que a relacao entre a temperatura, a pressao e o volume de um gas e constante (Konrad
et al., 2010).
Os experimentos foram conduzidos em triplicata em uma incubadora bacteriologica adaptada
para este fim, em que foi possvel manter uma
temperatura constante de 35 o C dentro dos reatores, que e a temperatura indicada para o melhor
funcionamento do biorreator em questao (Bernard
et al., 2001 Batstone et al., 2009 Garca-Ochoa
et al., 1999). Note que, conforme apresentado na
Fig. 1, a incubadora contem varios biorreatores,
mas foram utilizados dados apenas de tres des-

3067

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

3

Formulacao do problema

Conforme explicitado no incio deste trabalho, a
literatura apresenta diferentes modelos para o processo de digestao_anaerobica, desde modelos simples ate um modelo bastante complexo, conhecido
por ADM1. Este modelo complexo representa
tanto as reacoes bioqumicas quanto as reacoes
fsico-qumicas envolvidas no processo de digestao
anaerobica, e e um modelo indicado para simulacao, pois atraves deste temos informacao sobre
muitas variaveis internas do processo.
Figura 1 Biorreatores.

Figura 2 Coletores usados para medicao do biogas.
tes biorreatores. Completou-se cada reator com
420 ml de substrato e 180 ml de inocuo, ja misturados e homogeneizados, obtidos de um biodigestor de grande escala. O substrato e formado
por lodo proveniente da Estacao de Tratamento de
Efluentes da Cooperativa dos Citricultores Ecologicos do Vale do Ca (Ecocitrus), no Rio Grande
do Sul. A qualificacao do biogas produzido, medida em porcentagem de metano, foi realizada a
partir da injecao do biogas em um sensor especfico para a medicao da concentracao de gas metano, denominado Advanced Gasmitter (Konrad
et al., 2009 Konrad et al., 2010). Essa medida
foi realizada 1 vez ao dia, durante 37 dias, o que
gerou um vetor de 37 amostras a ser utilizado na
identificacao.
Segundo (Batstone et al., 2009), modelos obtidos de ensaios em processos batch, usando substrato e inocuo provenientes de biorreatores de
grande escala, podem ser usados para analise de
viabilidade de projeto nos biorreatores de grande
escala, mas nao devem ser usados como parametros de um modelo_dinamico destes reatores para
simulacao. Por este motivo, o principal objetivo
desta identificacao e validar o modelo do processo
batch para, posteriormente, analisar a viabilidade
de um possvel projeto_de_controle da producao
de biogas atraves da insercao de glicerina (Konrad
et al., 2010 Robra et al., 2010).

ISBN 978-85-8001-069-5

Modelos de grande complexidade nao sao adequados para serem utilizados no projeto_de_controle dos mesmos (G. Bastin, 1990), uma vez
que resultam em controladores complexos. Alem
disso, devido ao grande numero de parametros a
serem identificados em um tal modelo, sua identificacao pode ser tao problematica e imprecisa
que a complexidade nao implique em uma descricao mais acurada do processo. Isso motiva o
uso de modelos de complexidade moderada, mas
ainda suficientemente detalhados para descrever
de uma forma suficientemente acurada a dinamica
do processo, e que sirvam como base para um projeto_de_controle, onde o controlador obtido seja o
mais simples possvel. Um modelo com estas caratersticas, consagrado na literatura, e o modelo
baseado no balanceamento de massas, composto
por quatro (ou seis) estados e uma sada (Bernard
et al., 2001), descrito por

x1 (t) 
x2 (t) 
S1 (t) 
S2 (t) 

1 (S1 (t))  Dx1 (t)

2 (S2 (t))  Dx2 (t)
D(S1in (t)  S1 (t))  k1 1 (S1 (t))x1 (t)

D(S2in (t)  S2 (t)) + k2 1 (S1 (t))x1 (t)
k3 2 (S2 (t))x2 (t)

onde x1 (t) (mgl) e a concentracao de bacterias acidogenicas, x2 (t) (mgl) e a concentracao de bacterias metanogenicas, S1 (t) (mgl) e
a concentracao da demanda qumica de oxigenio (COD), S2 (t) (mmoll) e a concentracao de
entrada de acidos graxos volateis (VFA), 0 <
  1 e um parametro proporcional determinado experimentalmente, D (dia1 ) e a taxa
de diluicao, k1 (mgCODmg x1 ) e o coeficiente de producao para a degradacao de COD,
k2 (mmolV F Amg x1 ) e o coeficiente de producao para a producao de acidos graxos volateis,
k3 (mmolV F Amg x2 ) e o coeficiente de producao para o consumo de acidos graxos volateis.
O comportamento nao-linear do processo e
dado atraves de duas taxas de crescimento especficas para bacterias, 1 (S1 (t)) e 2 (S2 (t)), expres-

3068

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

sadas pelas leis de Monod1
1 (S1 (t))



2 (S2 (t))



S1 (t)
KS1 + S1 (t)
S2 (t)
m2
KS2 + S2 (t)

m1

(1)
(2)

onde m1 (dia1 ) e a taxa de crescimento maxima
da biomassa acidogenica, m2 (dia1 ) e a taxa de
crescimento maxima da biomassa metanogenica,
KS1 (COD mgl) e o parametro de saturacao associado a S1 (t) e KS2 (mmol V F Al) e o parametro de saturacao associado a S2 (t).
A medida disponvel nesse modelo e a sada
da taxa de fluxo do gas,
Qgas (t)  qC (t) + qM (t)

(3)

dada pela soma da taxa de fluxo de dioxido de carbono qC (t) e pela taxa de fluxo de metano qM (t)
produzidos no reator biologico. Particularmente,
a taxa de fluxo do gas metano e dada por
qM (t)  k6 2 (S2 (t))x2 (t).

(4)

Como o processo estudado e um reator do tipo
batch, o substrato e o inocuo sao inseridos no sistema apenas no incio do processo, sendo considerados condicoes iniciais dos estados relativos aos
substratos e as concentracoes de bacteria, respectivamente. Portanto S1in (t)  S2in (t)  0 e D  0,
o que reduz o modelo a ser identificado para

x1 (t)  1 (S1 (t))x1 (t)



x (t)   (S (t))x (t)
2
2
2
2

S1 (t)  k1 1 (S1 (t))x1 (t)



S2 (t)  k2 1 (S1 (t))x1 (t)  k3 2 (S2 (t))x2 (t)
(5)
Uma vez que estamos trabalhando com dados discretos, provenientes de medidas da concentracao
de gas obtidas uma vez por dia, necessitamos discretizar este sistema. Usando o metodo de Euler,
, onde T e o perodo de
isto e x  x(k+1)x(k)
T
amostragem, temos


x1 (k + 1)  x1 (k) + T 1 (S1 (k))x1 (k)




x2 (k + 1)  x2 (k) + T 2 (S2 (k))x2 (k)

S  S1 (k + 1)  S1 (k)  T k1 1 (S1 (k))x1 (k)



S2 (k + 1)  S2 (k) + T k2 1 (S1 (k))x1 (k)




T k3 2 (S2 (k))x2 (k)
(6)
e a taxa de fluxo do gas metano e dada por
qM (k)  k6 2 (S2 (k))x2 (k).

(7)

A vantagem em se utilizar o metodo de Euler e
que os parametros identificados atraves do modelo

discretizado (6) sao os mesmo do modelo contnuo
(5).
Utilizando apenas os dados da sada qM (k) e
as condicoes iniciais dos estados (a entrada e nula),
queremos identificar os parametros do modelo (6),
com o objetivo de primeiramente, simular o comportamento do processo para, no futuro, projetar
um controle baseado na insercao de glicerina de
forma a maximizar a producao de gas metano.
4

Identificacao do sistema

Uma vez que temos dados de entrada (condicoes
iniciais dos estados) e dados de sada (medida do
gas metano) do processo, podemos aplicar a teoria
de identificacao_de_sistemas (Ljung, 1999), atraves da aplicacao do metodo do erro_de_predicao
(PEM), para identificar os parametros desconhecidos do modelo (6). Para a aplicacao deste metodo, escolhemos um modelo parametrizado por 
para o sistema,


x1 (k + 1, )  x1 (k, ) + T 1 v1 (k, )





x2 (k + 1, )  x2 (k, ) + T 2 v2 (k, )
M  S1 (k + 1, )  S1 (k, )  T 3 v1 (k, )


S2 (k + 1, )  S2 (k, ) + T 4 v1 (k, )




T 5 v2 (k, )
(8)
onde

(

v1 (k, ) 
v2 (k, ) 

e o preditor da sada do sistema e dado por
qM (k, )  6 v2 (k, ).

ISBN 978-85-8001-069-5

(9)

A relacao do vetor de parametros  para os parametros reais do processo e dada por


m1
 m2 


 
 k1 m1 
1



  k2 m1 

   ...   
(10)
 k3 m2  .


8
 k6 m2 


 KS1 
KS2
A estimativa do vetor de parametros N e
dada por
N  arg min J()


onde
J()

,

N
1 X 2
 (k, )
N
k1

1 Tambem

e comum encontrar na literatura que
2 (S2 (t)) seja expressa pela lei de Haldane, onde existe
um parametro extra que representa a inibicao de VFA.

S1 (k,)x1 (k,)
S1 (k,)+7
S2 (k,)
S2 (k,)+8



N
1 X
(qM (k)  qM (k, ))2 . (11)
N
k1

3069

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

Como o problema de otimizacao e nao-linear,
necessita-se usar um algoritmo iterativo para calcular o vetor de parametros  (Bazanella et al.,
2012). Solucoes padrao de identificacao_de_sistemas nao sao adequadas para solucionar este problema, uma vez que elas existem para estimar
modelos lineares (Ljung, 1999), como por exemplo, atraves do pacote ident do Matlab, ou modelos nao-lineares, com estruturas NARX, NARMAX atraves do uso de estimadores quadraticos
ou redes_neurais, por exemplo (Aguirre, 2000). Esses metodos sao baseados na identificacao caixapreta, e por isso nao sao adequados para identificar os parametros do modelo de um biorreator
como o apresentado em (8), cuja identificacao deve
ser do tipo caixa-cinza. Alem disso, se o desejo
e estimar o modelo (8), as solucoes mais encontradas na literatura sao atraves do uso de algoritmos que estimam o gradiente da funcao custo
numericamente, sem a obtencao de uma expressao analtica para o mesmo (Donoso-Bravo and
et. all, 2011b), causando um custo_computacional
alto.
Assim, como algoritmos classicos de otimizacao sao baseados no gradiente da funcao custo, a
estimativa de uma funcao analtica para o mesmo
permite aprimorar e acelerar o processo de otimizacao. Assim, o gradiente da funcao custo pode
ser estimado por
J() 


N
d
1 X
2(k, ) (k, )
N
d
k1

N
d
1 X
2(k, ) qM (k, )
N
d
k1



N
1 X
d
d
2(k, )(6 v2 (k, ) + v2 (k, ) 6 ).
N
d
d
k1

O termo
de

d
d v2 (k, )

pode ser estimado a partir



S2 (k)x2 (k)
d
d
d
v2 (k)  
S
(k)
+

2
8
d
(S2 (k) + 8 )2 d
d
S2 (k)
d
d
x2 (k)
S2 (k) +
x2 (k)
+
S2 (k) + 8 d
S2 (k) + 8 d

onde as outras derivadas parciais necessarias sao
obtidas por
d
x1 (k + 1) 
d
d
x2 (k + 1) 
d
d
S1 (k + 1) 
d
d
S2 (k + 1) 
d

Neste trabalho utilizamos dois algoritmos
para resolver o problema de otimizacao. O primeiro algoritmo e uma variacao do algoritmo do
gradiente conjugado, enquanto que o segundo e
uma modificacao do algoritmo Newton-Raphson.
E sabido que a regiao de atracao do algoritmo
do gradiente conjugado e maior que a regiao do
algoritmo Newton-Raphson, mas que em contrapartida o algoritmo de Newton-Raphson possui
uma taxa de convergencia mais alta. A combinacao destes dois algoritmos gerou resultados satisfatorios na resolucao do problema de otimizacao
apresentado neste trabalho.
O algoritmo do gradiente conjugado (Polak,
1973) pode ser descrito por
(n + 1)  (n)  (n)D(n, )
onde
D(n, )  J() + D(n  1, )
em que D() e a direcao da atualizacao dos parametros, (n) e um parametro que determina o
tamanho_do_passo de iteracao e  e um fator que
determina a taxa de variacao da direcao do algoritmo. Quando   0 este algoritmo torna-se o
algoritmo do gradiente, cuja direcao faz com que
a taxa de convergencia do algoritmo seja muito
baixa quando a funcao custo e bastante nao-linear.
Isto se da principalmente porque o algoritmo evolui em uma trajetoria de zigue-zague. Quanto
maior o fator , mais lenta e a variacao da direcao
do algoritmo, o que minimiza o efeito zigue-zague.
Neste trabalho utilizamos a seguinte variacao do
algoritmo
4

(n) 
kD(n, )k

(12)
(13)

onde o fator  e incrementado em 1 de seu valor,
a cada iteracao em que o valor da funcao custo e
reduzido (J(n + 1) < J(n)) e reduzido em 1 nos
casos em que o custo e ampliado (J(n+1)  J(n)).
Uma pequena varicao foi implementada no algoritmo caso o custo aumente em uma iteracao, fazse (n + 1)  (n), para que o algoritmo retorne
ao ponto conhecido com menor custo.
Quando a convergencia deste algoritmo se
torna muito lenta, passamos a utilizar uma variacao do algoritmo Newton-Raphson, tambem chamada de algoritmo quasi-Newton, descrita por

d
d
d
x1 (k) + T v1 (k) 1 + T 1 v1 (k)
d
d
d
d
d
d
x2 (k) + T v2 (k) 2 + T 2 v2 (k)
d
d
d
d
d
d
S1 (k)  T v1 (k) 3  T 3 v1 (k)
d
d
d
d
d
d
S2 (k) + T v1 (k) 4 + T 4 v1 (k)
d
d
d
(n + 1)  (n)  (R((n)))1 J((n))
d
d
 T v2 (k) 5  T 5 v2 (k)
d
onde

 d
d
d
S1 (k)x1 (k)
d
v1 (k)  
S
(k)
+

1
7
N
d
(S1 (k) + 7 )2 d
d
X
d
d
R

( qM (k, ))( qM (k, ))T .
x1 (k)
S1 (k)
d
d
d
d
+
S1 (k) +
x1 (k).
k1
S1 (k) + 7 d
S1 (k) + 7 d

ISBN 978-85-8001-069-5

3070

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

Resultados experimentais

Baseado nesta estimativa, os parametros fsicos do
sistema sao calculados a partir de (10). A comparacao dos dados reais da medida de CH4 com a
sada predita pelo modelo parametrizado por  e
apresentada na Fig. 3, cujo custo (11) foi minimizado para J  819 ml2 . Uma 
medida mais significativa deste custo e dada por J  28, 62 ml, que
significa que, na media, o preditor erra 28, 62 ml
em cada instante de tempo, comparado com a
sada do experimento. Veja na Fig 3 que a sada do
modelo obtido e bastante parecida com a sada experimental, o que mostra que o modelo escolhido
e adequado para descrever o processo de digestao
anaerobica. Como a identificacao de oito parametros foi realizada com uma quantidade moderada
de dados (apenas trinta e sete), e natural que a variancia da estimativa obtida seja elevada. Ainda
assim, esta variancia sera muito menor do que a
que seria obtida apenas com medidas em regime
permanente.
A validacao do modelo obtido foi realizada
com os outros dois dados da triplicata. Assim,
baseado nas condicoes iniciais dos estados do processo, foi usado o modelo para estimar a medida
de metano nestes dois biorreatores, e comparado
com as medidas feitas no decorrer do experimento.
Neste caso, foram obtidos os resultados comparativos das Figs. 4 (custo J  965 ml2 ) e 5 (custo

ISBN 978-85-8001-069-5

Modelo
Experimento

1000

mL de CH

4

800

600

400

200

0
0

5

10

15

20
dia

25

30

35

Figura 3 Medida de CH4 obtida atraves dos dados experimentais do biorreator 1 e da sada do
modelo estimado.
J  924 ml2 ). Note que os custos obtidos foram
levemente superiores ao custo obtido na identificacao, mas que visualmente o modelo e capaz de
estimar adequadamente a sada deste tipo de sistema.

Modelo
Experimento

1000

800

4

Com base na triplicata de dados obtida em 37 dias,
partiu-se para a identificacao do modelo escolhido
para o sistema, ou seja, a identificacao de um vetor
de parametros  para o modelo (8). Destes dados
da triplicata, um vetor de dados foi utilizado no
algoritmo de identificacao, enquanto os outros dois
foram utilizados para validar o modelo obtido.
Assim, foram aplicados os dois algoritmos
apresentados na Secao 4, usando somente a medida de metano qM (k) como dados de sada e
condicoes iniciais para cada estado. Foi utilizado
como condicao inicial x1 (0)  x2 (0)  100 mgl,
S2 (0)  0 e S1 (0)  74 mgl, que era, alem do
metano, a unica medida dada. Alem disso, o perodo de amostragem utilizado foi T  1 dia, visto
que esta e a periodicidade da medida da qualidade
do gas metano qM (t). Apos um milhao de iteracoes do metodo do gradiente modificado, seguidas de cinquenta mil iteracoes usando o segundo
algoritmo, convergiu-se para o seguinte vetor de
parametros


0, 50353
 0, 90919 


 0, 016447 


 0, 010608 

  
 0, 048697  .


 3, 1759 


 112, 5166 
170, 4033

mL de CH

5

600

400

200

0
0

5

10

15

20
dia

25

30

35

Figura 4 Validacao do modelo medida de CH4
obtida atraves dos dados experimentais do biorreator 2 e da sada do modelo estimado.

6

Conclusoes e trabalhos futuros

Este trabalho apresentou a identificacao naolinear dos parametros de um biorreator. A identificacao foi realizada formalmente, atraves da minimizacao do erro_de_predicao. Alem disso, diferente
de varios trabalhos encontrados na literatura, utilizamos todos os dados coletados do processo, e
nao apenas os dados de regime_permanente, o que
gera maior precisao dos parametros identificados.
A fim de identificar os parametros fsicos do
sistema, nao foi realizada uma identificacao caixapreta, atraves de algoritmos existentes foi necessario propor um algoritmo dedicado a este problema, baseado no gradiente da funcao custo, calculado especialmente para o modelo proposto do

3071

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

Modelo
Experimento

1000

mL de CH4

800

Bazanella, A., Campestrini, L. and Eckhard, D.
(2012). Data-Driven Controller Design The
H2 Approach, Springer, New York, USA.
Bernard, O., Hadj-Sadok, Z., Dochain, D., Genovesi, A. and Steyer, J. P. (2001). Dynamical model development and parameter identification for an anaerobic wastewater treatment process, Biotechnology and Bioengineering 75(4) 42438.

600

400

200

0
0

5

10

15

20
dia

25

30

35

Figura 5 Validacao do modelo medida de CH4
obtida atraves dos dados experimentais do biorreator 3 e da sada do modelo estimado.
biorreator. Os resultados obtidos foram adequados, sendo que o modelo identificado concorda
bem com os dados experimentais utilizados na validacao do modelo na maioria das amostras, apresentando uma variacao maior apenas nas medidas
realizadas do dia 19 ao dia 22.
Como trabalhos futuros, pretende-se quantificar formalmente a variancia da estimativa,
comparando-a com outros metodos. Alem disso,
pretende-se utilizar o modelo obtido para o estudo
da insercao de glicerina como controle da producao de metano. Este estudo sera feito primeiramente nos biorreatores batch apresentados na Fig.
1 para posteriormente ser aplicado no biorreator
de grande escala da Ecocitrus.
Referencias
Aguirre, L. (2000). Introducao a Identificacao de
Sistemas, Editora UFMG.
Andrews, J. F. (1974). Dynamic models and control strategies for wastewater treatment processes, Water Research 8(5) 261  289.
Antonelli, R., Harmand, J., Steyer, J.-P. and
Astolfi, A. (2003). Set-point regulation of
an anaerobic digestion process with bounded output feedback, Control Systems Technology, IEEE Transactions on 11(4) 495 
504.
Batstone, D., Keller, J., Angelidaki, I.,
Kalyuzhnyi, S., Pavlostathis, S., Rozzi,
A., Sanders, W., Siegrist, H. and Vavilin, V.
(2002). The iwa anaerobic digestion model
no 1 (adm1), Water Science and Technology
45(10) 6573.

Donoso-Bravo, A. and et. all (2011a). Assessment
of the influence of thermal pre-treatment
time on the macromolecular composition and
anaerobic biodegradability of sewage sludge,
Bioresource Technology 102(2) 660  666.
Donoso-Bravo, A. and et. all (2011b). Model selection, identification and validation in anaerobic digestion A review, Water Research
45(17) 5347  5364.
G. Bastin, D. D. (1990). On-line Estimation and
Adaptive Control of Bioreactors, Elsevier.
Garca-Ochoa, F., Santos, V., Naval, L., Guardiola, E. and Lopez, B. (1999). Kinetic model
for anaerobic digestion of livestock manure,
Enzyme and Microbial Technology 25(12) 55
 60.
Konrad, O., Bastiani, F., Schmitz, M. and Kunzel, G. (2009). Quantificacao da producao de
biogas e determinacao do percentual de metano a partir de dejtos sunos e lodo de estacao de tratamento_de_efluentes (ete), Revista
Destaques Academicos 1 5965.
Konrad, O., Heberle, A. N. A., Casaril, C. E.,
Kaufmann, G. V., Lumi, M., Oglio, M. D.
and Schmitz, M. (2010). Avaliacao da producao de biogas e geracao de metano a partir
de lodo de estacao de tratamento_de_efluentes
e glicerina residual, Revista Destaques Academicos 2 4955.
Ljung, L. (1999). System Identification Theory
for the User, 2 edn, Prentice-Hall, Englewood
Cliffs, NJ.
Polak, E. (1973). An historical survey of computational methods in optimal control, SIAM
review 15(2) 553584.
Robra, S., da Cruz, R. S., de Oliveira, A., Neto,
J. A. A. and Santos, J. (2010). Generation
of biogas using crude glycerin from biodiesel
production as a supplement to cattle slurry,
Biomass and Bioenergy 34(9) 1330  1335.

Batstone, D., Tait, S. and Starrenburg, D. (2009).
Estimation of hydrolysis parameters in fullscale anerobic digesters, Biotechnology and
Bioengineering 102(5) 15131520.

ISBN 978-85-8001-069-5

3072