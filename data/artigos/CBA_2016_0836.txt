XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

ESTRATÉGIAS DE CONTROLE APLICADAS A SISTEMAS FOTOVOLTAICOS COM BATERIAS
CONECTADOS A REDE ELÉTRICA
TÚLIO ALBUQUERQUE DIAS1 MAURÍCIO BELTRÃO DE ROSSITER CORRÊA2 MONTIÊ ALVES VITORINO2 DIEGO A.
ACEVEDO BUENO1 EDISON R. CABRAL DA SILVA2
Laboratório de Eletrônica Indusrial e Acionamento de Máquinas
Programa de Pós-Graduacão em Engenharia Elétrica  PPgEECOPELE  UFCG
2
Departamento de Engenharia Elétrica da Universidade Federal de Campina Grande
Campina Grande, Paraíba, Brasil
E-mails tulio.dias@ee.ufcg.edu.br,mbrcorrea@dee.ufcg.edu.br,
vitorino@dee.ufcg.edu.br,diego.bueno@ee.ufcg.edu.br,edison@dee.ufcg.edu.br
1

Abstract The increasing integration of photovoltaic generation in the electrical system tends to create instability in the distribution system at low voltage due to elevation and power variation into the grid. Thus PV systems combined with storages elements of power become a viable alternative to control the power injected into the grid, very sensitive to temperature and solar irradiation. This article discusses the strategies of control of photovoltaic generation system associated with storages elements of
energy to reduce the instability of the power generated by these generators at high levels. For this are discussed strategies to control photovoltaic generation system associated with the load control and discharge of the battery bank. Simulations with variations of the irradiation profile from actual data are used to validate control strategies as well as experimental results in order to
verify the effectiveness of control strategies.
Keywords Photovoltaic system, energy storages, distributed generation, power control.
Resumo A inserção cada vez maior da geração_fotovoltaica (FV) no sistema elétrico tende a gerar instabilidade no sistema de
distribuição em baixa tensão devido  elevação e variação da potência injetada na rede. Dessa forma os sistemas FVs combinados
com elementos armazenadores_de_energia se tornam uma alternativa viável para controlar a potência injetada na rede_elétrica,
bastante sensível  temperatura e a irradiação_solar. Este artigo propõe uma abordagem sobre as estratégias de controle do sistema de geração FV associado a elementos armazenadores_de_energia para reduzir a instabilidade da potência injetada na rede por
estes geradores. Para isto são discutidas estratégias de controle do sistema de geração FV associadas ao controle_de_carga e descarga do banco_de_baterias. Simulações com variações do perfil de irradiação a partir de dados reais são utilizados para validar as
estratégias de controle bem como resultados experimentais a fim de verificar a eficiência das estratégias de controle.
Palavras-chave .

1 Introdução
A penetração da energia_fotovoltaica (FV) em redes
de distribuição está aumentando rapidamente no
mundo todo passando de 1,3 GW em 2000 para 139
GW ao final de 2013, destacando-se um rápido desenvolvimento do mercado asiático, liderado pela
China (European Photovoltaic Industry Association,
2014). No caso do Brasil, o governo vem incentivando a inserção de sistemas de geração FV. No entanto,
devido  natureza intermitente da geração_fotovoltaica, o sistema opera em uma condição de estresse pela
continua flutuação de potência inserida por estas
fontes_renováveis. Por isto, existe uma grande preocupação por parte do operador nacional e das concessionarias de energia em garantir a confiabilidade e
estabilidade do sistema elétrico (Chagas and Souza,
2015).
Assim, surge como alternativa promissora a utilização de elementos armazenadores_de_energia para
regular a potência injetada na rede, estabilizando o
fluxo_de_potência da geração FV (Wang et al., 2015).
Esses elementos representam quase 15 dos custos
iniciais de instalação, porém podem ser maiores no
caso de ser necessária uma substituição prematura
quando não seguidas as recomendações do fabricante
no seu carregamento e descarregamento (Perez et al.,
2015).

ISSN 2525-8311

Seguindo esta abordagem, este artigo propõe
uma estratégia de controle do sistema de geração FV
associada ao controle_de_carga e descarga do banco
de baterias para a eliminação de flutuações de potência na rede, permitindo melhorar a qualidade de
energia numa situação em que ocorra elevada penetração de geração FV.
O artigo está estruturado da seguinte forma. A
seção II descreve o modelo do sistema FV com baterias conectados  rede_elétrica. A seção III apresenta
a estratégia de controle aplicada ao sistema. Os resultados obtidos em simulação e experimentais do sistema proposto são apresentados na Seção IV. As
conclusões do estudo são apresentadas na seção V.
2 Modelo do sistema
O sistema de geração FV é constituído por painéis
fotovoltaicos e um conversor_cccc boost conectado
ao barramento_cc do inversor. O sistema de armazenamento é composto por um banco_de_baterias e um
conversor_buckboost bidirecional, que também é
conectado ao mesmo barramento. Assim, este conversor fornece energia para a bateria (buck) ou retira
energia da bateria (boost) (Zhang et al., 2008). Todo
sistema é conectado a rede através de um filtro LCL
e um transformador elevador (12) como descrito na
Fig. 1. A potência nominal do sistema é 2 kW.
2914

XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

Figura 1. Topologia do sistema_fotovoltaico com bateria conectado a rede_elétrica.
Tabela I Especificações do painel KC 120TM
Especificação
KC 120TM

PMPP (W)

120 W

VMPP (V)

16,9 V

I MPP (A)

7,1 A

VOC (V)

21,5 V

sistência interna, i é a corrente da bateria (A), i* é
corrente filtrada (A).
Tabela II Especificações do banco_de_baterias
Especificações
Valor

Tensão Nominal (V)
Capacidade Nominal (Ah)
Estágio Inicial de Carga ()
Tensão em Carga Completa (V)
Corrente Nominal de Descarga (A)

60
60
50
74
12

2.1 Modelo dos paneis e do banco_de_baterias
Neste trabalho, adotou-se o modelo de diodo
único para o painel FV, que está composto por uma
fonte de corrente, um díodo, e duas resistências internas, uma em série e outra em paralelo (Ding et al.,
2010). O sistema FV contêm dois arranjos conectados em paralelo com oito painéis KC 120TM cada,
conectados gerando uma potência máxima de 2 kW.
A especificação desses paneis mostra-se na Tabela I.
O modelo do banco bateria é obtido da biblioteca SimPowerSystems do sofware MATLAB, com
parâmetros da bateria chumbo-ácido e será usado
para simular o banco_de_baterias do sistema. O detalhamento do modelo da bateria é descrito em
(Tremblay and Dessaint, 2009). Devido  natureza
intermitente da produção de energia_solar, as baterias
de chumbo-ácido costumam ser usadas em aplicações envolvendo microgeração, pois suportam elevadas variações de carga e descarga. A bateria chumboácido foi modelada com a escolha adequada dos
parâmetros de profundidade de descarga. Os limites
de carregamento para a bateria foi fixada em 20 e
80 do estado de carregamento (SOC, do inglês
State of Charge). O perfil de carga e descarga da
bateria foi estabelecido segundo o modelo analítico
dado por (1) e (2) (Tremblay and Dessaint, 2009).

Q  * 
Q
Vbat  V0  Ri   K
 i  K
 it  0,1Q 
 Q  it


t
 it  e (1)



Q 
*
t
Vbat  V0  Ri   K
(2)
 (it  i )  e
 it  0,1Q 
onde, Vbat representa a tensão da bateria, V0 é a constante da tensão da bateria, K é a constante de polarização dada em (VAh) ou resistência de polarização
dada em Ohms, Q é a capacidade da bateria dada em
(Ah), it é a carga atual da bateria em (Ah), R é a re-

ISSN 2525-8311

Neste modelo, a expressão para a tensão de polarização e a resistência de polarização é considerada
para modelar a tensão de circuito aberto da bateria de
forma mais precisa. O termo dentro do primeiro
colchete em (1) representa a resistência de polarização e o segundo colchete representa a tensão de polarização. O tamanho do banco de bateria foi escolhido
para proporcionar o máximo de energia reservada
para compensar a geração FV no caso de um pequeno ou nenhum nível de irradiação. O banco_de_baterias foi projetado para suprir uma potência de 2 
durante duas horas.
A reserva da bateria é projetada para aplicações
de curta duração. Dessa forma, são utilizadas no
sistema cinco baterias chumbo-ácido de 12 V e 60
Ah. Os parâmetros do banco de bateria apresentamse na Tabela II.
2.2 Caracterização do perfil de irradiação aplicado
ao sistema FV
A geração FV é sensível s variações de temperatura e a irradiação_solar, de modo que a passagem
de nuvens sobre os painéis causa transitórios na potência gerada. Portanto, torna-se necessário caracterizar estes transitórios de potência. De acordo com
(Lopes et al., 2015), a variação da geração FV é
quase insignificante para dias sem nuvem e dias
nublados. Os impactos são maiores nos dias considerados parcialmente nublados, que podem apresentar
variações de mais de 60 da capacidade instalada.
Para considerar este efeito, obteve-se o perfil de
irradiação aplicado ao sistema FV para um dia parcialmente nublado como mostrado na Fig. 2 e cujos
parâmetros mais relevantes são resumidos na Tabela
III.

2915

XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

Esta caracterização será considerada no desenvolvimento da estratégia de controle para reduzir a
variação da potência injetada na rede.
Tabela III Parâmetros de caracterização do perfil de irradiação.
Parâmetro
Valor

Variação de irradiação (W)
Irradiação mínima (Wmin)
Duração de rampa (tW)
Tempo da amostra (tevento)

77
2,5
15 s
10 min

Figura 2. Perfil de irradiação

3 Estratégias de controle
3.1 Controle do Seguido de Máxima Potência
Para garantir que os painéis operem no ponto de
máxima_potência, mesmo com variações meteorológicas é imperativo controlar o ciclo de trabalho da
chave do conversor_boost. Isto é feito utilizando as
técnicas de rastreamento_do_ponto_de_máxima_potência, também conhecida como MPPT (do inglês, Maximum Power Point Tracker).
Existem muitos algoritmos MPPT, dentre eles
PO (Perturba e Observa), CV (tensão constante) e
CI (Condutância Incremental). Em (Murtaza et al.,
2013) e (Dash and Verma, 2014), foram realizadas
varias comparações entre os principais métodos de
MPPT e concluiu-se que a técnica PO oferece alto
desempenho com um numero reduzido de variáveis
medidas e de fácil implementação. O fluxograma
para esta técnica é observado na Fig. 3.

Figura 3. Fluxograma do algoritmo de MPPT PO.

3.2 Controle do seguidor_de_máxima_potência
De acordo com (Moreno, 2010), o carregamento das
baterias é feito normalmente no referencial de corrente ou no referencial de tensão da bateria. Neste
caso, como o banco_de_baterias é utilizado para reduzir os impactos da variação de potência da geração
FV, a referência de tensão para o controle_de_carga e
descarga da bateria, quando a mesma estiver carregada, será definida a partir da tensão do barramento_cc.
Dessa forma, o objetivo principal das estratégias de
controle é a utilização do sistema de armazenamento
para regular a tensão do barramento_cc garantindo
uma injeção de potência na rede constante. Logo,
estabeleceram-se duas malhas_de_controle segundo o
SOC do banco_de_baterias se estiver carregado, o
controle tem a finalidade de controlar a tensão do
barramento como mostrado na Fig. 4(a) se o banco
de baterias estiver descarregado, o controle será
aplicado para controlar o carregamento do banco de
baterias até obter 50 do SOC como ilustrado na
Fig. 4(b). Cabe anotar que a malha interna de corrente é a mesma para os dois casos.
Esta malha de corrente contem restrições considerando os valores nominais de carga e descarga.
Assim, o conversor_buck-boost bidirecional realiza o
fluxo_de_potência do sistema para manter o barramento_cc estável em 200 V de acordo com a potência
gerada no painel FV. É desejado que o fluxo_de_potência para rede fosse constante em 1 kW, independente das variações de geração no painel. Assim, a
bateria deve complementar o suprimento de potência
quando a geração FV não for suficiente. Se a geração
FV for maior do que 2 kW, então a bateria absorve a
potência excedente.
Para a aquisição do sinal de referência da malha
de corrente para o controle da Fig. 4(b) é utilizada a
malha externa da tensão do barramento_cc.
3.3 Controle do inversor conectado a rede_elétrica
As malhas_de_controle do inversor também foram
definidas com base no SOC do banco_de_baterias, de
tal forma que se o banco_de_baterias estiver carregado, a malha_de_controle do inversor é definida conforme na Fig. 5(a). No caso contrario, a malha de
controle do inversor é determinada segundo a Fig.
5(b).
Para obter o referencial de corrente da malha de
controle na Fig. 5(a) é utilizado o bloco Cpot, o qual
calcula a corrente de referência ica com base na equação (2).
P*
Q*
ica*  2
sen(t  v )  2
sen(t  v ) (2)
V
V
ou seja
*
ica
 ireal  iimag

ISSN 2525-8311

(2)

2916

XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

Tabela IV. Ganho dos controladores 4(a) e 4(b).
Controlador
Kp
Ki

(a)

Cibat
Cvbat
Cbar

13,3
1,38
0,10

583,33
260,55
3,41

Tabela IV. Ganho dos controladores 5(a) e 5(b).
Controlador
Kp
Ki
(b)
Figura 4. (a) Malha de controle de carregamento do banco de
bateria. (b) Malha de controle de do barramento CC.

Cica
Cbar

15
0,10

150
3,41

Tabela VI. Parâmetros do conversor_boost do FV
Parâmetro
Valor

(a)

Indutância do Indutor (mH)
Resistência do Indutor ()
Capacitor de Entrada (F)
Frequência de Chaveamento (kHz)

7,0
0,3
47
10

Tabela VII. Parâmetros do conversor_buckboost do FV.
Parâmetro
Valor
(b)
Fig. 5. (a) Malha de controle da potência injetada na rede. (b)
Malha de controle da tensão do barramento.

Nas Fig. 5(a) e Fig. 5(b), observa-se que a malha
interna de corrente da bateria é a mesma da malha
interna do controle_de_corrente do inversor. Em todos
os casos a implementação do controlador é feito
através do controlador PI, exceto para o controle da
corrente do inversor, onde foi utilizado um controlador PR, devido a sua característica senoidal (Caracas,
2013). Os parâmetros dos controladores são especificados nas Tabelas IV e V.
4 Simulação e resultados experimentais
Na Tabela VI, VII e VIII, apresentam-se os parâmetros utilizados tanto para a simulação quanto para o
experimento do sistema proposto.
4.1 Análises das simulações
Na Fig. 6 e na Fig. 7, mostram-se as respostas do
sistema ante mudanças na corrente da rede com irradiação quase constante durante a carga das baterias e
durante uma etapa de fornecimento de energia para a
rede, respectivamente. No primeiro caso, a rede entrega energia para as baterias em conjunto com os
paneis. O fator_de_potência mantem-se unitário e a
tensão do barramento é estabilizada rapidamente
quando iac aumenta e diminui em 0,75 s e 1,5 s, respectivamente. A tensão do barramento mantem-se na
faixa de 10 do valor nominal embora a corrente
de carga quase triplica.

ISSN 2525-8311

Indutância do Indutor (mH)
Resistência do Indutor ()
Capacitor de Entrada (F)
Frequência de Chaveamento (kHz)

8,6
0,45
440
10

Tabela VII. Parâmetros do inversor e filtro LCL.
Parâmetro
Valor

Frequência de chaveamento (kHz)
Indutância do indutor Lf1 (mH)
Indutância do indutor Lf2 (mH)
Capacitor Cf (F)

10
2,5
0,5
10

A partir da caracterização do perfil de irradiação
aplicado ao sistema FV foi gerada uma amostra representativa de 4 s para avaliar o desempenho dos
controladores em condições de carga constante como
mostrado na Fig. 8. Assim, comprovou-se que a
referência fixada pelo algoritmo MPPT é rastreada
efetivamente e que a energia dos paneis é fornecida 
rede eou  bateria quando disponível. No caso de ser
insuficiente, a bateria entrega o restante para não
perturbar  rede.
4.2 Análises dos resultados experimentais
O sistema proposto implementou-se usando
IGBTs SKM 50GB12T4 e diodos SKKD 60F da
SEMIKRON. As estratégias de controle programaram-se em um DSP TMS320F28335 usando a transformada bilinear (Tustin) para a discretização dos
controladores.
Devido s limitações na quantidade de baterias e
considerando um ganho de tensão razoável das etapas cc, optou-se por usar um transformador elevador
(12). Além disso, a inserção deste transformador
fornece isolamento galvânico e permite desconsiderar os efeitos das componentes de modo comum.

2917

XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

Figura 9. Resultado experimental para diminuição na corrente de
carga durante a carga das baterias.

Figura 6. Resultados de simulação para mudanças da corrente de
carga durante a carga das baterias.

Figura 10. Resultado experimental para aumento na corrente de
carga durante a carga das baterias.

Figura 7. Resultados de simulação para mudanças da corrente de
carga quando o sistema fornece para a rede.

Figura 8. Balanço de potência no sistema com a aplicação do perfil
de irradiação para carga constante.

Na Fig. 9, observa-se a resposta do sistema a
um degrau (incremento) na corrente de carga. A
tensão do barramento foi controlada adequadamente
e sua variação esteve dentro da faixa de 10 do
valor de referência.
O PLL e o controlador PR mantiveram a corrente da rede em fase e regulada corretamente durante toda a transição, ou seja, menos de um ciclo de
rede como descrito no quadro de detalhamento.

ISSN 2525-8311

Figura 11. Resultado experimental para diminuição na corrente de
carga quando o sistema fornece para a rede.

Na Fig. 10, mostra-se a resposta a um degrau
(redução) na corrente de carga. Da mesma maneira,
que no caso anterior a estratégia de controle atuou de
tal forma que permitiu regular a tensão no barramento e as baterias carregaram-se mais lenta mente devido  corrente menor. O tempo de resposta da corrente
de rede foi menor de um ciclo como no caso anterior.
Na Fig. 11, apresentaram-se os mesmos sinais
que nos casos anteriores considerando o caso em que
o banco_de_baterias fornece para a rede. Em 0,25 s,
um degrau (redução) na corrente de carga foi aplicado, a corrente da bateria diminui em amplitude como

2918

XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

esperado enquanto a tensão do barramento foi regulada corretamente.
Embora, a resposta em geral foi aceitável, percebeu-se que a corrente da rede possui alguma distorção quando é baixa. Além disso, constatou-se que
os tempos de resposta da simulação e do experimento
não se correspondem entre eles, o qual pode-se dever
a algumas não_linearidades nos núcleos dos indutores
escolhidos.
5 Conclusão
Uma estratégia de controle para um sistema de
geração fotovoltaico com baterias conectado  rede
apresentou-se. O fluxo_de_potência regulou-se adequadamente em função da potência disponível nos
paneis e do estado de carga do banco baterias. Dessa
maneira, comprovou-se que as quedas de potência
entregue  rede ante as mudanças significativas da
irradiação foram mitigadas mediante a utilização do
banco_de_baterias e o adequado projeto dos controladores.
Nos casos de variações da corrente de carga, a
estratégia de controle mantem equilibrada a tensão
do barramento_cc com tempos de resposta aceitáveis
dentro de uma faixa de 10 do valor de referência.
Agradecimentos
Os autores agradecem a CAPES e ao CNPq pelo
apoio financeiro que tornou possível a realização
deste trabalho.
Referências Bibliográficas
Caracas, J.V.M. (2013). Avaliação Das Estratégias
de Controle E Projeto de Inversores Para
Conexão de Fontes Fotovoltaicas  Rede CA,
Universidade Federal do Maranhão.
Chagas, A.G. and Souza, A.C.Z. de. (2015).
Avaliação da Estabilidade de Sistemas de
Distribuição Considerando a Presença de
Elevada Penetração de Geração Distribuída,
Anais Da XI Conferência Brasileira Sobre
Qualidade de Energia Elétrica, 2015.
Dash, S.K. and Verma, D. (2014). Comparative
Analysis of Maximum Power Point (MPP)
Tracking Techniques for Solar PV Application
using MATLAB Simulink, Recent Advances
and Innovations in Engineering (ICRAIE), 2014,
pp. 17.
Ding, F., Li, P., Huang, B., Gao, F., Ding, C. and
Wang, C. (2010). Modeling and simulation of
grid-connected hybrid photovoltaic-battery
distributed generation system, CICED 2010
Proceedings, pp. 110.
European Photovoltaic Industry Association. (2014).
Global Market Outlook for Photovoltaics 20142018, Brussels, Belgium.

ISSN 2525-8311

Lopes, M.G., Ferreira, T.S.D., Trindade, F.C.L. and
Freitas, W. (2015). Análise dos Impactos
Técnicos Resultantes da Intermitência de
Geração de Sistemas Fotovoltaicos na Qualidade
da Tensão, Anais Da XI Conferência Brasileira
Sobre Qualidade de Energia Elétrica, 2015.
Moreno, R.M.M. (2010). Estudo de Técnicas de
Controle de Fluxo de Potência E de
Gerenciamento de Ilhamento Em Sistemas de
Geração Distribuída Com Interfaces Eletrônicas
de Potência Para Conexão Com a Rede Elétrica,
Universidade Estadual de Campinas.
Murtaza, A.F., Sher, H.A., Chiaberge, M., Boero, D.,
De Giuseppe, M. and Addoweesh, K.E. (2013).
Comparative analysis of maximum power point
tracking techniques for PV applications, Multi
Topic Conference (INMIC), 2013 16th
International, pp. 8388.
Perez, F., Souza, P.V.G., Filho, H.K.R., Bonatto,
B.D., Motoki, É. and Ribeiro, P.F. (2015).
Simulação Computacional de Sistemas
Fotovoltaicos com Armazenadores de Energia
Integrados em Redes Elétricas Inteligentes,
Anais Da XI Conferência Brasileira Sobre
Qualidade de Energia Elétrica, 2015.
Tremblay, O. and Dessaint, L.A. (2009).
Experimental validation of a battery dynamic
model for EV applications, World Electric
Vehicle Journal, Vol. 3 No. 1, pp. 289298.
Wang, Y., Tan, K., Peng, X. and So, P. (2015).
Coordinated Control of Distributed Energy
Storage Systems for Voltage Regulation in
Distribution Networks, IEEE Transactions on
Power Delivery, Vol. 31 No. 3, pp. 11321141.
Zhang, J., Lai, J.S. and Yu, W. (2008). Bidirectional
DC-DC converter modeling and unified
controller with digital implementation, Applied
Power Electronics Conference and Exposition,
2008. APEC 2008. Twenty-Third Annual IEEE,
Vol. 2, pp. 17471753.

2919