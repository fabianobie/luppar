Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

SIMULAÇÃO DO SINAL DE SAÍDA DO SISTEMA DE LEITURA DO SINAL DA PMT PARA O
DETECTOR DO PROJETO NEUTRINOS-ANGRA
FLÁVIA T. ARAÚJO , TONY DORNELAS, RAFAEL A. NÓBREGA, TIAGO A. ALVARENGA FOR THE ANGRA
COLLABORATION
Universidade Federal de Juiz de Fora
Caixa Postal 36036-900, Juiz de Fora, MG, BRASIL
E-mails flavia@engenharia.ufjf.br, tony@engenharia.ufjf.br,
rafael.nobrega@ufjf.edu.br, tiago.araujo@engenharia.ufjf.br
Abstract
 The Neutrinos-Angra project consists of the development of a detector capable of measuring the flux of antineutrinos coming from the Angra II nuclear reactor. One of the fundamental parts of the project is the simulation of the detector
itself and its output signal, which is the final product of the apparatus chain. In this document we describe the signal simulation
software which is developed to give the electrical and the digitalized detector signal based on the arrival time of the photons to
the detector photomultipliers generated by the interactions of the crossing particles.
Keywords
 Detector signal simulation, Photomultiplier, nuclear reactor
Resumo
 O projeto Neutrinos-Angra consiste no desenvolvimento de um detector capaz de medir o fluxo de anti-neutrinos
vindos do reator_nuclear de Angra II. Uma das partes fundamentais do projeto é a simulação do próprio detector e seu sinal de
saída, que é o produto final da rede de aparatos. Neste documento é descrito o software de simulação do sinal que é desenvolvido para dar o sinal elétrico e digitalizado do detector baseado no tempo de chegada dos fótons s fotomultiplicadoras do detector
gerados pela interação das partículas passantes.
Palavras-chave
 

1

Introdução

O projeto Neutrinos-Angra (Neutrinos, 2007)
tem como objetivo o desenvolvimento de um detector
compacto e de superfície, capaz de medir o fluxo de
anti-neutrinos provenientes da reação nuclear que
ocorre dentro de reatores nucleares para assim possibilitar o monitoramento da sua potência térmica instantânea dissipada. O projeto prevê a instalação deste
detector a aproximadamente 25 m do núcleo do reator de Angra dos Reis, ao lado da cúpula externa do
sistema_de_proteção, bem como de um laboratório de
controle de aquisição do experimento.
O design do detector foi definido (ver Figura 1)
e se encontra hoje em fase de montagem. O detector
alvo (Anjos, J. C. et al., 2011) será feito com paredes
refletoras e fará uso de 32 PMTs (do inglês PhotoMultiplier Tube), divididos entres as paredes superior
e inferior (Alvarenga et al., 2012). Ele será preenchido com água, provocando o efeito Cherenkov (Knoll,
G. F.) na interação com partículas carregadas, com
uma pequena concentração de Gadolínio, usado para
acelerar a captura do nêutron da reação  + p  e+ +
n. O sinal gerado pelo nêutron ocorre alguns microssegundos após o sinal gerado pelo pósitron. Este fato
é usado como uma das principais ferramentas para
selecionar eventos relacionados  reação de antineutrinos de interesse. Além do detector alvo, um
sistema_de_veto de raios cósmicos e de outras fontes
naturais de radiação, equipado com 16 PMTs, foi
projetado. 8 PMTs são usadas nas laterais do detector
e 8 são divididas entre duas estruturas (tampas) que

ISBN 978-85-8001-069-5

se encaixam na parte superior e inferior do detector
central. O detector completo será composto, então, de
um total de 48 PMTs do tipo Hamamatsu R5912
(Hamamatsu, 2008) que tem como características
principais sensibilidade a um único fóton com uma
eficiência quântica de aproximadamente 22, alto
ganho (105) e rápido sinal de saída (duração do sinal
 20 ns). Devido a curta duração e baixa amplitude
do pulso de saída da PMT, uma front-end (circuito
leitura do sinal) foi projetada de maneira que um
ADC (do inglês Analog to Digital Converter) com
taxa de amostragem de 125 MHz seja capaz de amostrar o sinal sem perda de informação. Outro componente previsto no projeto de eletrônica é o discriminador, que poderá ser usado para achar coincidências
entre sinais de diferentes PMTs a fim de realizar um
primeiro sistema de filtragem para a seleção de eventos (trigger).

Figura 1  Ilustração do detector Neutrinos-Angra, apenas a tampa
superior do sistema_de_veto é mostrado.

3054

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

Neste documento apresentaremos o sistema de
simulação do sinal elétrico de saída do detector desenvolvido para o projeto Neutrinos-Angra. O software em questão, desenvolvido com o apoio das
bibliotecas do ROOT, engloba a simulação do sinal
gerado pela PMT o sinal de saída da front-end e sua
digitalização, realizada na prática por ADCs localizados no módulo de aquisição do experimento (Lima,
2009). As características desses três elementos principais foram estudadas, e medidas quando necessário,
para que uma reprodução correta de seus comportamentos fosse realizada. Este software foi desenvolvido para funcionar junto  simulação do detector. Este
último cuida da interação de partículas e propagação
dos fótons gerados dentro do detector até que uma ou
mais PMTs sejam atingidas. A partir deste ponto, o
software, que apresentamos neste documento, reproduz o sinal de saída do sistema de leitura que vai
desde a PMT, passando pelo amplificador até o
ADC, considerando as principais características dos
vários elementos que compõem este sistema.
2 Simulação do sinal do detector
2.1 Estrutura Geral
A Figura 2 mostra a estrutura da geração de sinal
para uma única PMT. Este sinal é feito de três componentes_principais 1) a resposta_ao_fotoelétron, 2) a
corrente de escuro e 3) o ruído de fundo. A geração
desses três sinais é feita independentemente para então serem somados para formar o sinal final. Esse
sinal pode então ser enviado para um discriminador
ou para um ADC, onde ele será digitalizado, gerando
finalmente os dados finais que serão armazenados
para futuras análises. Um algoritmo de contagem de
coincidências entre sinais de diferentes PMTs também foi desenvolvido a partir do sinal de saída do
discriminador, viabilizando assim estudos relacionados ao primeiro nível de trigger do experimento.

Figura 2 - Esquema em blocos do programa de simulação.

Cada sinal é feito considerando funções de densidade de probabilidades (pdf do inglês probability
density function) que representam o comportamento
dos vários parâmetros do sistema, como tempo de
ocorrência, amplitude e forma de onda do sinal. Essas pdfs foram geradas a partir de dados coletados
experimentalmente e considerando os processos físicos de funcionamento dos vários componentes envolvidos na geração e processamento do sinal. Muitos dos parâmetros usados na simulação foram retirados de especificações de componentes, como por

ISBN 978-85-8001-069-5

exemplo o tempo de resposta da PMT (drift-time) , a
resolução do ADC e o tempo de resposta do discriminador. Mais detalhe sobre isso será dado na seção
3.
2.2 Estrutura do software
O código encontra-se estruturado em cinco diferentes classes como mostrado na Figura 3.

Figura 3 - Estrutura do software de simulação.

Ao todo são cinco classes, a saber
- Run Nele são definidas as características da
simulação (número de PMTs, tempo de aquisição,
uso ou não da front-end, geração externa ou interna
dos eventos de fotoelétron). É a única classe chamada
pelo usuário, as demais têm suas chamadas internas
ao programa.
- SignalFinal é empregada pela classe Run.
Essa parte é responsável pela concatenação final dos
sinais e sua representação gráfica. Para tal, obtém as
componentes do sinal da classe PmtSignal.
- PmtSignal é chamada na classe SignalFinal.
Nessa etapa são criados os sinais individuais de cada
tipo (ruído de fundo, corrente de escuro e evento do
fotoelétron). Inicialmente, caso a origem dos tempos
de fotoelétron seja externa, é usada a função Readclass, caso contrário, a sua criação é interna como
será descrito na seção 3.
- Readclass esse bloco, chamado na classe
PmtSignal, faz a leitura de dados provenientes do
programa de simulação do detector. Esta classe foi
feita de maneira independente, para facilitar modificações futuras caso o padrão dos dados do experimento mude.
- Compare essa função é chamada dentro do
bloco Run e realiza a análise de coincidência dos
sinais de corrente de escuro dentro de janelas de
tempo.
Este último bloco, como dito anteriormente, foi
desenvolvido para colocar o algoritmo de simulação
em teste. É ao final do algoritmo Run que os dados
ficam prontos para armazenamento.
3 Geração do sinal
3.1 Geração de eventos
A geração dos eventos consiste em duas etapas, a
primeira é a definição de pdfs para determinar os
intervalos de tempo entre cada um dos eventos. Para
a corrente de escuro, a melhor distribuição para descrever esse fenômeno é a distribuição Gamma (Pee-

3055

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

bles, 1987), que, como a distribuição de Poisson,
depende somente do parâmetro de taxa de ocorrência
 do evento. Para a resposta_ao_fotoelétron, os dados
referentes ao tempo de ocorrência dos eventos de
fotoelétron possuem duas opções de origem gerados
aleatoriamente pelo software de maneira análoga 
corrente de escuro, porém com um valor  diferente,
ou lidos a partir de um arquivo externo, gerado pelo
programa de simulação do detector. A Figura 4 mostra as curvas referentes a essas distribuições. O ruído
de fundo, por sua vez, está sempre presente no sinal
em todos os momentos.

Figura 5 - Gráfico das amplitudes de cada componente do sinal na
saída da front-end ruído de fundo (média em 0), fotoelétron (média em 0.03) e corrente de escuro (média em 0.1).

Ao final dessa etapa, as características básicas de
cada sinal estão determinadas seu número de eventos
e respectivos tempos e amplitudes individuais. A
forma de onda de cada um dos sinais será visto na
próxima seção.
3.2 Forma de onda do sinal analógico

Figura 4 - Gráfico do intervalo de tempo entre sinais consecutivos
para o fotoelétron (o de maior inclinação) e para a corrente de
escuro.

A definição do número total de eventos dos dois
sinais considerados é feita a partir dos dados desses
gráficos. Essa determinação é realizada da seguinte
maneira os intervalos de tempo escolhidos são somados e armazenados, até alcançarem o tempo total
de simulação fixo no inicio do software pelo usuário,
a quantidade de eventos total será o número de intervalos necessários para tal. No caso em que o sinal do
fotoelétron é gerado por um arquivo externo, só são
lidos os tempos dentro do intervalo considerado pelo
programa e o número de eventos é encontrado do
mesmo jeito anterior.
Para a determinação dos valores de amplitude,
foram definidas as pdfs que descrevem mais fielmente as características das três componentes do sinal.
Essas definições foram feitas a partir de medidas
experimentais, o que nos levou a considerar a distribuição Gaussiana para os três casos (ruído, corrente
de escuro e fotoelétron), cada uma com os seus parâmetros de média e desvio padrão. Esses valores
podem ser alterados sempre que medidas mais precisas e atuais sejam realizadas. Podemos também definir diferentes pdfs para as diversas PMTs presentes
no detector. No momento, selecionamos apenas três
pdfs de amplitude, uma para cada componente do
sinal, e as usamos para todas as PMTs uma vez que
estas não foram, até o momento, caracterizadas individualmente. A Figura 5 mostra as distribuições (não
normalizadas) utilizadas para descrever as amplitudes
do ruído de fundo, da resposta_ao_fotoelétron e da
corrente de escuro.

ISBN 978-85-8001-069-5

Para finalizar a reprodução do sinal elétrico, é
necessária agora a definição de uma forma de onda
para os sinais gerados a partir da um único fotoelétron. Através de medidas diretas, chegamos a uma
forma do sinal de saída da PMT e de saída da frontend. Enquanto a primeira apresenta uma Gaussiana, a
segunda tem uma forma dada pela convolução entre
uma função Gaussiana e uma Landau, como mostra a
Figura 6.

Figura 6  Forma de onda do sinal medida e fit.

Medidas da forma de onda do sinal de corrente
de escuro também foram realizadas. O resultado indica que não existe diferença da forma de onda deste
em relação ao sinal de resposta_ao_fotoelétron.
O código gera então, para cada evento de corrente de escuro e de fotoelétron, um sinal que usa como
parâmetro de entrada a sua amplitude. A Figura 8
mostra como exemplo, um sinal analógico de resposta_ao_fotoelétron, antes da componente de ruído ser
adicionada.
Para o ruído eletrônico (de fundo), considerou-se
que, para a taxa de amostragem do sistema, este sinal
se comporta como um ruído branco e gaussiano.
De posse de todas as informações anteriores, um
sinal final organizado temporalmente pode ser criado.
Na seção seguinte, veremos como este sinal analógico é digitalizado para formar então os dados finais,
relativos  saída da conversão analógico-digital, a
serem armazenados para futuras análises.

3056

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

3.3 Digitalização do sinal
A digitalização é feita em relação a dois parâmetros fundamentais 1) a taxa de amostragem, determinado no início do software e 2) a resolução da amplitude do sinal. Ambos são parâmetros relacionados
 conversão analógico-digital do experimento e, neste
software, podem ser definidos no início da simulação. O efeito desses processos pode ser notado na
Figura 8, onde temos o sinal analógico e os valores
discretos gerados pela passagem deste sinal pelo
ADC simulado com uma taxa de amostragem de 125
MHz e uma resolução da amplitude de 0.0001 V.

Figura 7 - Sinais análogico (preto) e digital (vermelho) devido a
evento de fotoelétron com front-end.

A última etapa do programa consiste na concatenação dos sinais após digitalização dos mesmos. Esta
é realizada de maneira simples, sendo a soma dos
diferentes sinais (resposta_ao_fotoelétron, corrente de
escuro e ruído de fundo). O resultado final dessa junção está representado na Figura 9, e é nesta fase que
os dados de saída do programa são armazenados.

4.1 Controle dos parâmetros do sinal de saída (amplitude e tempo)
Aqui apresentamos os resultados experimentais
das distribuições de amplitude e tempo para 32
PMTs, referentes  simulação do detector central.
Este teste serve para certificar, dada a complexidade
do programa, que todas as etapas do programa estão
funcionando sem falhas e conforme o esperado.
Inicialmente serão analisadas as distribuições das
amplitudes. Para tal, será feito um histograma com os
valores de amplitude de pico usados a partir do sinal
de saída, e então será realizado uma regressão baseada no qui-quadrado. Os parâmetros do fit serão examinados para conferir a compatibilidade entre os
dados gerados na saída da simulação e os parâmetros
usados na construção das pdfs originais.
O primeiro resultado analisado será o da amplitude dos sinais de corrente de escuro. Os parâmetros
usados na pdf original foram de 0,1 V para a média e
de 0,02 V para o desvio padrão. Como se pode notar
pela Figura 10, o valor de qui-quadrado dividido pelo
grau de liberdade (18) é de aproximadamente 0,892,
o que indica que o modelo Gaussiano pode ser considerado e os valores de média e desvio padrão obtidos
correspondem aos valores da pdf inicial.

Figura 9 - Resultado da amplitude da corrente de escuro.

Figura 8 - Concatenação dos sinais de ruído, corrente de escuro e
de resposta_ao_fotoelétron.

4 Testes e Resultados
Com o intuito de validar o desenvolvimento deste software, serão mostrados alguns resultados obtidos após uma simulação completa, realizada em um
tempo total de aquisição de aproximadamente 100
microssegundos e com valores de 10K e 50K para as
taxas de eventos por segundo de corrente de escuro e
fotoelétron, respectivamente. Dois testes foram realizados 1) a comparação dos valores para amplitude
de pico e intervalos de tempo entre eventos com os
gráficos iniciais, 2) análise dos resultados para a
coincidência de eventos de corrente de escuro, que é
comparado com os valores encontrados em um programa equivalente em MATLAB.

ISBN 978-85-8001-069-5

Para as amplitudes do ruído de fundo foram usados os seguintes valores 8.479 V para a média e
1.147 mV para o desvio padrão. O histograma referente aos dados de saída do programa se encontra na
Figura 11. Assim como no caso anterior, temos um
valor de qui-quadrado (0,927) que indica a aceitação
da Gaussiana como modelo para a medida, além de
seus valores de desvio-padrão e média representarem
adequadamente a pdf inicial.

Figura 10 - Resultado da amplitude do ruído de fundo.

Para a resposta_ao_fotoelétron os valores usados
para a média e desvio padrão foram respectivamente

3057

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

de 0,03125 V e 0,01269 V. Temos então novamente,
de acordo com a Figura 12, a confirmação que os
dados foram gerados de acordo com as pdfs iniciais,
conforme o esperado, sem nenhuma distorção.

Figura 11 - Resultado da amplitude da resposta_ao_fotoelétron.

Agora, passaremos para a análise das distribuições dos intervalos temporais. Esse exame será feito
de forma análoga ao de amplitude, a única diferença
residindo no fato da exponencial ter sido criada com
apenas um parâmetro de entrada, a sua média, representando o intervalo de tempo médio entre as ocorrências de eventos consecutivos (1).
A Figura 13 apresenta o histograma e fit referente aos intervalos de sinal da corrente de escuro e a
Figura 14 apresenta o resultado referente ao sinal do
fotoelétron, obtidos através da simulação. Como
ocorreu com a análise da distribuição de amplitude
do sinal, ambos os resultados mostram o bom funcionamento da geração temporal dos eventos realizada
por este programa de simulação. Temos um intervalo
médio entre eventos de corrente de escuro de 101 s
e, de resposta_ao_fotoelétron de 19,84 s. Dado o erro
estatístico, o resultado está de acordo com as pdfs
iniciais.

Figura 72 - Resultado do intervalo de tempo da corrente de escuro.

Figura 83 - Resultado do intervalo de tempo da resposta_ao_fotoelétron.

4.2 Coincidência de corrente de escuro
Outro teste realizado para validar o funcionamento do sistema, olhando agora para a saída do discriminador, foi a medida da taxa média de coincidências dada o número de PMTs total, aqui 32 PMTs
foram consideradas de acordo com o detector alvo.
Uma coincidência (trigger) é definida quando N
PMTs diferentes geram sinais dentro de uma janela
de tempo T. Esses dois parâmetros_são definidos ao
início de cada execução do programa.
Analisaremos aqui a taxa de coincidência gerada
a partir do sinal de corrente de escuro. Consideramos
que todo sinal proveniente de qualquer PMT abra
uma janela de tempo  procura de coincidências até o
momento que um sinal de trigger seja gerado. Quando isso ocorre, uma nova janela de tempo só pode ser
aberta após o término da janela anterior, que provocou o sinal de trigger. Para conferir a validade do
resultado encontrado, um programa independente
escrito para o MATLAB foi empregado. O número
de coincidências para uma janela de tempo de 100 ns
e para dois valores de N (2 e 3) é mostrado na Tabela
1. Este teste foi feito considerando 32 PMTs e como
pode ser visto, os resultados estão de acordo.
N
2
3

MATLAB
9486.3  30.8
142.4  3.8

ROOT
9517  69
134  12

Tabela 1  Resultados simulados no MATLAB e no ROOT para o
detector alvo, ou seja, para 32 PMTs.

5 Conclusão
O principal objetivo deste trabalho é a simulação
do sistema de leitura e aquisição de sinal do experimento Neutrinos-Angra para gerar um sinal elétrico,
analógico e digital, a partir da resposta_ao_fotoelétron
da PMT Hamamatsu R5912 e das características dos
componentes que fazem parte do circuito de leitura
do sinal, considerando também as contribuições da
corrente de escuro e do ruído de fundo do sinal.
Os vários módulos que fazem parte da implementação deste programa de simulação foram descritos e testes foram realizados, cujos resultados mostraram o bom funcionamento do mesmo. Este programa
possibilitará estudos detalhados sobre o funcionamento do detector como um todo e de seu sistema de
trigger. Um primeiro algoritmo simples de trigger foi
implementado mostrando que os pulsos provenientes
da corrente escura da PMT podem gerar uma alta
taxa de coincidências no detector alvo para uma janela de tempo de 100 ns quando o número de PMTs
exigidas para gerar um sinal de coincidência é baixo.
Agradecimentos
Agradecemos a FAPEMIG e FINEP por acreditar e
financiar esse projeto.

ISBN 978-85-8001-069-5

3058

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

Referências Bibliográficas
Alvarenga, T. A. et al. (2012). Simulation re-sults for
light propagation in the central detector 3D
case. AngraNote 019-2012.
Anjos, J. C. et al. (2011). Monitoring Nuclear
Reactors with Antineutrino Detectors the
ANGRA Project. Artigo apresentado em reunião
da IAEA (International Atomic Energy Agency)
em 2011.
Hamamatsu (2008). Large Photocathode Area
Photomultiplier Tubes WWW. Disponível em
httpsales.hamamatsu.comassetspdfpartsRL
ARGEAREAPMTTPMH1286E05.pdf
Knoll, G. F. (1999). Radiation Detection and
Measurement, Wiley 3a Edição, 1999.
Lima,H. P. Jr. et al (2009). Data Acquisition System
for the Angra Project, AngraNote 012-2009.
httpsales.hamamatsu.comassetspdfpartsRLAR
GEAREAPMTTPMH1286E05.pdf
Acessado em 14022012.
Peeble, P. Z. Jr. (1987). Probability, Random
Variables, and Random Signal Principles. 2 ed.
McGraw-Hill.

ISBN 978-85-8001-069-5

3059