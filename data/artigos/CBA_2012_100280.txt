Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

MODELO DE PRÉ-DESPACHO HIDROTÉRMICO COMBINADO POOLBILATERAL PARA
FORMAÇÃO DE PREÇOS EM MERCADOS DE ENERGIA DO DIA SEGUINTE
ANDRÉ HENRIQUE BENETTON VERGÍLIO, MARCELO AUGUSTO CICOGNA*, LEONARDO NEPOMUCENO, EDMÉA
CÁSSIA BAPTISTA, ANTÔNIO ROBERTO BALBO
Laboratório de Otimização e Estudos Econômicos em Sistemas de Potência, Departamento de Engenharia
Elétrica, Departamento de Matemática, Universidade Estadual Paulista - UNESP
Av. Eng. Luiz Edmundo C. Coube 14-01, 17033-360 Bauru  SP
* FECUNICAMP, CP 6021, 13083-852, Campinas  SP
E-mails leo@feb.unesp.br
Abstract This paper proposes a combined poolbilateral short-term hydrothermal scheduling model (PDHC) for price formation of day-ahead energy markets. PDHC incorporates market constraints and some aspects neglected in the model that has been
used by the Brazilian ISO for calculating spot prices in weekly basis. The model has the following features i) hydro generation
resources are optimized by means of the opportunity cost function ii) the hybrid poolbilateral approach is solved by a single optimization procedure, avoiding economic inefficiencies resulting reconciliation between pool and bilateral markets iii) energy
deficit risks are intrinsically mitigated iv) there is no need for mechanisms for energy reallocation v) the decomposition methodology proposed reduces the computational effort for solving systems of real dimensions Simulations are provided involving a
test system and the Brazilian interconnected system. Sensitivity analyses are performed involving the main parameters of the
model, so as to verify its theoretical consistencycoherency and to validate its process for calculating the spot prices.
Keywords Short-term generation scheduling, Short-term generation planning, Energy markets.
Resumo Este trabalho propõe um modelo de pré-despacho_hidrotérmico combinado poolbilateral (PDHC) para a formação de
preços em mercados_de_energia do dia seguinte. O PDHC incorpora, no mercado do dia seguinte, restrições de mercado e aspectos negligenciados no modelo adotado no Brasil para o cálculo dos preços spot em base semanal. O PDHC possui as seguintes características i) os recursos de geração hidráulicos são otimizados ii) a abordagem híbrida poolbilateral é resolvida por meio de
um único problema de otimização evitando ineficiências econômicas na coordenação desses mercados iii) os riscos de déficit de
energia são intrinsecamente mitigados iv) não há necessidade de mecanismos de realocação de energia v) a metodologia de decomposição adotada reduz os tempos computacionais para a solução de sistemas reais. Simulações são apresentadas envolvendo
um sistema_teste e o sistema_interligado_nacional. Análises de sensibilidade com relação aos principais parâmetros_são apresentadas, de modo a verificar a consistênciacoerência da construção teórica do PDHC e do processo de formação de preços obtido.
Palavras-chave .

1

Introdução

Os sistemas de energia têm passado recentemente por um profundo processo de transformação, por
meio da implantação de estruturas desverticalizadas e
descentralizadas de operação, as quais são orientadas
pela competição entre os agentes, e por forças econômicas de mercado. É fundamental que a competição e descentralização sejam estabelecidas sem negligenciar os aspectos de segurança_operacional e
confiabilidade, os quais devem ser sempre considerados de forma prioritária.
Para conciliar os aspectos de competição e descentralização operacional, com os aspectos de segurança e confiabilidade, três abordagens econômicas
básicas têm sido estudadas para a representação dos
mercados_de_energia os modelos bilateral, pool e
híbrido. No modelo bilateral (Cheng et al., 1998),
contratos de energia são estabelecidos entre geradores e consumidores, independentemente do operador
independente do sistema (OIS). Tais contratos são
estabelecidos com base na competição pela compravenda de energia. No mercado pool (Jia, 1998), a
competição se estabelece em um leilão de energia,
em que os agentes geradoresconsumidores fornecem

ISBN 978-85-8001-069-5

lances, que serão avaliados pelo OIS, o qual despacha, de forma gradativa, os geradores com custos
marginais menores (associados aos lances), até o
atendimento da demanda, mas respeitando as restrições operacionais e de segurança. O preço pago ao
último gerador é denominado preço spot do sistema.
As principais abordagens utilizadas para a solução do
pool são baseadas em adaptações feitas em modelos
clássicos de despacho_econômico (DE), prédespacho (PD) (Oliveira et al, 2003), fluxo_de_potência_ótimo (FPO), unit_commitment (UC), dentre outros. A abordagem híbrida (Galiana et al., 2002) busca elaborar as melhores características dos modelos
pool e bilateral. Parte da geração é despachada através de contratos bilaterais e o fechamento do mercado é feito no pool, com o cálculo dos despachos dos
mercados e do preço spot. Nesse caso, todas as considerações de segurança e confiabilidade são introduzidas no modelo de solução do pool, que fecha o
mercado. Neste trabalho, adota-se uma abordagem
híbrida para o mercado do dia seguinte.
O mercado_de_energia do dia seguinte (Contreras
et al., 2001) envolve o cálculo do despacho e dos
preços spot em cada hora do dia seguinte, nos mercados pool e bilateral. Os contratos bilaterais são
fechados em base horária e seus preços são fixados
de forma livre. No pool, os agentes dão lances horá-

807

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

rios de energia, de modo a competir pela geraçãodemanda. O fechamento do pool envolve o cálculo dos despachos e dos preços spot, ambos em
base horária. Isso é feito de modo a minimizar os
custos dos lances e respeitando as restrições de segurança e confiabilidade. Os mercados do dia seguinte
estão conceitualmente bem estabelecidos para sistemas com predominância de geração_térmica. Nesses
casos modelos baseados em UC (Shahidehpour et al.,
2002) e FPO DC (Galiana et al., 2002) são geralmente os mais utilizados para o fechamento do pool.
O Brasil não possui ainda uma estrutura de mercado do dia seguinte. Seu mercado de curto prazo
está limitado a preços spot semanais, em três patamares de carga (CEPEL, 2004). Um dos fatores limitantes da implantação de mercados do dia seguinte no
Brasil é o modelo de PD adotado. As principais deficiências desse modelo são i) a produção hidráulica
não é otimizada ii) em algumas situações, falta uma
correlação numérica coerente entre os preços spot a
situação hidrológica iii) os geradores hidrelétricos
não dão lances no mercado pool iv) o mecanismo de
realocação de energia (MRE) (Nasser et al., 2004)
separa o despacho físico do despacho financeiro, de
modo que um gerador não recebe pelo que ele gera
de fato, mas pelo que ele contribui para a energia
assegurada do sistema. Esse tipo de sinalização econômica distorce os preços de mercado, que devem
estar sempre baseados na relação produção-consumo.
Este trabalho tem por objetivo propor o modelo
de pré-despacho_hidrotérmico combinado (PDHC)
poolbilateral, para a solução de abordagens híbridas
de mercados do dia seguinte. O PDHC possui as seguintes características i) os recursos de geração hidráulicos são otimizados ii) a abordagem híbrida
poolbilateral é resolvida por meio de um único problema de otimização (PDHC), evitando ineficiências
econômicas na coordenação dos mercados poolbilateral como em (David, 1998) iii) os riscos de
déficit de energia são intrinsecamente mitigados na
solução do PDHC iv) não há necessidade de mecanismos de realocação de energia os geradores recebem pelo que de fato geram nos mercados v) a metodologia de decomposição adotada reduz os tempos
computacionais para a solução de sistemas reais.
O PDHC é avaliado em um sistema_teste e no
sistema_interligado_nacional (SIN). Os resultados
apresentados destacam as principais características
do modelo por meio de análises de sensibilidade envolvendo alguns de seus parâmetros. Os resultados
apontam para a viabilidade de implementação de
mercados do dia seguinte para sistemas fortemente
hidrotérmicos, como o brasileiro.

ções operativas dessas usinas e de restrições do mercado para o dia seguinte, conforme (1) a (15).

2 Modelo PDHC Proposto

Definição da função de produção das usinas hidrelétricas. A função de rendimento é modelada como
uma função não_linear da potência gerada e da altura
de queda líquida a qual por sua vez é também uma
função não_linear, descrita em (10).

O problema PDHC proposto consiste na minimização dos custos de geração das usinas termelétricas e hidrelétricas, sujeito ao atendimento das restri-

ISBN 978-85-8001-069-5





  C  pt    Co  ph 
T

Min

j ,t

j ,t

i ,t

(1)

i ,t

i
 j

Sujeito s restrições (2) a (15), descritas a seguir.
t 1

Atendimento da demanda em todos os intervalos de
tempo.

 pt
j

j ,t

  phi ,t  Dt  t  1,

(2)

,T

i

Atendimento dos limites mínimos e máximos de geração nas usinas hidrelétricas e termelétricas em todos os intervalos.
phimin  phi ,t  phimax  i  t  1,
pt

min
j

 pt j ,t  pt

max
j



j  t  1,

,T

(3)

,T

(4)

Atendimento das metas energéticas pré-estabelecidas
por modelos de planejamento de médio_prazo para
usinas hidrelétricas.
T

 ph

i ,t

t 1

 i  i  

(5)

Atendimento dos contratos bilaterais firmes previamente estabelecidos por usinas termelétricas e hidrelétricas em todos os intervalos.
phi ,t  Bhi ,t  i  t  1,

,T

(6)

pt j ,t  Bt j ,t 

,T

(7)

j  t  1,

Atendimento do balanço de água nos reservatórios
em todos os intervalos. O tempo de atraso de águas
entre reservatórios consecutivos é considerado.

 t
xi ,t  xi ,t 1   yi ,t   uk ,t tvk ,i  ui ,t  6 
k i

 10
i  , t  1, , T

(8)

Definição de um volume médio em cada intervalo.
ximed

,t

xi ,t 1  xi ,t
2

 i   t  1,

,T

(9)

Definição de uma altura de queda líquida em cada
intervalo. As cotas de montante e jusante são modeladas por meio de polinômios de quarta ordem (Cicogna, 1999). As perdas de carga são modeladas de
forma constante, por uma função linear da cota de
montante, ou uma função quadrática da turbinagem
(Cicogna, 1999).
hli ,t  hmi  ximed
, t   hji  ui , t   pci , t 
i   t  1,

(10)

,T

phi ,t  .g.i ,t .hli ,t .qi ,t  i  t  1,

,T

(11)

808

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

Definição da vazão defluente de cada reservatório
em cada intervalo.
ui ,t  qi ,t  vi ,t  i  t  1,

,T

(12)

Atendimento de limites mínimos e máximos de armazenamento dos reservatórios em cada intervalo.
min
i

x

 xi ,t  x

max
i

 i  t  1,

,T

(13)

Atendimento dos limites mínimos e máximos na vazão turbinada em cada intervalo. A vazão turbinada
máxima é modelada como uma função não_linear e
não diferenciável da altura de queda líquida (Cicogna, 1999).
min
i ,t

q

 qi ,t  q

max
i ,t

 hl  
i ,t

i  t  1,

, T (14)

O vertimento em cada intervalo deve ser não negativo.
vi ,t  0 i  t  1,

,T

(15)

Em que
t  índice dos intervalos de tempo
i  índice das usinas hidrelétricas do sistema
j  índice das usinas termelétricas do sistema
T  número de intervalos de tempo
  conjunto das usinas hidrelétricas
  conjunto das usinas termelétricas
U     conjunto de todas as usinas do sistema
nh número de usinas hidrelétricas
nt  número de usinas termelétricas
nu  nt  nh  número total de usinas do sistema
Coi ( phi ,t )  custo de oportunidade da usina hidrelétrica i no intervalo t (  )
C j ( pt j ,t )  custos dos lances dos agentes de geração
da usina_termelétrica j no intervalo t (  )
Dt  demanda total do sistema no intervalo t (MW)
phi ,t  potência gerada na hidrelétrica i no intervalo

t (MW)
pt j ,t  potência gerada na termelétrica j no intervalo
t (MW)
max
 limites de geração míniphimin , phimax , pt min
j , pt j
mos e máximos, das usinas hidrelétricas i e termelétricas j (MW)
M i  meta energética para a usina hidráulica i
(MW)
Bhi ,t  somatória dos contratos bilaterais firmes fechados pela usina hidrelétrica i no intervalo t
(MW)
Bt j ,t  somatória dos contratos bilaterais firmes fe-

chados pela usina_termelétrica
t (MW)

j

no intervalo

xi ,t  volume armazenado no reservatório da hidrelétrica i e no intervalo t (hm)

ISBN 978-85-8001-069-5

yi ,t  vazão incremental afluente ao reservatório da
hidrelétrica i e no intervalo t (ms)

ui ,t  vazão defluente do reservatório da hidrelétrica
i e no intervalo t (ms)
i  conjunto das usinas hidrelétricas imediatamente
a montante da usina i 

t  tamanho do intervalo t em segundos (1 hora 
3600 segundos)
tvk ,i  tempo de viagem da água entre a usina k e a

usina i 
ximed
, t  volume médio do reservatório da hidrelétrica

i durante o intervalo t (hm)
hli ,t  altura de queda líquida da hidrelétrica i no

intervalo t (m)
hmi  polinômio de cota de montante da hidrelétrica
i (m)

hji  polinômio de cota de jusante da hidrelétrica i
(m)
pci ,t  perda de carga da usina i no intervalo t (m)

  peso específico da água (kgm)
g  aceleração da gravidade (ms)

i ,t  rendimento do conjunto turbina-gerador da usina hidrelétrica i no intervalo t 
qi ,t  vazão turbinada da hidrelétrica i no intervalo
t (ms)

vi ,t  vazão vertida da hidrelétrica i no intervalo
t (ms)

ximin , ximax  volumes mínimo e máximo do reservatório da hidrelétrica i (hm)
uimin , uimax  defluências mínima e máxima do reservatório da hidrelétrica i (ms)
max
qimin
,t , qi ,t  turbinagens mínima e máxima da hidrelé-

trica i no intervalo t (ms)
A parcela da função objetivo C j ,t  pt j ,t  envolve os custos dos lances das usinas termelétricas, sendo geralmente descrita por uma função quadrática,
como em (16), em que a j , b j , c j são os lances da
curva de custo da usina térmica

j , dados em

2

  MW ,   MW e  , respectivamente. Quando o
gerador busca exercer poder de mercado, dando lances estratégicos no leilão do pool, os valores dos
lances não correspondem aos valores reais de custo
da usinas termelétrica.
C j ( pt j ,t )  a j pt 2j ,t  bj pt j ,t  c j  j  t  1,

, T (16)

A parcela da função objetivo relacionada aos
custos das hidrelétricas é descrita em (17), em que

809

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

prct representa o preço spot no intervalo t e
Li ( phi ,t ) representa as perdas da usina hidrelétrica i
no intervalo t , dadas em MW , também denominada
de perdas hidráulicas.
Coi ( phi ,t )  prct Li ( phi ,t ) i  t  1,

, T (17)

As perdas hidráulicas (18) são propostas em
(Soares e Salmazo, 1997), tendo sido testadas com
sucesso para a otimização dos recursos hidráulicos
de geração em (Encina et al, 2002, 2008) onde
ai , bi , ci são parâmetros calculados conforme descrito
em (Encina et al., 2002).
Li ( phi ,t )  ai phi2,t  bi phi ,t  ci  i  t  1,

, T (18)

Destaca-se que as restrições (5) acoplam as decisões de curto com as de médio_prazo. Essa é uma
diferença importante entre o modelo proposto e aquele adotado pelo setor_elétrico brasileiro. No modelo do setor, esse acoplamento é feito por meio da
minimização da função de custo esperado futuro
(CEPEL, 2004). Em um mercado para o dia seguinte,
como o proposto neste trabalho, a minimização do
custo futuro não se mostra adequada. É mais interessante desagregar as metas energéticas calculadas
pelo planejamento de médio_prazo em base horária.
Esta estratégia já foi amplamente estudada em Pereira e Pinto (1982 1983) e por Encina et al., (2002
2008), ambos com bons resultados.
Através das restrições (5) os riscos de déficit de
energia são intrinsecamente mitigados, pois as metas
energéticas já foram verificadas, quanto ao risco, nos
estudos de médio_prazo. Ou seja, não existe o risco
de se gastar mais energia do que foi previsto por tais
estudos. Além disso, as restrições (5) evitam a utilização dos mecanismos de realocação de energia
(MRE), visto que o montante de energia que cada
usina deve gerar durante o dia já está préestabelecido. Assim, não há o risco de uma usina
ficar desprivilegiada em função de sua posição na
cascata hidráulica. O MRE tem sido questionado por
concessionárias de energia por suas características
discriminatórias na alocação dos recursos de geração
(Nasser et al., 2001).
As restrições (5) possuem a vantagem adicional,
de facilitar a decomposição do problema nas variáveis elétricas e hidráulicas. Essa estrutura será explorada na seção 3.1 para tornar a solução do problema
computacionalmente muito mais simples. A decomposição do problema é muito importante, pois possibilita tratar as não_linearidades na função objetivo e
restrições de forma muito mais eficiente.
As restrições (6) e (7) permitem que os despachos dos mercados pool e bilateral sejam tratados em
um único problema de otimização, descrito pelo
PDHC. O termo combinado do PDHC foi retirado
de Galiana et al. (2002). Naquele trabalho, os autores
propõem a representação dos mercados bilateral e
pool de forma combinada em um único problema de
despacho para sistemas puramente termelétricos. No
ISBN 978-85-8001-069-5

trabalho aqui proposto, essa idéia foi adaptada para
sistemas hidrotérmicos. As restrições (6) e (7) explicitam as inter-relações entre os despachos dos mercados pool e bilateral. Por exemplo, pode-se estudar,
através dessas restrições, o impacto nos preços spot
quando os contratos bilaterais aumentam gradativamente.
3 Metodologia de Solução Proposta
A metodologia de solução proposta consiste na
decomposição do problema de modo que as variáveis
elétricas e hidráulicas sejam desacopladas em dois
subproblemas, resolvidos de forma individualizada,
conforme descrito a seguir.
3.1 Técnica de Decomposição
Na decomposição proposta para a solução do
problema de PDHC, supõe-se que o conjunto de restrições (8) a (15), aqui denominado de subsistema
hidráulico, seja inicialmente relaxado. O subproblema resultante da relaxação do subsistema hidráulico
é aqui denominado de Pré-Despacho Combinado
poolbilateral (PDC). A solução deste problema fornece o despacho_hidrotérmico ótimo de geração.
INÍCIO

PDC

PoolBilateral

Simulação Hidráulica

Novos limites de geração

sim

Subsistema
hidráulico
violado?

não
FIM

Fig. 1. Abordagem de decomposição adotada para a solução do
PDHC. O problema é decomposto nos subproblemas de PDC
poolbilateral e de simulação hidráulica.

O despacho_ótimo calculado pelo PDC é submetido a um processo de simulação hidráulica, conforme mostrado na Fig 1. O processo de simulação adotado é detalhado em (Cicogna et al., 2009). Se o simulador encontrar infactibilidade no subsistema hidráulico, a restrição violada é fixada no seu valor
máximo e os limites de geração são recalculados,
com base na função de produção (11), de modo a
atender esta restrição. O processo é repetido até que
não haja mais violações no subsistema hidráulico.
A freqência de aparecimento de violações de
restrições do subsistema hidráulico depende da compatibilidade entre duas grandezas sujeitas a incertezas as metas energéticas e a previsão de vazões incrementais aos reservatórios. A simulação hidráulica
permite confrontar a programação de geração com a
disponibilidade prevista de afluências, somando-se a

810

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

este processo o estado inicial, a faixa operativa dos
reservatórios e as demais restrições operativas. Isso
torna a solução muito atrativa para a operação das
usinas.
O subproblema de PDC é quadrático, portanto,
possui solução ótima global. Este problema é aqui
resolvido utilizando-se o método_de_pontos_interiores
primal-dual barreira logarítmica (MPI) (Wright,
1997). Os detalhes da aplicação do MPI  solução do
PDC são descritos em (Vergílio, 2011).

rios de afluências - PMO de março de 2010 (revisão
da semana 3). Os reservatórios foram considerados
com 95 da capacidade máxima. As metas energéticas, dadas em MW, na Tabela 1 foram fixadas como
sendo 80 da capacidade máxima das usinas para o
período. Os dados de demanda horária, em MW, são
mostrados na Tabela 2.
Tabela 1  Metas Energéticas
Usina
Jurumirim (H1)
Piraju (H2)
Chavantes (H3)
Ourinhos (H4)
L. N. Garcez (H5)

3.2 Cálculo do preço spot
Os preços spot prct  t  1, , T são parâmetros de
entrada do PDC, necessários ao cálculo de (17). Por
outro lado, mostra-se em (Vergílio, 2011) que se
adotarmos a definição de preço da teoria marginalista
(Schweppe et al, 1988), os preços spot devem igualar
os respectivos valores dos multiplicadores ótimos
t*  t  1, , T , associados s restrições (2), obtidos
na solução do PDC. Assim, os preços spot dependem
da solução do PDC, o qual, por sua vez, depende dos
preços spot. Essa circularidade pode ser resolvida,
conforme mostrado na Fig. 2, onde valores iniciais
prcinicial são fixados para os preços, os quais são
atualizados de forma recursiva, fazendo-se
prct  t*  t  1, , T , até que o processo se estabilize com uma determinada precisão  .
k 1

prct   0
k
prct   prcinicial
k 1

prct   prct
k

k 1

 ?

k 

prct

 

*
t

Resolve
k
PDC prct 





0400 0500 0600 0700 0800
1782 1755 1809 1836 1863
1600 1700 1800 1900 2000
2057 2079 2214 2700 2592

O modelo de PDHC proposto neste trabalho é
avaliado para dois sistemas o sistema_teste, cujos
casos são estudados na seção 4.1 e o sistema
interligado nacional (SIN), cujos casos são estudados
na seção 4.2.
4.1 Resultados com Sistema-Teste
O sistema_teste aqui estudado abrange 10 hidrelétricas da cascata do rio Paranapanema, e 3 termoelétricas. Os dados de vazão foram retirados do relatório do ONS de previsão de vazões e geração de cená-

1000
2079
2200
2322

1100
2133
2300
2187

1200
2106
0000
2025

Tabela 3  Dados da curva de custo dos lances das termelétricas
Usina j

Pjmin

Pjmax

aj

1
2
3

15
16
12

150
160
120

0,2
0,1
0,2

bj

cj

21 180
25 120
35 100

Os dados das usinas hidrelétricas relacionados
ao primeiro intervalo de tempo (situação inicial) são
fornecidos na Tabela 4, onde se mostram a vazão
afluente ui , a cota de montante hmi e o volume inicial xi do reservatório i .

fim

4 Resultados

0900
1998
2100
2457

ao lance do gerador j , conforme (16).

k

Fig. 2. Processo recursivo para a obtenção dos preços spot do pool.

ISBN 978-85-8001-069-5

0300
1809
1500
2060

A curva de custo dos lances das termelétricas é
fornecida na Tabela 3, onde a j , b j , c j correspondem

sim

k  k 1

Meta
1533,6
1715,5
12313,0
10385,0
7341,6

Tabela 2  Perfil diário de demanda
0100 0200
1971 1863
1300 1400
2079 2066

(t  1) da usinas hidráulicas

Tabela 4  Situação inicial

prct   prct

não

Meta
Usina
1916,6 Canoas II (H6)
1721,1 Canoas I (H7)
8281,1 Capivara (H8)
858,8 Taquaruçu (H9)
1577,1 Rosana (H10)



3

Usina

ui m s

Jurumirim
Piraju
Chavantes
Ourinhos
L. N. Garcez
Canoas II
Canoas I
Capivara
Taquaruçu
Rosana

434
442
565
800
773
791
824
1811
1894
2050



 

hmi  m

xi,0 hm3

567,59
531,92
473,56
398,3
384,5
365,95
351,05
333,35
283,9
257,9

6828,9
112,78
8615
22,15
42,166
144,56
208,48
10154
669,4
1887,3

Os limites nas cotas de montante e volume, bem
como os polinômios cota de montante x volume e
cota do canal de fuga x defluência são retirados dos
dados do PMO de março de 2010. Na Tabela 7 mostram-se os dados das curvas de perdas hidráulicas
(18), bem como e os limites mínimos e máximos das
usinas hidráulicas.
Tabela 7  Dados das curvas de perdas hidráulicas e limites mínimos e máximos de geração
Usina i
Jurumirim
Piraju
Chavantes
Ourinhos
L. N. Garcez
Canoas II
Canoas I
Capivara
Taquaruçu
Rosana

Pimin
14,000
24,525
30,000
2,000
2,000
3,000
4,000
50,000
30,000
10,000

Pimax
102,200
91,233
440,000
51,000
88,000
84,000
93,000
664,000
575,000
440,000

ai

bi

0,001190
0,003509
0,000154
0,007497
0,002545
0,001643
0,001120
0,000145
0,000245
0,001027

-0,098270
-0,358540
-0,052390
-0,150740
-0,113070
-0,065160
-0,048320
-0,066830
-0,051340
-0,190380

ci
2,057500
8,883700
6,274300
0,788280
1,047700
0,666500
0,560760
13,637200
3,027500
8,087800

811

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

4.1.1 Caso Base
A partir dos dados da seção anterior, resolveu-se
o PDHC para o sistema_teste, utilizando a metodologia de solução descrita na seção 3. No caso base, os
contratos bilaterais não foram inseridos. Assim, todo
o despacho foi fechado somente no pool. Além disso, o subsistema hidráulico foi desprezado para o
caso base. Os impactos dos contratos bilaterais e do
subsistema hidráulico são estudados em casos subseqentes. O despacho obtido, em MW, para o caso
base é mostrado na Tabela 8, em que as termelétricas
são apresentadas pelas siglas T1,T2, , etc. e as hidrelétricas por H1,H2, ,etc. A correlação entre as
siglas e os nomes das usinas é mostrada na Tabela 1.
Nota-se que a soma de cada linha da Tabela 8 iguala
a respectiva demanda, conforme restrição (2). Notase ainda que, a soma das colunas relacionadas s
hidrelétricas iguala a meta energética, conforme restrição (5). Nota-se que o PDHC despacha a maior
parte da geração nas hidrelétricas, que possuem custo
de operação menor, conforme esperado.
Tabela 8  Despacho de geração para o caso base
t
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24

T1
21,9
20,5
19,8
19,5
19,1
19,8
20,2
20,5
22,3
23,3
24,1
23,7
23,3
23,2
23,1
23,1
23,3
25,2
42,1
33,2
29,0
26,7
24,8
22,6

T2
47,6
42,0
39,3
37,9
36,5
39,3
40,7
42,0
49,1
53,4
56,3
54,8
53,4
52,6
52,4
52,2
53,4
60,7
128,2
92,6
76,0
66,6
59,2
50,5

T3
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0
12,0

H1
75,8
71,8
69,8
68,9
67,9
69,8
70,8
71,8
76,8
79,8
81,8
80,8
79,8
79,3
79,1
79,0
79,8
84,7
102,2
102,2
94,7
88,7
83,7
77,8

H2
70,0
68,7
68,0
67,7
67,3
68,0
68,3
68,7
70,3
71,3
72,0
71,7
71,3
71,2
71,1
71,1
71,3
73,0
86,4
79,8
76,3
74,3
72,7
70,7

H3
321,9
291,1
275,6
267,9
260,2
275,6
283,4
291,1
329,7
352,8
368,2
360,5
352,8
348,9
347,4
346,6
352,8
391,3
440,0
440,0
440,0
422,2
383,6
337,4

H4
35,1
34,6
34,3
34,1
34,0
34,3
34,4
34,6
35,2
35,6
35,9
35,8
35,6
35,6
35,6
35,5
35,6
36,3
41,6
39,0
37,7
36,9
36,2
35,4

H5
63,4
61,6
60,8
60,3
59,9
60,8
61,2
61,6
63,9
65,2
66,1
65,7
65,2
65,0
64,9
64,9
65,2
67,4
85,3
76,4
71,9
69,2
67,0
64,3

H6
60,7
57,9
56,5
55,8
55,0
56,5
57,2
57,9
61,5
63,6
65,0
64,3
63,6
63,2
63,1
63,0
63,6
67,1
84,0
81,5
74,2
69,9
66,4
62,2

H7
67,4
63,2
61,1
60,0
59,0
61,1
62,1
63,2
68,4
71,6
73,7
72,6
71,6
71,1
70,8
70,7
71,6
76,8
93,0
93,0
87,3
81,0
75,8
69,5

H8
482,6
450,0
433,6
425,5
417,3
433,6
441,8
450,0
490,8
515,3
531,6
523,4
515,3
511,2
509,6
508,8
515,3
556,0
664,0
664,0
638,0
588,6
547,9
499,0

H9
411,3
392,3
382,8
378,0
373,2
382,8
387,5
392,3
416,0
430,2
439,7
434,9
430,2
427,8
426,9
426,4
430,2
453,8
575,0
550,0
501,2
472,7
449,1
420,7

H10
301,2
297,4
295,5
294,5
293,5
295,5
296,4
297,4
302,1
304,9
306,8
305,9
304,9
304,5
304,3
304,2
304,9
309,6
346,2
328,3
318,9
313,3
308,7
303,1

Os preços spot hora-a-hora são mostrados na
Tabela 9. Nota-se a tendência de aumento de preços
 medida que a demanda aumenta no decorrer do dia,
conforme esperado.
Tabela 9  Preços spot calculados para o caso base
0100
29,8
1300
30,3

0200
29,2
1400
30,3

0300
28,9
1500
30,2

0400
28,8
1600
30,2

0500
28,7
1700
30,3

0600
28,9
1800
31,1

0700
29,1
1900
37,8

0800
29,2
2000
34,3

0900
29,9
2100
32,6

1000
30,3
2200
31,7

1100
30,6
2300
30,9

1200
30,5
0000
30,0

4.1.2 Caso 1  Alterações em Metas Energéticas
Neste caso, estuda-se o comportamento dos preços quando da ocorrência de alterações nas metas
energéticas. Para isso, as metas foram reduzidas para
70 da capacidade máxima das usinas, refletindo
uma situação em que há menor disponibilidade hídrica futura no sistema. Os preços decorrentes dessas
alterações, mostrados na Tabela 10, sofreram aumen-

ISBN 978-85-8001-069-5

tos em todos os intervalos. Conforme esperado, a
redução da fração da demanda atendida pelas hidráulicas requer um redespacho por meio do aumento da
complementação térmica, o que eleva os preços spot
do sistema. Essa correlação direta e coerente entre a
disponibilidade futura de recursos hídricos e os preços é uma das boas características do modelo, a qual
s vezes não tem sido captada pelo modelo atualmente utilizado pelo setor_elétrico brasileiro.
Tabela 10  Preços spot caso 1. Redução na meta das usinas para
70 da capacidade máxima
0100
55,6
1300
56,6

0200
54,5
1400
56,5

0300
54,0
1500
56,4

0400
53,7
1600
56,4

0500
53,5
1700
56,6

0600
54,0
1800
58

0700
54,3
1900
63,9

0800
54,5
2000
62,2

0900
55,8
2100
60,5

1000
56,6
2200
59,1

1100
57,2
2300
57,7

1200
56,9
0000
56,1

4.1.3 Caso 2  Introdução de Contratos Bilaterais
Neste caso estuda-se o comportamento dos preços quando da introdução dos contratos bilaterais
horários (dados em MW) mostrados na Tabela 11
para cada intervalo de tempo.
Tabela 11  Contratos bilaterais estabelecidos pelos agentes geradores em cada intervalo
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24

T1
31,0
29,0
28,0
28,0
27,0
28,0
29,0
29,0
31,0
32,0
33,0
33,0
32,0
32,0
32,0
32,0
32,0
34,0
42,0
40,0
38,0
36,0
34,0
32,0

T2
33,0
31,0
30,0
30,0
29,0
30,0
30,0
31,0
33,0
34,0
35,0
35,0
34,0
34,0
34,0
34,0
34,0
37,0
45,0
43,0
41,0
39,0
36,0
34,0

T3
25,0
23,0
23,0
22,0
22,0
23,0
23,0
23,0
25,0
26,0
27,0
26,0
26,0
26,0
26,0
26,0
26,0
28,0
34,0
32,0
31,0
29,0
27,0
25,0

H1
23,0
22,0
21,0
21,0
21,0
21,0
22,0
22,0
23,0
24,0
25,0
25,0
24,0
24,0
24,0
24,0
24,0
26,0
32,0
30,0
29,0
27,0
26,0
24,0

H2
28,0
26,0
25,0
25,0
25,0
25,0
26,0
26,0
28,0
29,0
30,0
30,0
29,0
29,0
29,0
29,0
29,0
31,0
38,0
36,0
34,0
33,0
31,0
28,0

H3
82,0
77,0
75,0
74,0
73,0
75,0
76,0
77,0
83,0
86,0
88,0
87,0
86,0
86,0
85,0
85,0
86,0
92,0
112,0
108,0
102,0
96,0
91,0
84,0

H4
9,0
8,0
8,0
8,0
8,0
8,0
8,0
8,0
9,0
9,0
9,0
9,0
9,0
9,0
9,0
9,0
9,0
10,0
12,0
11,0
11,0
10,0
10,0
9,0

H5
14,0
13,0
13,0
13,0
12,0
13,0
13,0
13,0
14,0
15,0
15,0
15,0
15,0
15,0
15,0
15,0
15,0
16,0
19,0
18,0
17,0
17,0
16,0
14,0

H6
14,0
13,0
13,0
13,0
12,0
13,0
13,0
13,0
14,0
15,0
15,0
15,0
15,0
15,0
15,0
15,0
15,0
16,0
19,0
18,0
17,0
17,0
16,0
14,0

H7
16,0
15,0
15,0
14,0
14,0
15,0
15,0
15,0
16,0
17,0
17,0
17,0
17,0
17,0
17,0
17,0
17,0
18,0
22,0
21,0
20,0
19,0
18,0
16,0

H8
126,0
119,0
116,0
114,0
112,0
116,0
118,0
119,0
128,0
133,0
137,0
135,0
133,0
132,0
132,0
132,0
133,0
142,0
173,0
166,0
157,0
149,0
140,0
130,0

H9
101,0
96,0
93,0
92,0
90,0
93,0
95,0
96,0
103,0
107,0
110,0
108,0
107,0
106,0
106,0
106,0
107,0
114,0
139,0
133,0
126,0
120,0
113,0
104,0

H10
23,0
22,0
21,0
21,0
21,0
21,0
22,0
22,0
23,0
24,0
25,0
25,0
24,0
24,0
24,0
24,0
24,0
26,0
32,0
30,0
29,0
27,0
26,0
24,0

Com a introdução dos contratos, os despachos
foram alterados, evidenciando a inter-relação entre
os mercados bilateral e pool. Os preços spot também
foram alterados em relação ao caso base, conforme
mostrado na Tabela 12.
Tabela 12  Preços spot calculados para o caso introdução de
contratos bilaterais mostrados na Tabela 11.
0100
28,81
1300
29,40

0200
28,27
1400
29,34

0300
28,00
1500
29,31

0400
27,86
1600
29,30

0500
27,72
1700
29,40

0600
28,00
1800
30,11

0700
28,13
1900
36,81

0800
28,26
2000
33,25

0900
28,94
2100
31,60

1000
29,21
2200
30,69

1100
29,68
2300
29,97

1200
29,55
0000
29,13

Sempre que as restrições de contratos bilaterais estiverem ativas na solução ótima, como neste caso, tanto o despacho quanto os preços spot serão impactados pelos contratos. Se compararmos essa solução
com o case base, verifica-se que a introdução dos
contratos elevou o custo total de produção de

812

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

160.337,162 para 160.493,14, o que era esperado,
já que o espaço de otimização foi reduzido em função das restrições ativas de contratos bilaterais. Por
outro lado, houve uma diminuição nos preços spot.
Isto ocorre pois a energia despachada no bilateral é
retirada da demanda do mercado pool. Com uma
demanda menor, a média dos preços tende a reduzir.
4.1.4 Caso 3  Caso sem Simulação Hidráulica
Nesta seção mostra-se o impacto subsistema hidráulico, definido pelas restrições (8) a (15), nos
preços spot do sistema. Para isso, a solução obtida no
caso base foi submetida ao simulador hidráulico,
conforme mostrado na Fig. 1. Os preços calculados
quando as restrições do subsistema hidráulico se
tornaram factíveis são mostrados na Tabela 13.
Tabela 13  Preços spot calculados para o caso 3 - Introdução das
restrições hidráulicas através do simulador
0100
28,69
1300
29,25

0200
28,16
1400
29,18

0300
27,89
1500
29,15

0400
27,75
1600
29,14

0500
27,62
1700
29,25

0600
27,89
1800
30,00

0700
28,02
1900
58,57

0800
28,16
2000
42,15

0900
28,83
2100
34,30

1000
29,25
2200
30,98

1100
29,53
2300
29,82

1200
29,39
0000
28,97

Percebe-se que há um aumento no preço da energia em horários de pico, o qual está relacionado 
necessidade de satisfazer as restrições hidráulicas.
Nesses horários, a disponibilidade de água é menor,
o que acarreta uma diminuição da geração hidráulica,
e conseqente aumento da geração_térmica, mais
cara.
4.2 Sistema Interligado Nacional - SIN

4.2.1Caso SIN Base
Neste caso são feitos estudos de PDHC para o
SIN. Os parâmetros do modelo foram estabelecidos
por meio de heurísticas envolvendo dados oficiais
fornecidos pela CCEE, ONS, e dados fornecidos
pelo programa HydroExpert, disponível no site
www.hydrobyte.com.br. Para esse caso, os preços
são mostrados na Tabela 14.
Tabela 14  Preços spot calculados para o caso base do SIN.
0200
27,51
1400
27,82

0300
27,42
1500
27,81

0400
27,37
1600
27,81

0500
27,32
1700
27,83

0600
27,42
1800
28,02

0700
27,47
1900
28,99

0800
27,51
2000
28,74

0900
27,73
2100
28,48

1000
27,83
2200
28,22

1100
27,91
2300
27,98

1200
27,87
0000
27,77

4.2.2. Caso SIN 1- Alterações nas Metas Energéticas
Nesta seção são estudadas alterações nas metas
energéticas. Para isso, simulou-se a redução de 10

ISBN 978-85-8001-069-5

Tabela 15  Preços spot calculados para o caso SIN  redução de
10 nas metas.
0100
29,44
1300
29,59

0200
29,24
1400
29,58

0300
29,15
1500
29,57

0400
29,09
1600
29,56

0500
29,03
1700
29,59

0600
29,15
1800
29,78

0700
29,19
1900
30,76

0800
29,24
2000
30,52

0900
29,48
2100
30,24

1000
29,59
2200
29,96

1100
29,66
2300
29,74

1200
29,63
0000
29,52

4.2.3 Caso SIN 2-Alterações em Contratos Bilaterais
No segundo caso, estabeleceu-se um novo perfil
de contratos para a termelétrica equivalente. Esse
perfil foi estabelecido de modo que algumas das restrições de contratos bilaterais ficassem ativas. Os
preços spot para esse caso são mostrados na Tabela
16. Também de forma análoga ao estudo com o sistema_teste, houve diminuição nos preços spot, aumento na complementação térmica com conseqente
aumento dos custos totais, que foram de 
7.544.788,907 para  7.546.054,525.
Tabela 16  Preços spot calculados para o SIN  alteração na
matriz de contratos.
0100
27,53
1300
27,66

0200
27,35
1400
27,65

0300
27,26
1500
27,64

0400
27,21
1600
27,63

0500
27,17
1700
27,66

0600
27,26
1800
27,59

0700
27,30
1900
28,59

0800
27,35
2000
28,34

0900
27,56
2100
28,32

1000
27,66
2200
28,06

1100
27,74
2300
27,80

1200
27,70
0000
27,60

5 Conclusão

Nesta seção são feitos estudos com uma versão
do SIN, envolvendo 131 usinas hidráulicas e 1 termelétrica equivalente. O modelo foi implementado
em um processador Intel Core i5 750 2.66 GHz, com
memória RAM de 4 GB DDR3 1333MHz, com sistema operacional Windows 7 Professional 64bits, e
linguagem Matlab R2010a 64bits. Com essa configuração, o problema tem sido resolvido em tempos
computacionais de aproximadamente 2 minutos para
o SIN, o que mostra a viabilidade do PDHC para a
formação de preços de sistemas hidrotérmicos para
mercados do dia seguinte.

0100
27,69
1300
27,83

no valor das metas do caso base. Os preços spot são
mostrados na Tabela 15. De modo análogo ao que
aconteceu no sistema_teste, a diminuição nas metas
energética implicou em uma maior complementação
térmica, o que elevou os preços spot, conforme esperado.

Este trabalho propõe um modelo de pré-despacho
hidrotérmico combinado poolbilateral (PDHC) para
a formação de preços spot em mercados_de_energia
do dia seguinte. O Brasil não possui ainda um mercado nessas bases. Assim, o presente investiga a
viabilidade técnica desse tipo de mercado, e busca
mostrar suas possibilidades e dificuldades. O PDHC
introduz aspectos de modelagem que têm sido
desprezados na abordagem adotada no Brasil, tais
como i) os recursos de geração hidráulicos são otimizados ii) a abordagem híbrida poolbilateral é
resolvida por meio de um único problema de otimização (PDHC), evitando ineficiências econômicas
na coordenação dos mercados poolbilateral iii) os
riscos de déficit de energia são intrinsecamente mitigados na solução do PDHC iv) não há necessidade de mecanismos de realocação de energia os
geradores recebem pelo que de fato geram nos mercados v) a metodologia de decomposição adotada
reduz consideravelmente os tempos computacionais
para a solução de sistemas reais. Os resultados envolvendo alterações em vários parâmetros destacam
a consistênciacoerência do modelo proposto. Mostra-se a correlação entre preços spot e variações na
demanda, nas metas energéticas e a influência dos
contratos bilaterais e das restrições hidráulicas nos
preços spot. Esta consistênciacoerência se confirmou em ambos os sistemas estudados sistema_teste

813

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

e SIN. Assim, o PD proposto dá um passo no sentido de mostrar que é tecnicamente viável a existência
de um mercado do dia seguinte no Brasil.
Agradecimentos
Os autores agradecem  FAPESP e ao CNPq por
auxílios concedidos nos processos (200802315-0),
(4812342007-1) e (3085312009-4).
Referências Bibliográficas
CEPEL, (2004). Manual de Referência  Modelo
DECOMP (versão 12.0). Relatório Técnico,
CEPEL, Rio de Janeiro, RJ.
Cheng, J. W. M. Galiana, F. D., McGillis, D. T.
(1998) Studies of bilateral contracts with respect to steady state security in a deregulated environment, IEEE Trans. Power Syst., vol. 13,
pp. 10201025.
Cicogna, M. A. Fontane, D. G. Hidalgo, I. G.
Lopes, J. E. G. (2009) Multireservoir Simulation Using Multipurpose Constraints and ObjectOriented Software Design. Proceedings of the
ASCE - World Environmental  Water Resources Congress (EWRI). pp. 5030-5040.
Cicogna, M. A. (1999) Modelo de Planejamento da
Operação Energética de Sistemas Hidrotérmicos
a Usinas Individualizadas Orientado por Objeto, dissertação de mestrado, FEEC-UNICAMP.
Contreras, J. Candiles, O. Fuente, J. I. Gómez, T.
(2001). Auction Design in Day-Ahead Electricity Markets, IEEE Transactions on Power
Systems, vol. 16, no. 3.
David, A. K. (1998) Reconciling pool and contract
dispatch in open acess transmission operations,
Proc. Inst. Elect. Eng., Generation, Transm. Distrib., vol. 145, no. 4, pp. 468472.
Encina, A. S. A Ohishi, T Soares, S. (2002). Optimal Dispatch Generating Units of the Itaipu
Hydroelectric Plant. IEEE Transactions on
Power Systems, v. 17, pp. 154-157.

Nasser, I. C. Carvalho, L. C. X. Negri, J. C. Barillari, S. N. Zuculin, S. (2001). Regras de Mercado Um Estudo de Caso Sobre o Impacto do
Mecanismo de Realocação de Energia  MRE,
Seminário Nacional de Produção e Transmissão
de Energia Elétrica - SNPTEE.
Oliveira, A. R. L. Soares, S. Nepomuceno, L.
(2003), Optimal Active Power Dispatch Combining Network Flow and Interior Point Approaches, IEEE Transactions on Power Systems, vol. 18, no. 4, pp 1235-1240.
Pereira, M. V. F. Pinto, L. M. V. G (1982). A decomposition approach to the economic dispatch
of hydrothermal system. IEEE Transactions on
Power Apparatus and Systems, vol. PAS-101,
no. 10, pp. 3851-3860.
Pereira, M. V. F. Pinto, L. M. V. G (1983). Application of decomposition techniques to the midand short - term scheduling of hydrothermal systems. IEEE Transactions on Power Apparatus
and Systems, vol. PAS-102, no. 11, pp. 36113618.
Shahidehpour, M Yamin, H. Li, Z. (2002). Market
Operations in Electric Power Systems. New
York, John Wiley  Sons Inc.
Schweppe, F. C. Caramanis, M. C. Tabors, R. D.
Bohn, R. E. (1988). Spot Pricing of Electricity.
Boston, MA Kluwer.
Soares, S. Salmazo, C. T. (1997). Minimum Loss
Predispatch Model for Hydroelectric Power Systems, IEEE Transactions on Power Systems,
vol. 12, no. 3, pp. 1220  1228.
Vergílio, A. H. (2011). Estudos de Simulação Hidráulica de Curto Prazo Para Validação de Soluções de Modelos de Pré-Despacho de Geração.
dissertação de mestrado, UNESP-Bauru.
Wright, S. J., (1997). Primal-Dual Interior-Point Methods. Society for Industrial and Applied Mathematics. SIAM.

Encina, A. S. A. Soares, S. Ohishi, T. Cicogna, M.
A. (2008). Unit Commitment of Hydro Dominated Systems. International Journal of Emerging Electric Power Systems, v. 9, pp. 4.
Galiana, F. D. Kockar, I. Franco, P. C. (2002).
Combined PoolBilateral Dispatch - Part I Performance of Trading Strategies, IEEE Transactions on Power Systems, vol. 17 no. 1, pp. 92-99.
Jia, S. (1998) A study of the England and Wales
power pool, M. Eng. thesis, Dept. Elect. Comput. Eng., McGill Univ., Montreal, QC, Canada.

ISBN 978-85-8001-069-5

814