XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

TOWARDS A COMPRESSIVE SENSING-BASED SSVEP-BCI
Richard J. M. G. Tello, Jeevan K. Pant, Sridhar Krishnan, Teodiano F. Bastos




Coordination of Industrial Automation and Control Engineering,
Federal Institute of Espirito Santo (IFES) - Campus Serra,
Rodovia ES 010, Km 6.5, Manguinhos, CEP 29173-087,
Serra, ES, Brasil

Department of Electrical and Computer Engineering, Ryerson University,
350 Victoria St, Toronto, M5B 2K3,
Toronto, ON, Canada


Post-Graduate Program in Electrical Engineering (PPGEE),
Federal University of Espirito Santo (UFES),
Av. Fernando Ferrari 514, Goiabeiras,
Vitoria, ES, Brazil

Emails richard@ifes.edu.br, jeevan1.pant@ryerson.ca, krishnan@ee.ryerson.ca,
teodiano.bastos@ufes.br
Abstract In this research, a study of SSVEP frequency detection is carried out for its application in compressive sensing (CS)-based brain-computer interface (BCI). The CS-BCI system is based on compressing electroencephalogram (EEG) signals using random projection, transmitting the compressed data using wireless method,
and reconstructing EEG signals from the received data using a CS-reconstruction algorithm. Minimum Energy
Combination (MEC), Canonical Correlation Analysis (CCA) and Multivariate Synchronization Index (MSI) algorithms are applied for the detection of visual stimulus frequency from the reconstructed EEG signals. For
2d
CS-reconstruction, the dp -regularized least-squares (dp  RLS), 2d
p -regularized least-squares (p  RLS), and the
block-sparse Bayesian learning bound-optimization (BSBL  BO) algorithms are applied. Results of simulation
conducted using EEG signals acquired by using Emotiv headset indicate that the MSI algorithm offers the highest
mean classification accuracy (CA), whereas the CCA algorithm offers the most stable CA. Also, the dp  RLS
algorithm is found to balance the trade-off between the high mean value of CA offered by the BSBL  BO
algorithm and the most stable value of CA offered by the 2d
p  RLS algorithm.
Keywords

Compressive Sensing, SSVEP-BCI, CCA, MSI, MEC.

Resumo No presente trabalho, um estudo relacionado a deteccao de frequencias atraves de potencias visualmente evocados foi executado apos um processo de compressao usando a teoria denominada Compressive Sensing
(CS). Para este estudo, a teoria de CS foi aplicada a Interfaces Cerebro Computador (BCI). O sistema de CS-BCI
implementado utiliza sinais de Eletroencefalografia (EEG) processadas atraves de projecoes randomicas. Apos
este processo, os dados foram transmitidos sem fio e reconstrudos atraves de algoritmos de reconstrucao de
CS. Os algoritmos de extracao_de_caractersticas, tais como Energia Mnima de Combinacao (EMC), Analise
de Correlacao Canonica (CCA) e Indice de Sincronizacao Multivariavel (MSI), foram aplicados na deteccao das
frequencias a partir dos sinais de EEG reconstrudas. Na etapa de reconstrucao foram aplicados os seguintes
2d
algoritmos dp -mnimos_quadrados regularizados (dp  RLS), 2d
p -mnimos_quadrados regularizados (p  RLS)
e Aprendizagem Bayesiana ligada a otimizacao por bloco-dispersao (BSBL  BO). Os resultados de simulacao,
a partir dos sinais de EEG coletados pelo dispositivo sem fio Emotiv-Epoc, mostram que o algoritmo de MSI
oferece as mais altas taxas de precisao. Por outra parte, o algoritmo de CCA mostrou os resultados mais estaveis.
Finalmente, o algoritmo dp  RLS apresentou um resultado medio que equilibra os altos valores oferecidos pelo
algoritmo BSBL  BO e o valor mais estavel de classificacao resultante do algoritmo 2d
p -regularized least-squares
(2d
p  RLS).
Palavras-chave

.

Introduction

In a BCI based on Steady-State Visual Evoked
Potentials (SSVEPs), suitable commands to control machine functions are generated by focusing
gaze on one of several stimuli flickering with different frequencies. Therefore, when the eye retina
is excited by a stimulus at a certain frequency,
the brain generates an electrical activity of the
same frequency with its harmonics. This traditional SSVEP-BCI, also widely named as dependent SSVEP-BCI, might not be applicable for
patients with ocular motor impairments or se-

ISSN 2525-8311

vere neuromuscular problems. Nonetheless, independent SSVEP-BCIs can address this problem through the power of the attention in flickering targets and the human visual selectivity
in spaces reduced (Details about definitions of
an Independent SSVEP-BCI can be reviewed in
(Tello et al., 2016)). The effects of spatial attention on SSVEP were studied initially in (Morgan
et al., 1996). In the work performed by (Kelly
et al., 2004), it was shown that there was a reduction in 20 of precision when a volunteer did
not perform eye movements compared to another
who did it. In (Kelly et al., 2005), something

967

XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

similar was performed using flickering letters in
a CRT monitor. Six out of eleven physically and
neurologically healthy subjects demonstrate reliable control in binary decision-making, achieving
at least 75 of correct selections. Several attempts have been made to understand more about
SSVEPs, which is discussed in (Tello et al., 2014).
SSVEP-BCI sensors are desired to be comfortable and portable (Hairston et al., 2014). The
conductive AgAgCl gel-based electrodes, which
are popular in wired BCI systems, could be replaced by wireless acquisition devices with salinebased wet-contact resistive electrodes or dry active electrodes. On the other hand, Compressive
Sensing (CS) is emerging as a promising technique for the development of low-power, smallchip, and robust wireless BCI sensors (Pant and
Krishnan, 2014 Zhang et al., 2013). It is shown
that the use of a sparse measurement matrix and a
reconstruction algorithm based on promoting temporal correlation can offer improved reconstruction performance for CS of certain physiological
signals. In (Tello, Pant, Muller, Krishnan and
Bastos-Filho, 2015), we applied CS on the EEG
database obtained by using BrainNet-36, which
acquires reliable EEG signals by using wired electrodes. It is found that the MSI algorithm can offer better performance relative to CCA algorithm.
In this study, it was carried out an analysis of
the MEC, CCA, and MSI algorithms, which are
popular for the detection of visual stimulus frequency in SSVEP-BCI systems, and the dp RLS,
2d
p  RLS, and BSBL  BO algorithms, which are
popular for the reconstruction of physiological signals, for a CS-based SSVEP-BCI system. Emotiv
Epoc, a comfortable and portable wireless EEG
sensing device, is used for the acquisition of EEG
signals from the occipital region of the brain. The
block diagram of the studied SSVEP-BCI system
is shown in Figure 1. The key blocks in Figure 1
are discussed below.

2

Wireless EEG Acquisition

Emotiv Epoc Headset is a wireless device used
for acquiring signal. EEG signals from occipital
O1 and O2 channels with 128 samples per second
of sampling rate (fs ) were collected. The sensors
used for reference are (i) Common-Mode Sensing
(CMS) and, (ii) Driven Right Leg (DRL) that are
fixed for default and in parallel to P3P4 channels
(the two mastoids), respectively.

3

Compression

CS used for signal compression, which involves
segmenting EEG signals into non-overlapping segments xi , and applying the operation

ISSN 2525-8311

y  x

(1)

where vector x of length N representing a signal and its measurement vector y of length M . 
is a sparse matrix of size M  N with 5 number of
unity valued nonzero components in each column,
where M  N .
4

Reconstruction

Signal reconstruction is carried out by using the
dp  RLS, 2d
p  RLS, and BSBL  BO algorithms (Pant and Krishnan, 2014 Pant and Krishnan, 2013 Zhang and Rao, 2013). The dp  RLS
and 2d
p  RLS algorithms are based on solving the
optimization problem
1
2
minimize x  y2 + f (x), with
x
2

(2)

the minimization of
xd

p

N
1
X



!1p
p

xn  xn+1 

and

(3)

n1

x2d

p



p

x1  x2  +

N
1
X

!1p
p

p

xn1  2xn + xn+1  + xn1  xn 

n1

(4)
respectively, with  > 0. The BSBL  BO
algorithm divides signal x in to signal blocks


, 



 


T , and sigx
1 x2 ,    , xs as x  x1 , x2 ,    , xs
nal x is estimated as

x

X
0

T (I + 

X
0

1

T )

y

(5)

P
where
0  diag1 B1 , 2 B2 ,    , s Bs 
and parameters i and Bi control block-sparsity
and correlation structure, respectively, see (Pant
and Krishnan, 2014) and (Zhang and Rao, 2013)
for details.
5

Minimum Energy Combination

MEC is a technique of finding combinations of
electrode signals that remove strong noise and nuisance signals from EEG data (Friman et al., 2007).
For SSVEP data stimulated by the frequency fi
(i represents the number of targets), the response
can be modeled by adding noise. X is the EEG
signal, and Yi is the reference signal. The signals
(from O1 and O2) are combined to extract the
discriminative features. This combination can be
achieved by linear transformation of X. The class
was determined through a criterion of maxima.
More details can be seen at (Tello et al., 2014).

968

XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

Compression

Reconstruction

MEC

l - RLS

MAX

Random Projection

Acquisition

Switch
selector

 8 Hz

 13 Hz

l - RLS

Temporal Filter

BSBL  BO

Output

Elliptic (3-50 Hz)

Emotiv Epoc

CCA
MAX
< 1
70 cm
Visual stimuli
through
SSVEP

8 Hz

MSI

13 Hz

MAX

LCD

Output

Output

Figure 1 Block diagram of the proposed SSVEP-BCI system.
6

Canonical Correlation Analysis

CCA is a widely used technique in the processing
of EEG signals based on the detection of SSVEP
components for multichannels (Lin et al., 2007).
Mathematically, this method assumes that X represents discrete-time signal segments, and Yi consists of simulated stimulus signals. Thus, a total
of H harmonic sine vectors and cosine vectors for
frequency fi , all of length L were modeled. We
have considered the fundamental frequency and
one harmonic as the simulated frequency generator, i. e. H  2. More details about this approach
is detailed in (Tello et al., 2014). Finally, the process of correlation of these signals is executed and
the classes obtained through a criterion of maxima.
7

Multivariate Synchronization Index

MSI is a method to estimate the synchronization
between the actual mixed signals and the reference
signals as a potential index for recognizing the
stimulus frequency. In (Zhang et al., 2014), the
use of a S-estimator as index is proposed, which is
based on the entropy of the normalized eigenvalues
of the correlation matrix of multivariate signals.
Autocorrelation matrices C11 and C22 for X and
Yi , respectively, and cross-correlation matrices
C12 and C21 were changed from the original version (Zhang et al., 2014) due to its inconsistency
in the dimensions of each component for the formation of the correlation matrix Ci (more details
are described on (Tello et al., 2014 Tello, Muller,
Ferreira and Bastos, 2015 Tello et al., 2016)). Finally, the class was obtained through a criterion
of maxima.

ISSN 2525-8311

C11  (1M ).XXT ,

(6)

C22  (1M ).Yi Yi T ,

(7)

C12  (1M ).XYi T ,

(8)

C21  (1M ).Yi XT ,

(9)

8

Visual Stimuli

Each volunteer was sitting in a comfortable chair,
in front of a 17-inch LCD monitor, and 70 cm
away from it. Two stimuli based on checkerboards
(44) were simultaneously presented in bilateral
way. These stimuli were generated by a subsystem based on FPGA (Field-Programmable Gate
Array) Xilinx Spartan 3E company. The stimuli
were placed by side along a horizontal line separated by a small distance (2cm) where the left
and right target were flickered at the rate of f1  8
Hz (left) and f2  13 Hz (right), respectively.
More details about the stimuli are shown in (Tello,
Pant, Muller, Krishnan and Bastos-Filho, 2015).
9

Subjects and Experimental Procedure

Three male subjects participated in the study
(Mean 29.7 and SD 0.58). The experiments
were performed in accordance with the rules of the
Ethics Committee of the Federal University of Espirito Santo (UFESBrazil), with the registration
No CEP-04808. During the first five seconds, a
fixed cross in the center of the screen is presented.
After finalizing the first five seconds, a beep indicates to the volunteer to fix hisher attention on
the left side of the stimulus for thirty seconds. At
the end of this time, the volunteer has five seconds
to take rest and another thirty seconds is asked to
pay attention in stimulating the right side. The
time of duration of the experiment is 70 seconds.
The eye movements are also monitored and there
has been suggested keep a maximum visual angle
of 1o for the stimulus selection.

969

XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

10

Experimental results

Initially, signals from O1 and O2 channels were extracted. Then, a compression stage of 75 of ratio
was applied. In brief words, the signals were transmitted and then reconstructed. Thus, a signalvector of length 42000 samples (70 seconds time
fs ) was divided into total 42 non-overlapping segments each of length Q  1000. A matrix w of size
Q  42 was constructed by including the 42 segments as its columns. One value of the number of
measurements was selected as P  250, which correspond to compression ratio (CR  75), where
CR was computed as (Q  P )  100Q. The
d
2d
p  RLS, p  RLS, and BSBL  BO algorithms
were applied to reconstruct signal segments from
each of the 42 columns of Yi . The 2d
p  RLS algorithm was applied with parameters p  1, T  30,
1  1, T  102 , 1  1, T  102 and
the BSBL  BO algorithm was applied with parameters such as in (Pant and Krishnan, 2014)
with the discrete-cosine transform basis. The segments were reconstructed by applying the three
algorithms and concatenated to construct three
reconstructed versions of the signal x. In the preprocessing stage, the data were segmented and
windowed with window lengths (WL) of 1 s and
4 s, each one with an overlap of 50. Then, a
temporal elliptic filter between 3-50 Hz was applied. The MEC, CCA and MSI techniques were
applied and the results were compared in terms
of performance. The comparison of performance
(mean and standard deviation) was tested in 50
repetitions of reconstructed EEG signals averaged
for the 3 subjects in different WL as shown in Fig
2. In addition, these results were also compared
with the original EEG signal for each case. A
summary of the results are shown in Table 1.
11

Conclusion and discussion

An analysis of the MEC, CCA, and MSI algorithms for the detection of visual stimulus frequency in SSVEP-BCI systems was carried out.
The analysis was done for the application in CSbased wireless BCI system. The dp -RLS, 2d
p -RLS,
and BSBL  BO algorithms were applied for the
reconstruction of signals from compressed data.
The MEC, CCA, and MSI algorithms were applied
for the detection of visual stimulus frequency from
reconstructed EEG signals. According to the obtained results, the MEC algorithm was found to
offer the better trade-off between the highest mean
value of CA offered by the MSI algorithm and the
lowest variance of the CA offered by the CCA algorithm (evidences that this modified version of
MSI show good results were also found in (Tello
et al., 2014 Tello, Bissoli, Ferrara, Muller, Ferreira and Bastos, 2015 Tello, Valadao and BastosFilho, 2015)). The dp  RLS algorithm was also

ISSN 2525-8311

found to balance the trade-off between the highest mean and lowest variance of CA offered by the
BSBL  BO algorithm and the lowest mean and
highest variance of CA offered by the 2d
p  RLS
algorithm. Also, the increase in the length of EEG
signal is found to increase not only the mean value
of CA but also the variance of CA.
Table 1 Summary results related to Mean () and
Variance() in 
WL
1s
MEC
CCA
MSI
1s
MEC
CCA
MSI

dp
56.96
50.79
55.51
8.28
1.99
5.52

2d
BSBL-BO
p
Mean ()
59.73
56.57
53.68
50.27
61.86
51.36
Variance ()
7.48
8.77
1.08
4.27
1.86
9.95

WL
4s
MEC
CCA
MSI
4s
MEC
CCA
MSI

dp
62.64
51.24
64.23
13.09
3.46
13.68

2d
BSBL-BO
p
Mean ()
65.31
61.16
55.21
50.64
69.90
54.26
Variance ()
11.97
12.43
2.22
7.20
5.47
13.89

Acknowledgements
The authors would like to thank CAPESBrazil,
FAPESBrazil and Canada Research Chairs program for supporting this research.
References
Friman, O., Volosyak, I. and Graser, A.
(2007).
Multiple Channel Detection of
Steady-State Visual Evoked Potentials for
Brain-Computer Interfaces, Biomedical Engineering, IEEE Transactions on 54(4) 742
750.
Hairston, W. D., Whitaker, K. W., Ries, A. J.,
Vettel, J. M., Bradford, J. C. and Kerick, S.
E.and McDowell, K. (2014). Usability of four
commercially-oriented EEG systems, Journal
of Neural Engineering .
Kelly, S., Lalor, E., Finucane, C. and Reilly,
R. (2004). A comparison of covert and
overt attention as a control option in a
steady-state visual evoked potential-based
brain computer interface, 26th Annual International Conference of the IEEE. Engineering in Medicine and Biology Society 2004
(IEMBS 04) 2 47254728.
Kelly, S. P., Lalor, E. C., Reilly, R. B. and Foxe,
J. J. (2005). Visual spatial attention tracking
using high-density SSVEP data for independent brain-computer communication, Neural Systems and Rehabilitation Engineering,
IEEE Transactions 13, no 2.(172,178).
Lin, Z., Zhang, C., Wu, W. and Gao, X. (2007).
Frequency Recognition Based on Canonical
Correlation Analysis for SSVEP-Based BCIs,
Biomedical Engineering, IEEE Transactions
on 54(6) 11721176.

970

XXI Congresso Brasileiro de Automática - CBA2016
UFES, Vitória - ES, 3 a 7 de outubro

Average Accuracy ()

90

80

100

(75  CR) MEC
(75  CR) CCA
(75  CR) MSI
Original MEC
Original CCA
Original MSI

90
Average Accuracy ()

100

70

60

50

80

(75  CR) MEC
(75  CR) CCA
(75  CR) MSI
Original MEC
Original CCA
Original MSI

70

60

50

40

40
Algorithms

(a)

(b)

Algorithms

Figure 2 (a) Average of accuracy with window length of 1s and (b) 4s, respectively.
Morgan, S. T., C., H. J. and Hillyard, S. A.
(1996). Selective attention to stimulus location modulates the steady-state visual evoked
potential, Proc. Natl. Acad. Sci. Neurobiology
93(477-4774).

An Evaluation of Performance for an Independent SSVEP-BCI Based on Compressive
Sensing System, 13th Proc. IUPESM World
Congress on Medical Physics and Biomedical
Engineering, Toronto, Canada .

Pant, J. K. and Krishnan, S. (2013). Reconstruction of ECG signals for compressive sensing
by promoting sparsity on the gradient, IEEE
Int. Conf. on Acoustics, Speech and Signal
Processing (ICASSP) .

Tello, R. M., Muller, S. M., Hasan, M. A., Ferreira, A., Krishnan, S. and Bastos, T. F.
(2016).
An independent-BCI based on
SSVEP using Figure-Ground Perception
(FGP), Biomedical Signal Processing and
Control 26 69  79.

Pant, J. K. and Krishnan, S. (2014). Compressive
sensing of electrocardiogram signals by promoting sparsity on the second-order difference and by using dictionary learning, IEEE
Trans. Biomed. Circuits Syst. 61(3) 198
202.
Tello, R. J. M. G., Bissoli, A., Ferrara, F., Muller,
S., Ferreira, A. and Bastos, T. (2015). Development of a human machine interface for
control of robotic wheelchairand smart environment, 11th IFAC Symposium on Robot
Control (SYROCO) (144-149).
Tello, R. J. M. G., Muller, S. M. T., Bastos-Filho,
T. and Ferreira, A. (2014). A comparison of
techniques and technologies for SSVEP classification, Biosignals and Biorobotics Conference (2014) Biosignals and Robotics for
Better and Safer Living (BRC), 5th ISSNIPIEEE, pp. 16.
Tello, R. J. M. G., Muller, S. M. T., Ferreira, A.
and Bastos, T. F. (2015). Comparison of the
influence of stimuli color on Steady-State Visual Evoked Potentials, Research on Biomedical Engineering 31(3) 218231.

Tello, R., Valadao, C. and Bastos-Filho, T. (2015).
Control de una Silla de Ruedas Robotica
de Alto Rendimiento por Medio de Potenciales Evocados Visuales, VI Congreso Internacional de Diseno, Redes de Investigacion y
Tecnologa para todos, DRT4ALL .
Zhang, Y., Xu, P., Cheng, K. and Yao, D. (2014).
Multivariate synchronization index for frequency recognition of SSVEP-based brain
computer interface, Journal of Neuroscience
Methods 221(0) 32  40.
Zhang, Z., Jung, T. P., Makeig, S. and Rao,
B. D. (2013).
Compressed sensing for
energy-efficient wireless telemonitoring of
noninvasive fetal ECG via block sparse
Bayesian learning, IEEE Trans. Biomed. Eng
60(2) 300309.
Zhang, Z. and Rao, B. D. (2013). Extension
of SBL algorithm for the recovery of block
sparse signals with intra-block correlation,
IEEE Trans. Signal Process , 61, no. 8.

Tello, R. J. M. G., Pant, J. K., Muller, S. M. T.,
Krishnan, S. and Bastos-Filho, T. F. (2015).

ISSN 2525-8311

971