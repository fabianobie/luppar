Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

FOTOMETRO DIGITAL NIR PARA QUANTIFICACAO DE AGUA NO LEITE
CIRCUITO EMISSOR DE LUZ E DE CONDICIONAMENTO DE SINAL
Maurcio Moreira, Jose A. de Franca, Maria B. de Morais Franca, Alex L. Guedes


Departamento de Engenharia Eletrica
Universidade Estadual de Londrina
Caixa Postal 6025
86051-990, Londrina, PR, Brasil

Emails mauromauriciomoreira@yahoo.com.br, josealexandre@eeol.org,
bernadetefranca@gmail.com, alexlem16@yahoo.com.br
Abstract In this paper, we propose a circuit for the detection and signal conditioning of a luminous nearinfrared (NIR) signal. We introduce a prototype of a microcontroller-based electronic system for the emission of
NIR radiation by means of an infrared LED, and for the measurement of the transmittance of light through milk
samples. This system will be used to develop a low cost digital photometer for the measurement of water added
to milk, in order to identify adulterations in the product. The proposed circuit has the function of amplifying
the small difference in the amplitudes of signals generated by a photodiode for samples with different amounts
of water, allowing an adjustment for the measurement with resolution as great as possible. The circuit also has
the function of eliminating the influence of external light in the measurement. Experiments show that the circuit
efficiently amplifies not only the photocurrent generated by the sensor, but also the little difference when using
different samples. Finally, it is show that this proposed technique allows making the system immune to the
interfering light.
Keywords

Photometer Spectrophotometer Milk Light Measurement.

Resumo Neste trabalho, e proposto um circuito de deteccao e condicionamento de sinal luminoso da regiao
do infravermelho proximo (NIR). E apresento um prototipo de um sistema eletronico baseado em microcontrolador para a emissao da radiacao NIR, por meio de um LED infravermelho, e para a medicao da transmitancia
da luz por amostras de leite. Este sistema sera empregado no desenvolvimento de um fotometro digital microcontrolado e de baixo_custo para a quantificacao de agua adicionada ao leite, a fim de identificar adulteracoes no
produto. O circuito proposto tem a funcao de amplificar a pequena diferenca de amplitudes dos sinais gerados
por um fotodiodo para amostras com diferentes quantidades de agua, permitindo um ajuste para leitura com a
maxima resolucao possvel. O circuito tambem tem a funcao de eliminar a influencia de luz externa na medida.
Experimentos mostram que o circuito amplifica de forma eficiente nao apenas a fotocorrente gerada pelo sensor,
mas a pequena diferenca existente quando sao utilizadas diferentes amostras. Por fim, e mostrado que a tecnica
utilizada permite tornar o sistema imune a acao de luz interferente.
Palavras-chave

.

Introducao

O Brasil e o segundo maior produtor de leite da
America, atras dos Estados Unidos, com uma producao de 30,715 milhoes de litros em 2010. Somente no Parana, que e responsavel por 11,7 
da producao brasileira, 55,3  da totalidade de
produtores rurais produzem ate 50 litrosdia, o
que caracteriza uma atividade familiar.
A maioria destes produtores faz parte de associacoes e cooperativas que distribuem o produto
para cerca de 400 laticnios em todo o estado.
Em tais cooperativas, a adicao de agua ao leite
e a fraude mais frequentemente observada. Infelizmente, como essas associacoes sao comunitarias e mistura-se o leite de diversos produtores, e
muito difcil detectar qual deles e o responsavel
pela fraude. Os prejuzos so poderiam ser evitados com o emprego de um metodo rapido, barato
e exato de quantificar a agua no leite.
Atualmente, a prova de excelencia para detectar adicao de agua ao leite e a crioscopia, que
consiste em estimar a quantidade de agua presente
em uma amostra do produto pela medicao da sua

ISBN 978-85-8001-069-5

temperatura de congelamento. Embora seja bastante precisa, a crioscopia e passvel de fraudes
pela adicao de outras substancias, as quais tambem alteram o ponto de congelamento e mascaram
a adicao de agua. Nesse sentido, pretende-se desenvolver uma nova tecnologia de quantificacao da
agua no leite baseada na espectroscopia do infravermelho proximo (NIR), que consiste em observar a absorcao da radiacao eletromagnetica nesta
regiao pelas amostras do produto (Sun, 2009). Tal
sistema devera ser rapido, preciso, e mais robusto
a fraudes, uma vez que a absorcao da energia eletromagnetica depende do tipo de molecula existente no meio, e podera entao ser utilizando diretamente na linha de producao das empresas.
A espectrometria NIR ja e utilizada para determinar os constituintes do leite (Laporte and
Paquin, 1999 Kasemsumran et al., 2007 Artime
et al., 2008). Contudo, para isso, e utilizado um
equipamento chamado espectrofotometro digital.
Tal equipamento e extremamente caro, inviabilizando o seu uso em larga escala, principalmente
em uma area caracterizada como atividade familiar. A proposta do projeto em questao e de-

3490

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

senvolver um fotometro digital microcontrolado
de baixo_custo, baseado em LEDs infravermelhos,
que possa ser utilizado em larga escala pela maioria das cooperativas de produtores brasileiros.
Contudo, este artigo trata da apresentacao dos resultados preliminares da pesquisa.
Os sistemas de aquisicao baseados na espectroscopia do infravermelho utilizam fotodetectores como elementos sensveis a variacao luminosa.
Este artigo apresenta um prototipo de um sistema
eletronico baseado em microcontrolador para a
emissao da radiacao NIR, por meio de um LED
infravermelho, e para a medicao do sinal luminoso
transmitido pela amostra de leite. Este prototipo emprega o princpio da transmitancia, em que
a radiacao eletromagnetica incidente atravessa a
amostra e e coletada por um sensor, sendo que a
intensidade da luz transmitida muda com a variacao do meio, como descreve a Lei de Beer-Labmert
(Smith, 2002 Sun, 2009).
E proposto neste trabalho um circuito de deteccao do sinal luminoso e de condicionamento
para que este possa ser digitalizado por um conversor analogico-digital. Este circuito tem a funcao
de amplificar o sinal em questao e proporcionar,
em poucos estagios, uma leitura com a maxima resolucao possvel, visando eliminar a interferencia
de luz externa. Esta caracterstica e importante
pois pode representar um fator determinante na
precisao da medida. Sao apresentados os resultados preliminares de alguns testes realizados utilizando amostras de leite misturadas a diferentes
quantidades de agua, como o objetivo de avaliar a
viabilidade da tecnica proposta, bem como a estabilidade do sinal de sada.
Dessa forma, o circuito de condicionamento
proposto permitira ajustar facilmente o sinal de
sada, para que possa ser realizada a medicao da
luz transmitida por amostras de leite proveniente
de um ou mais LEDs, com diferentes comprimentos de onda. Estes serao definidos nos proximos
passos da pesquisa, quando entao sera realizada
uma calibracao para que se possa, assim, identificar a quantidade de agua adicionada a uma amostra de leite desconhecida.
2

Sistema Proposto

Na Figura 1, e apresentado um esquema do sistema proposto para a quantizacao da agua no
leite. Foi utilizado como porta-amostras uma cubeta de vidro em um sistema de fluxo, proporcionando um caminho optico de 10 mm. Foram utilizados ainda um LED infravermelho de 1.200nm
e um fotodiodo de InGaAs PT511 para a medicao
da luz transmitida, ou seja, a luz que atravessa
a amostra. O acionamento do LED e feito pelo
microcontrolador de forma pulsada, para permitir
distinguir a luz emitida de uma luz externa interferente, e em uma baixa frequencia f igual a

ISBN 978-85-8001-069-5

LED
Infravermelho

Fotodiodo
Porta-amostras

Fonte de
corrente

Microcontrodador
(MC9S08JM32)

Circuito amplificador

PC

Figura 1 Diagrama de blocos do sistema proposto.
+12 V
+5,0000V
ILED
T1

+12 V
uC

REF.
+3,3V

vC

RA
T2

Figura 2 Circuito de emissao de luz infravermelha e geracao do sinal vC , que sao acionados pelo
microcontrolador.
50Hz. O circuito proposto realiza entao a amplificacao e o condicionamento do sinal proveniente
do fotodiodo para ser digitalizado pelo conversor
analogico-digital do microcontrolador. Por fim,
os valores referentes a amplitude do sinal de sada
lidos sao enviados para o computador para posterior processamento.
Na Figura 2 e apresentado o circuito para a
emissao da luz. Este e composto por uma fonte
de corrente, a qual e controlada pelo valor de RA
e pela tensao da entrada nao-inversora do amplificador, que pode ser ajustada por um potenciometro ligado a uma referencia de tensao de 5V. O
transistor T2 e utilizado como uma chave e permite ao microcontrolador, por meio de um pino
de entrada e sada, acionar o LED de forma pulsada. Este mesmo pino do microcontrolador e ligado a um outro circuito integrado (CI) tensao de
referencia de 3,3V, que permite ligar ou desligar a
sada deste componente por meio de um pino shutdown. Assim, e gerado um sinal vC pulsado com
mesma frequencia e em fase com o acionamento
do LED, sinal este que e utilizado no circuito de
condicionamento apresentado adiante. Ambas as
tensoes de referencia sao proporcionadas por dois

3491

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

C1

C2

R1

R3

Ip

v1

v1

R2
v2

+5,0000V

R1

POT1

VDC1

VL
Figura 3 Primeiro estagio do circuito proposto
deteccao do sinal luminoso emitido pelo LED que
atravessa a amostra de leite.
CIs LT1461, da Linear Technology, e foram utilizados transistores BC337.
O circuito de condicionamento proposto e
composto de tres estagios. Este visa detectar a intensidade da luz proveniente do LED infravermelho que e transmitida pela amostra de leite, para
amostras com quantidade de agua adicionada entre 0  e um valor arbitrario M . Alem disto,
objetiva-se eliminar a possvel influencia de luz externa, e realizar o condicionamento de forma a
possibilitar, em poucos estagios, uma conversao
analogico-digital com a maxima resolucao possvel. Assim, este circuito visa obter um sinal de
sada quadrado tal que sua amplitude de pico-apico varie na faixa de 0 a 5 V para a faixa de
medicao em interesse.
Neste circuito, todos os amplificadores operacionais sao alimentados assimetricamente apenas
com tensao positiva de 5 V. O amplificador utilizado foi o AD8630, o qual e especificado para alimentacao simples e possui sada rail-to-rail. A seguir, sao apresentados os estagios do circuito proposto.
2.1

Estagio de deteccao da luz e pre-amplificacao

A Figura 3 apresenta o primeiro estagio do circuito proposto. O fotodiodo e ligado a um amplificador em uma configuracao de transimpedancia,
a qual impoe uma tensao nula sobre o dispositivo,
no caso ideal, e reduz a capacitancia aparente do
diodo. A modelagem geralmente utilizada na analise de um fotodiodo trata este dispositivo como
uma fonte de corrente ideal, de forma que a corrente em seus terminais, para esta configuracao, e
linearmente relacionada com a potencia luminosa
que incide sobre o sensor (Graeme, 1995). Deve-se
considerar que a fotocorrente gerada pelo sensor,
nesta aplicacao em questao, e da ordem de nanoamperes, o que torna o circuito bastante suscetvel
a rudos e exige uma grande amplificacao. Alem
disto, a diferenca entre as fotocorrentes para diferentes amostras de leite e ainda menor, no que
consiste a complexidade do problema.

ISBN 978-85-8001-069-5

Figura 4 Segundo estagio do circuito proposto
amplificacao.
Foi utilizado um capacitor C1 de baixo valor, o qual diminui a transimpedancia nas altas
frequencias, evitando que o circuito oscile (Johnson, 2003). Uma vez que o circuito e alimentado
de forma assimetrica, uma tensao positiva fixa de
referencia VL e utilizada de forma a garantir que
o amplificador funcione na regiao linear. Desta
forma, considerando que a corrente de entrada do
amplificador utilizado pode ser desprezada, e que
C1  2f1R1 entao a corrente IP gerada pelo fotodiodo produz uma tensao v1 dada por
v1  2R1 IP + VL .
Para a analise do circuito proposto, e considerado que

IP 

IPL + IPE , nT  t < (2n + 1) T2
IPE ,
(2n + 1) T2  t < (n + 1)T
n  0, 1, 2, ...

onde IPL representa a fotocorrente gerada pelo
sensor devido a luz emitida pelo LED, o qual e
mantido aceso por metade do perodo IPE representa a fotocorrente gerada quando o LED esta
apagado devido a corrente de escuro do componente ou a influencia de uma luz externa, a qual
pode variar ao longo do tempo T e o perodo de
acionamento do LED e t e o tempo.
Dessa forma, a sada v1 do primeiro estagio
corresponde a um sinal quadrado, com amplitude
proporcional a intensidade de luz que incide sobre o sensor proveniente do LED (que por sua vez
esta relacionada a quantidade de agua adicionada
a amostra), como mostra a Figura 6(a). Uma vez
que o sinal obtido neste possui amplitude da ordem de unidades de microvolts, e necessario um
estagio de amplificacao, que sera apresentado na
proxima Secao.
2.2

Estagio de amplificacao

Para a amplificacao do sinal v1 , foi utilizado um
segundo estagio como o mostrado na Figura 4. Foi

3492

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

C3

utilizada uma configuracao inversora, em que o ganho e ajustado pelos resistores R2 e R3 , e o nvel
DC do sinal e ajustado por meio do divisor de tensao proporcionado pelo potenciometro P OT1 . Por
meio deste, e possvel posicionar o sinal v2 dentro
da faixa de 0 a 5V. Para garantir uma boa precisao
na tensao VDC1 aplicada a entrada nao inversora,
o potenciometro e ligado a tensao de referencia de
5V. Considerando novamente que C2  2f1R3 ,
entao a sada do segundo estagio v2 pode ser escrita como
v2  2

R1 R3
IPL + K1 ,
R2

sendo
K1  2

R1 R3
(R2 + R3 )
R3
IPE +
VDC1 
VL .
R2
R2
R2

K1 e entao uma tensao fixa, no caso ideal, ajustavel por meio do potenciometro P OT1 , mas que
pode sofrer uma variacao devido a influencia de
uma luz externa. E considerado que esta influencia e pequena o suficiente para nao causar a saturacao do amplificador neste estagio, uma vez
que esta componente causaria um pequeno deslocamento do sinal v2 no sentido negativo. Assim,
a amplitude pico-a-pico de v2 depende apenas da
luz que chega ao sensor proveniente do LED de sinal, e e possvel ajustar P OT1 para produzir uma
sada como mostrado na Figura 6(b).
Conforme dito anteriormente, a diferenca nas
fotocorrentes geradas pelo sensor quando se tem
maior ou menor quantidade de agua e relativamente pequena. Por consequencia, tambem e pequena a diferenca de amplitudes observada em
v2 para diferentes amostras, em comparacao com
cada sinal individualmente. E importante notar
que, uma vez que o objetivo e quantizar a agua
adicionada ao leite, o interessante nao e se obter
um sinal com grande amplitude, e sim obter uma
grande variacao nesta amplitude para diferentes
amostras. Uma simples amplificacao no sinal v2
tambem amplificaria esta diferenca porem, a amplitude de cada sinal ultrapassaria 5V, o que tornaria sua leitura impossvel.
Por conta disto, e necessario realizar uma operacao de forma a amplificar apenas esta diferenca,
reduzindo os nveis de amplitude de forma a nao
saturar o amplificador. Isto possibilitaria a conversao AD garantindo uma boa resolucao. Para
isto, e proposto um terceiro estagio que sera apresentado a seguir.
2.3

Estagio de amplificacao e condicionamento

Com base no que foi discutido, e utilizado o terceiro estagio como mostrado na Figura 5. Entao,
este estagio tem a funcao de realizar simultaneamente tres operacoes

ISBN 978-85-8001-069-5

R6

R5

vC
R4

v2
PWM

VOUT

R7
VDC2
C4

Figura 5 Terceiro estagio do circuito proposto.
 amplificar o sinal v2 e, por consequencia, a
diferenca para quando se varia a quantidade
de agua. Esta diferenca sera tao maior quanto
5
maior a relacao R
R4 
 reduzir os nveis de amplitude dos sinais.
Esta reducao sera tao maior quanto maior a
R5

relacao R
6
 ajustar o nvel DC do sinal de sada para
a faixa de 0 a 5V. Este ajuste e controlado
de forma automatica pelo microcontrolador,
como sera discutido adiante.
Para realizar estas tres funcoes, e utilizado um
circuito somador inversor, em que a sadal v2 do
estagio anterior e adicionada ao sinal vC . Este e
um sinal quadrado com amplitude fixa K2 igual a
3,3V, proveniente de um CI tensao de referencia,
a qual e pulsada na mesma frequencia e em fase
com o LED. Ou seja,

vC 

K2 ,
0,

nT  t < (2n + 1) T2
(2n + 1) T2  t < (n + 1)T
n  0, 1, 2, ...

E utilizada ainda uma tecnica de controle da
tensao VDC2 da porta nao inversora, que e feita
pelo microcontrolador, para ajustar o nvel DC do
sinal e garantir que este esteja dentro da faixa de
0 a 5V. Assim, a tensao de sada vOU T do circuito
de condicionamento e dada por

vOU T  2

R1 R3 R5
R5
IPL 
vC + K3 ,
R2 R4
R6

(1)

sendo

K3 

1+

R5
R5
+
R4
R6


VDC2 

R5
K1 .
R4

(2)

Como pode ser observado pela analise da
Equacao (1), ajustando-se o valor de R6 e possvel
reduzir o nvel de amplitude em vOU T , sendo que a
diferenca de amplitudes para diferentes amostras
na faixa de medicao em interesse (que depende da
diferenca em IP ) e depende do ganho dado por R4

3493

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

v1

v1
+5V

+5V

LED ON
LED OFF

2R1IPL(0)

VL+2R1IPE

LED ON
LED OFF

2R1IPL(M)

VL+2R1IPE
t

t
(a)

v2

v2

LED ON
LED OFF

+5V
K1
Ajustável

LED ON
LED OFF

+5V
K1
Ajustável

2R1R3IPL(0)
R2

2R1R3IPL(M)
R2

t

t
(b)

vOUT

vOUT

+5V

LED ON
LED OFF

+5V
LED ON
LED OFF

Controlável
K3

2R1R3R5IPL(0)  R5K2 Controlável
K3
R 2R 4
R6
t

2R1R3R5IPL(M)  R5K2
R 2R 4
R6
t

(c)

Figura 6 (a) Sinal v1 , (b) sinal v2 e (c) sinal v3 para 0  (esquerda) e um valor arbitrario M  (direita)
de agua na amostra.
e R5 . Alem disto, pode-se verificar pela Equacao
(2) que uma mudanca na tensao da entrada naoinversora VDC2 altera o nvel DC do sinal de sada
sem modificar a sua amplitude. Assim, e possvel ajustar os valores de R4 , R5 e R6 de forma
a produzir uma sada vOU T como a mostrada na
Figura 6(c). Pode-se observar nesta figura que
a amplitude pico-a-pico de vOU T apresenta agora
uma variacao significativa de uma amostra de leite
puro para uma amostra com a agua. Entretanto,
para que este circuito funcione da forma esperada,
e utilizada uma estrategia de controlar a tensao
VDC2 para garantir que o sinal de sada esteja dentro da regiao linear do amplificador. Isto e necessario porque que a influencia de uma luz externa
poderia facilmente levar vOU T a saturacao, caso o
nvel DC dado por K3 fosse fixo. Este controle e
feito pelo microcontrolador por meio de um sinal
PWM, com frequencia de 50kHz, ligado a um filtro passa-baixas com frequencia de corte de 0,01
Hz, de forma que a tensao VDC2 assume o valor
medio deste sinal. Desta forma, uma vez ajustado R6 , a amplitude do sinal de sada dependera
apenas do componente da luz que chega ao sensor
devido ao LED, e o controle da tensao VDC2 compensa a variacao no nvel DC ocorrida pela acao
do componente de luz externa.

3

Resultados Experimentais

Na Figura 7 e apresentada uma foto do prototipo
em desenvolvimento. A entrada de leite para as
medicoes e feita por meio de um sistema composto
por mangueiras e um embolo como mostra a Figura 7(a), de forma que o porta-amostras possa
ser mantido fixo. Assim, sua posicao em relacao
ao LED e ao fotodiodo nao e modificada, e as irregularidades existentes no vidro nao influenciam
nas medicoes entre diferentes amostras.
Para avaliacao do circuito de condicionamento
proposto, foram realizados testes com algumas
amostras de leite misturado a agua em diferentes
proporcoes. O objetivo foi comprovar a validade
das equacoes apresentadas na Secao 2, avaliando
a resposta do circuito quanto a variacao no sinal
de entrada, bem como a estabilidade do sinal de
sada, de forma a avaliar a viabilidade da tecnica
proposta. Para isto, o sistema foi ajustado como
segue
 primeiramente, com o LED acionado pelo microcontrolador, a corrente ILED foi ajustada
em 80mA por meio do potenciometro no circuito da Figura 2. Foi utilizado um resistor
RA de 50
 apos alguns testes preliminares, foram estabelecidos os valores de R1  560k no
primeiro estagio do circuito condicionador,
R3 R2  56 como ganho no segundo estagio,
e R4  560k no terceiro

ISBN 978-85-8001-069-5

3494

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

(a)

(b)

(c)

(d)

Figura 7 (a) Prototipo em desenvolvimento (b) circuito de condicionamento (c) estrutura com o portaamostras, LED infravermelho e fotodiodo (d) placa de desenvolvimento com um microcontrolador da
famlia HCS08 da Freescale.
 posteriormente, utilizando uma amostra de
leite considerando M  20 de agua e com
o auxlio de um osciloscopio, foi realizado o
ajuste de P OT1 , de forma a estabelecer o valor de K1 como mostrado na Figura 6 e garantir que o sinal v2 no segundo estagio do
circuito estivesse entre 0 e 5V
 em seguida, foram ajustados os valores de R5
e R6 de forma a produzir uma variacao significativa em vOU T para diferentes quantidades
de agua na amostra. Para isto, foram utilizadas amostras de leite contendo 0 e 20  de
agua. Com este ajuste, foi estabelecido um
ganho R5 R4 no ultimo estagio do circuito
da ordem de 30 vezes.
A Figura 8 mostra o formato dos sinais v2 e
vOU T obtidos para duas amostras de leite com 0 
(Figura 8(a)) e 20  de agua (Figura 8(b)) apos os
ajustes descritos, os quais foram obtidos por meio
de um osciloscopio digital Agilent DS0-X 2012A.
Pode-se observar que, para uma pequena variacao
de amplitude em v2 , foi possvel obter uma grande
variacao em vOU T , conforme esperado. E possvel
observar, entretanto, que existem picos nos instan-

ISBN 978-85-8001-069-5

tes da comutacao, que devem ser desconsiderados
para as medidas de amplitude.
Apos os ajustes descritos, foram realizadas algumas analises com amostras de leite contendo
agua em quantidades de 0, 4, 8, 12, 16 e 20. A
amplitude do sinal de sada foi medida com base
nos dados digitalizados pelo conversor AD do microcontrolador, de 12 bits. Foi utilizado um microcontrolador da famlia HCS08 da Freescale.
A Figura 9 apresenta a variacao na amplitude da tensao de sada medida pelo microcontrolador em relacao a quantidade de agua na amostra. Pode-se observar uma variacao significativa
na tensao de sada de aproximadamente 3 V dentro desta faixa de medicao.
Por meio deste experimento, pode-se verificar
a viabilidade da tecnica proposta, constatando-se
que e possvel ajustar o circuito para amplificar
nao apenas a fotocorrente gerada pelo sensor, mas
a pequena diferenca entre as fotocorrentes para
diferentes amostras, conforme indicavam as equacoes apresentadas na Secao 2.
Posteriormente, foi realizado outro experimento com o objetivo de avaliar o funcionamento
do sistema quanto a acao de luz externa. Para

3495

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.
1,7

5
3
2
1
0
0

0.01

0.02

0.03
Tempo (s)

0.04

0.05

0.06

5
vOUT (V)

4
3
2

Amplitude do sinal de saída (V)

v2 (V)

4

1,6

Led interferente
ligado

Led interferente
desligado

1,5
1,4
1,3
1,2

1
0
0

0,01

0,02

0,03
Tempo (s)

0,04

0,05

0,06

1,1
0

50

(a)
70

Led interferente
ligado

3
2
1
0
0

0.01

0.02

0.03
Tempo (s)

0.04

0.05

0.06

5
4
3
2
1
0
0

0,01

0,02

0,03
Tempo (s)

0,04

0,05

Razão cíclica do sinal PWM ()

4
v2 (V)

200

(a)

5

vOUT (V)

100
150
Tempo(s)

68

Led interferente
desligado

66
64
62
60

0,06

58
0

(b)

50

100
150
Tempo(s)

200

(b)

Figura 8 (a) Sinais v2 e vOU T medidos para uma
amostra de leite puro (b) sinais v2 e vOU T medidos para uma amostra de leite com 20  de agua.

Figura 10 (a) Amplitude do sinal de sada e (b)
razao cclica do sinal P W M , medidos com o sistema sob acao de uma luz externa.

3

Amplitude (V)

2,5

mostra a Figura 10. Foi utilizada uma amostra de
leite generica. A frequencia de amostragem utilizada no experimento foi de aproximadamente 1,5
Hz.

2
1,5
1
0,5
0

0

5
10
15
Quantidade de água na amostra ()

20

Figura 9 Relacao entre a amplitude do sinal de
sada medida e a porcentagem de agua presente
na amostra.

isto, foi utilizado um circuito auxiliar para excitacao de um segundo LED, o qual foi fixado proximo
ao porta-amostras a fim de simular uma fonte de
luz interferente. Entao, este LED foi comutado a
cada 40 segundos, e foram monitorados a amplitude do sinal de sada e a razao cclica do sinal
P W M aplicada pelo microcontrolador, conforme

ISBN 978-85-8001-069-5

A Figura 10(a) mostra que, com o LED que simula a luz externa apagado, a amplitude de vOU T
medida pelo microcontrolador e de aproximadamente 1,52V. Entao, quando a luz interferente
e acesa, esta afeta o sinal de sada, como previsto, deslocando vOU T e levando-o momentaneamente a saturacao. Assim, a amplitude do sinal
de sada medida pelo amplificador e momentaneamente perturbada e assume o valor zero, como
indica os picos da Figura 10(a). Nesse instante, o
microcontrolador detecta esta mudanca e entao altera o sinal de controle P W M , a fim de restaurar
vOU T a regiao linear do amplificador. Isto pode
ser verificado no grafico da Figura 10(b), que mostra uma diminuicao na razao cclica quando o LED
interferente esta aceso. Assim, o sinal de sada
volta a faixa de 0 a 5V, e a sua amplitude medida pelo microcontrolador volta ao valor anterior.
O processo inverso ocorre quando a luz externa e
apagada, o que leva a um aumento na razao c-

3496

Anais do XIX Congresso Brasileiro de Automática, CBA 2012.

clica, mais uma vez sem modificar a amplitude do
sinal de sada apos a comutacao. Portanto, podese verificar que, com excecao dos momentos de
comutacao, a amplitude de vOU T medida pelo microcontrolador nao e alterada, e se mantem estavel
ao longo do tempo conforme esperado.
Evidentemente, em situacao normal de operacao do equipamento, espera-se que a influencia de
luz externa seja muito menor do que a simulada
neste experimento. Portanto, esta tecnica de controle demonstra-se bastante adequada para esta
aplicacao.
Uma vez constatado que a tecnica de controle
proposta e eficiente, e importante observar uma
outra caracterstica deste circuito. Trata-se da
possibilidade de se utilizar um ajuste tal que a
diferenca de amplitudes dentro da faixa de medicao (0 a M  de agua) seja maior do que o limite
de 5V na conversao AD.
Ja que a tensao VDC2 e controlavel, e por consequencia tambem o nvel K3 , seu valor pode ser
modificado de uma amostra para outra, pois a medida de interesse e a amplitude de vOU T que independe do seu nvel DC. Assim, um ganho maior
poderia ser utilizado, e o sinal de sada poderia ser
ajustado de forma a estar defasado 90 graus em
relacao ao acionamento do LED, por exemplo, em
metade da faixa de medicao (0 a M
2  de agua).
Isto acontece quando
R5
R1 R3 R5
K2 > 2
IPL
R6
R2 R4
o que representa uma amplitude negativa. No restante da faixa, porem, o sinal de sada estaria em
fase com o acionamento do LED (amplitude positiva). Este ajuste pode ser feito por meio de R5 e
R6 , e o controle permite que o sinal de sada esteja, em qualquer um dos casos, dentro da regiao
linear. Assim, e possvel aumentar a resolucao da
medida, pois estende-se a faixa de variacao na amplitude de vOU T alem dos 5V.
4

Conclusao

Foi apresentado neste trabalho os resultados preliminares de um prototipo para quantificacao de
agua adicionada ao leite. Foi desenvolvido um circuito para emissao de luz, por meio de um LED
infravermelho, a qual e feita de modo pulsada a
fim de permitir distinguir a luz transmitida de
uma luz externa interferente. Foi proposto tambem um circuito para deteccao e condicionamento
do sinal optico para a medicao da luz transmitida pelas amostras de leite. Os resultados dos
testes experimentais mostram que o circuito proposto permite amplificar de forma eficiente a pequena diferenca de amplitude dos sinais quando se
tem maior ou menor quantidade de agua na amostra. Pode-se verificar tambem que a tecnica de
controle proposta pode ser utilizada para tornar

ISBN 978-85-8001-069-5

o equipamento imune a influencia de luz externa,
o que pode ser um fator determinante na precisao da medida. O circuito proposto possui poucos
estagios, nao necessita de alimentacao simetrica
e permite o ajuste de forma simples para LEDs
de diferentes comprimentos de onda, o que sera
importante para as proximas etapas da pesquisa,
quando serao definidos os melhores comprimentos
de onda para serem utilizados na deteccao da agua
no leite.
No decorrer da pesquisa, sera estudado e definido o metodo para calibracao do equipamento,
e novas melhorias serao implementadas ao prototipo, tal como a automatizacao da entrada e sada
do leite por meio de uma bomba_peristaltica. Por
fim, tambem sera realizado um estudo sobre a influencia da temperatura nas medicoes, para que
possa ser definido um metodo para controle desta
grandeza caso se faca necessario.
Agradecimentos
Os autores agradecem a CAPES, a FUNDACAO
ARAUCARIA e a PROPPG-UEL pelo financiamento das pesquisas.
Referencias
Artime, C. E. C., de la Fuente, J. A. B., Garcia, M.
A. P., Vega, R., and Blanco, N. (2008). On-line
estimation of fresh milk composition by means
of vis-nir spectrometry and partial least squares
method (pls). In Instrumentation and Measurement Technology Conference, pages 14711475.
Graeme, J. G. (1995). Photodiode amplifiers op
amp solutions. McGraw-Hill.
Johnson, M. (2003). Photodetection and Measurement Maximizing Performance in Optical Systems. McGraw-Hill.
Kasemsumran, S., Thanapase, W., and Kiatsoonthon, A. (2007). Feasibility of near-infrared
spectroscopy to detect and to quantify adulterants in cow milk. Analytical Sciences, 23907
910.
Laporte, M. F. and Paquin, P. (1999). Nearinfrared analysis of fat, protein, and casein in
cows milk. J. Agric. Food Chem., 472600
2605.
Smith, B. (2002). Quantitative Spectroscopy Theory and Practice. Academic Press.
Sun, D.-W. (2009). Infrared Spectroscopy for Food
Quality Analysis and Control. Academic Press.

3497